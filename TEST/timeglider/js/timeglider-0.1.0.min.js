(function(){var s=this,Z=s._,Q={},B=Array.prototype,T=Object.prototype,m=B.slice,K=B.unshift,L=T.toString,l=T.hasOwnProperty,z=B.forEach,C=B.map,i=B.reduce,p=B.reduceRight,r=B.filter,G=B.every,F=B.some,R=B.indexOf,W=B.lastIndexOf;T=Array.isArray;var Y=Object.keys,k=Function.prototype.bind,j=function(h){return new D(h)};typeof module!=="undefined"&&module.exports?(module.exports=j,j._=j):s._=j;j.VERSION="1.1.7";var H=j.each=j.forEach=function(h,q,A){if(h!=null)if(z&&h.forEach===z)h.forEach(q,A);else if(h.length===
+h.length)for(var I=0,O=h.length;I<O;I++){if(I in h&&q.call(A,h[I],I,h)===Q)break}else for(I in h)if(l.call(h,I)&&q.call(A,h[I],I,h)===Q)break};j.map=function(h,q,A){var I=[];if(h==null)return I;if(C&&h.map===C)return h.map(q,A);H(h,function(O,X,ga){I[I.length]=q.call(A,O,X,ga)});return I};j.reduce=j.foldl=j.inject=function(h,q,A,I){var O=A!==void 0;h==null&&(h=[]);if(i&&h.reduce===i)return I&&(q=j.bind(q,I)),O?h.reduce(q,A):h.reduce(q);H(h,function(X,ga,ba){O?A=q.call(I,A,X,ga,ba):(A=X,O=true)});
if(!O)throw new TypeError("Reduce of empty array with no initial value");return A};j.reduceRight=j.foldr=function(h,q,A,I){h==null&&(h=[]);if(p&&h.reduceRight===p)return I&&(q=j.bind(q,I)),A!==void 0?h.reduceRight(q,A):h.reduceRight(q);h=(j.isArray(h)?h.slice():j.toArray(h)).reverse();return j.reduce(h,q,A,I)};j.find=j.detect=function(h,q,A){var I;w(h,function(O,X,ga){if(q.call(A,O,X,ga))return I=O,true});return I};j.filter=j.select=function(h,q,A){var I=[];if(h==null)return I;if(r&&h.filter===r)return h.filter(q,
A);H(h,function(O,X,ga){q.call(A,O,X,ga)&&(I[I.length]=O)});return I};j.reject=function(h,q,A){var I=[];if(h==null)return I;H(h,function(O,X,ga){q.call(A,O,X,ga)||(I[I.length]=O)});return I};j.every=j.all=function(h,q,A){var I=true;if(h==null)return I;if(G&&h.every===G)return h.every(q,A);H(h,function(O,X,ga){if(!(I=I&&q.call(A,O,X,ga)))return Q});return I};var w=j.some=j.any=function(h,q,A){q=q||j.identity;var I=false;if(h==null)return I;if(F&&h.some===F)return h.some(q,A);H(h,function(O,X,ga){if(I|=
q.call(A,O,X,ga))return Q});return!!I};j.include=j.contains=function(h,q){var A=false;if(h==null)return A;if(R&&h.indexOf===R)return h.indexOf(q)!=-1;w(h,function(I){if(A=I===q)return true});return A};j.invoke=function(h,q){var A=m.call(arguments,2);return j.map(h,function(I){return(q.call?q||I:I[q]).apply(I,A)})};j.pluck=function(h,q){return j.map(h,function(A){return A[q]})};j.max=function(h,q,A){if(!q&&j.isArray(h))return Math.max.apply(Math,h);var I={computed:-Infinity};H(h,function(O,X,ga){X=
q?q.call(A,O,X,ga):O;X>=I.computed&&(I={value:O,computed:X})});return I.value};j.min=function(h,q,A){if(!q&&j.isArray(h))return Math.min.apply(Math,h);var I={computed:Infinity};H(h,function(O,X,ga){X=q?q.call(A,O,X,ga):O;X<I.computed&&(I={value:O,computed:X})});return I.value};j.sortBy=function(h,q,A){return j.pluck(j.map(h,function(I,O,X){return{value:I,criteria:q.call(A,I,O,X)}}).sort(function(I,O){var X=I.criteria,ga=O.criteria;return X<ga?-1:X>ga?1:0}),"value")};j.groupBy=function(h,q){var A=
{};H(h,function(I,O){var X=q(I,O);(A[X]||(A[X]=[])).push(I)});return A};j.sortedIndex=function(h,q,A){A||(A=j.identity);for(var I=0,O=h.length;I<O;){var X=I+O>>1;A(h[X])<A(q)?I=X+1:O=X}return I};j.toArray=function(h){if(!h)return[];if(h.toArray)return h.toArray();if(j.isArray(h))return m.call(h);if(j.isArguments(h))return m.call(h);return j.values(h)};j.size=function(h){return j.toArray(h).length};j.first=j.head=function(h,q,A){return q!=null&&!A?m.call(h,0,q):h[0]};j.rest=j.tail=function(h,q,A){return m.call(h,
q==null||A?1:q)};j.last=function(h){return h[h.length-1]};j.compact=function(h){return j.filter(h,function(q){return!!q})};j.flatten=function(h){return j.reduce(h,function(q,A){if(j.isArray(A))return q.concat(j.flatten(A));q[q.length]=A;return q},[])};j.without=function(h){return j.difference(h,m.call(arguments,1))};j.uniq=j.unique=function(h,q){return j.reduce(h,function(A,I,O){if(0==O||(q===true?j.last(A)!=I:!j.include(A,I)))A[A.length]=I;return A},[])};j.union=function(){return j.uniq(j.flatten(arguments))};
j.intersection=j.intersect=function(h){var q=m.call(arguments,1);return j.filter(j.uniq(h),function(A){return j.every(q,function(I){return j.indexOf(I,A)>=0})})};j.difference=function(h,q){return j.filter(h,function(A){return!j.include(q,A)})};j.zip=function(){for(var h=m.call(arguments),q=j.max(j.pluck(h,"length")),A=Array(q),I=0;I<q;I++)A[I]=j.pluck(h,""+I);return A};j.indexOf=function(h,q,A){if(h==null)return-1;var I;if(A)return A=j.sortedIndex(h,q),h[A]===q?A:-1;if(R&&h.indexOf===R)return h.indexOf(q);
A=0;for(I=h.length;A<I;A++)if(h[A]===q)return A;return-1};j.lastIndexOf=function(h,q){if(h==null)return-1;if(W&&h.lastIndexOf===W)return h.lastIndexOf(q);for(var A=h.length;A--;)if(h[A]===q)return A;return-1};j.range=function(h,q,A){arguments.length<=1&&(q=h||0,h=0);A=arguments[2]||1;for(var I=Math.max(Math.ceil((q-h)/A),0),O=0,X=Array(I);O<I;){X[O++]=h;h+=A}return X};j.bind=function(h,q){if(h.bind===k&&k)return k.apply(h,m.call(arguments,1));var A=m.call(arguments,2);return function(){return h.apply(q,
A.concat(m.call(arguments)))}};j.bindAll=function(h){var q=m.call(arguments,1);q.length==0&&(q=j.functions(h));H(q,function(A){h[A]=j.bind(h[A],h)});return h};j.memoize=function(h,q){var A={};q||(q=j.identity);return function(){var I=q.apply(this,arguments);return l.call(A,I)?A[I]:A[I]=h.apply(this,arguments)}};j.delay=function(h,q){var A=m.call(arguments,2);return setTimeout(function(){return h.apply(h,A)},q)};j.defer=function(h){return j.delay.apply(j,[h,1].concat(m.call(arguments,1)))};var o=function(h,
q,A){var I;return function(){var O=this,X=arguments,ga=function(){I=null;h.apply(O,X)};A&&clearTimeout(I);if(A||!I)I=setTimeout(ga,q)}};j.throttle=function(h,q){return o(h,q,false)};j.debounce=function(h,q){return o(h,q,true)};j.once=function(h){var q=false,A;return function(){if(q)return A;q=true;return A=h.apply(this,arguments)}};j.wrap=function(h,q){return function(){var A=[h].concat(m.call(arguments));return q.apply(this,A)}};j.compose=function(){var h=m.call(arguments);return function(){for(var q=
m.call(arguments),A=h.length-1;A>=0;A--)q=[h[A].apply(this,q)];return q[0]}};j.after=function(h,q){return function(){if(--h<1)return q.apply(this,arguments)}};j.keys=Y||function(h){if(h!==Object(h))throw new TypeError("Invalid object");var q=[],A;for(A in h)l.call(h,A)&&(q[q.length]=A);return q};j.values=function(h){return j.map(h,j.identity)};j.functions=j.methods=function(h){var q=[],A;for(A in h)j.isFunction(h[A])&&q.push(A);return q.sort()};j.extend=function(h){H(m.call(arguments,1),function(q){for(var A in q)q[A]!==
void 0&&(h[A]=q[A])});return h};j.defaults=function(h){H(m.call(arguments,1),function(q){for(var A in q)h[A]==null&&(h[A]=q[A])});return h};j.clone=function(h){return j.isArray(h)?h.slice():j.extend({},h)};j.tap=function(h,q){q(h);return h};j.isEqual=function(h,q){if(h===q)return true;var A=typeof h;if(A!=typeof q)return false;if(h==q)return true;if(!h&&q||h&&!q)return false;if(h._chain)h=h._wrapped;if(q._chain)q=q._wrapped;if(h.isEqual)return h.isEqual(q);if(q.isEqual)return q.isEqual(h);if(j.isDate(h)&&
j.isDate(q))return h.getTime()===q.getTime();if(j.isNaN(h)&&j.isNaN(q))return false;if(j.isRegExp(h)&&j.isRegExp(q))return h.source===q.source&&h.global===q.global&&h.ignoreCase===q.ignoreCase&&h.multiline===q.multiline;if(A!=="object")return false;if(h.length&&h.length!==q.length)return false;A=j.keys(h);var I=j.keys(q);if(A.length!=I.length)return false;for(var O in h)if(!(O in q)||!j.isEqual(h[O],q[O]))return false;return true};j.isEmpty=function(h){if(j.isArray(h)||j.isString(h))return h.length===
0;for(var q in h)if(l.call(h,q))return false;return true};j.isElement=function(h){return!!(h&&h.nodeType==1)};j.isArray=T||function(h){return L.call(h)==="[object Array]"};j.isObject=function(h){return h===Object(h)};j.isArguments=function(h){return!(!h||!l.call(h,"callee"))};j.isFunction=function(h){return!(!h||!h.constructor||!h.call||!h.apply)};j.isString=function(h){return!!(h===""||h&&h.charCodeAt&&h.substr)};j.isNumber=function(h){return!!(h===0||h&&h.toExponential&&h.toFixed)};j.isNaN=function(h){return h!==
h};j.isBoolean=function(h){return h===true||h===false};j.isDate=function(h){return!(!h||!h.getTimezoneOffset||!h.setUTCFullYear)};j.isRegExp=function(h){return!(!h||!h.test||!h.exec||!(h.ignoreCase||h.ignoreCase===false))};j.isNull=function(h){return h===null};j.isUndefined=function(h){return h===void 0};j.noConflict=function(){s._=Z;return this};j.identity=function(h){return h};j.times=function(h,q,A){for(var I=0;I<h;I++)q.call(A,I)};j.mixin=function(h){H(j.functions(h),function(q){P(q,j[q]=h[q])})};
var y=0;j.uniqueId=function(h){var q=y++;return h?h+q:q};j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};j.template=function(h,q){var A=j.templateSettings;A="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+h.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(A.interpolate,function(I,O){return"',"+O.replace(/\\'/g,"'")+",'"}).replace(A.evaluate||null,function(I,O){return"');"+O.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,
"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";A=new Function("obj",A);return q?A(q):A};var D=function(h){this._wrapped=h};j.prototype=D.prototype;var E=function(h,q){return q?j(h).chain():h},P=function(h,q){D.prototype[h]=function(){var A=m.call(arguments);K.call(A,this._wrapped);return E(q.apply(j,A),this._chain)}};j.mixin(j);H(["pop","push","reverse","shift","sort","splice","unshift"],function(h){var q=B[h];D.prototype[h]=function(){q.apply(this._wrapped,arguments);
return E(this._wrapped,this._chain)}});H(["concat","join","slice"],function(h){var q=B[h];D.prototype[h]=function(){return E(q.apply(this._wrapped,arguments),this._chain)}});D.prototype.chain=function(){this._chain=true;return this};D.prototype.value=function(){return this._wrapped}})();(function(){var s=this,Z=s.Backbone,Q;Q=typeof exports!=="undefined"?exports:s.Backbone={};Q.VERSION="0.5.3";var B=s._;if(!B&&typeof require!=="undefined")B=require("underscore")._;var T=s.jQuery||s.Zepto;Q.noConflict=function(){s.Backbone=Z;return this};Q.emulateHTTP=false;Q.emulateJSON=false;Q.Events={bind:function(k,j,H){var w=this._callbacks||(this._callbacks={});(w[k]||(w[k]=[])).push([j,H]);return this},unbind:function(k,j){var H;if(k){if(H=this._callbacks)if(j){H=H[k];if(!H)return this;for(var w=
0,o=H.length;w<o;w++)if(H[w]&&j===H[w][0]){H[w]=null;break}}else H[k]=[]}else this._callbacks={};return this},trigger:function(k){var j,H,w,o,y=2;if(!(H=this._callbacks))return this;for(;y--;)if(j=y?k:"all",j=H[j])for(var D=0,E=j.length;D<E;D++)(w=j[D])?(o=y?Array.prototype.slice.call(arguments,1):arguments,w[0].apply(w[1]||this,o)):(j.splice(D,1),D--,E--);return this}};Q.Model=function(k,j){var H;k||(k={});if(H=this.defaults){B.isFunction(H)&&(H=H.call(this));k=B.extend({},H,k)}this.attributes={};
this._escapedAttributes={};this.cid=B.uniqueId("c");this.set(k,{silent:true});this._changed=false;this._previousAttributes=B.clone(this.attributes);if(j&&j.collection)this.collection=j.collection;this.initialize(k,j)};B.extend(Q.Model.prototype,Q.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return B.clone(this.attributes)},get:function(k){return this.attributes[k]},escape:function(k){var j;if(j=this._escapedAttributes[k])return j;j=this.attributes[k];
return this._escapedAttributes[k]=(j==null?"":""+j).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},has:function(k){return this.attributes[k]!=null},set:function(k,j){j||(j={});if(!k)return this;if(k.attributes)k=k.attributes;var H=this.attributes,w=this._escapedAttributes;if(!j.silent&&this.validate&&!this._performValidation(k,j))return false;if(this.idAttribute in k)this.id=k[this.idAttribute];
var o=this._changing;this._changing=true;for(var y in k){var D=k[y];if(!B.isEqual(H[y],D)){H[y]=D;delete w[y];this._changed=true;j.silent||this.trigger("change:"+y,this,D,j)}}!o&&!j.silent&&this._changed&&this.change(j);this._changing=false;return this},unset:function(k,j){if(!(k in this.attributes))return this;j||(j={});var H={};H[k]=void 0;if(!j.silent&&this.validate&&!this._performValidation(H,j))return false;delete this.attributes[k];delete this._escapedAttributes[k];k==this.idAttribute&&delete this.id;
this._changed=true;j.silent||(this.trigger("change:"+k,this,void 0,j),this.change(j));return this},clear:function(k){k||(k={});var j,H=this.attributes,w={};for(j in H)w[j]=void 0;if(!k.silent&&this.validate&&!this._performValidation(w,k))return false;this.attributes={};this._escapedAttributes={};this._changed=true;if(!k.silent){for(j in H)this.trigger("change:"+j,this,void 0,k);this.change(k)}return this},fetch:function(k){k||(k={});var j=this,H=k.success;k.success=function(w,o,y){if(!j.set(j.parse(w,
y),k))return false;H&&H(j,w)};k.error=Y(k.error,j,k);return(this.sync||Q.sync).call(this,"read",this,k)},save:function(k,j){j||(j={});if(k&&!this.set(k,j))return false;var H=this,w=j.success;j.success=function(y,D,E){if(!H.set(H.parse(y,E),j))return false;w&&w(H,y,E)};j.error=Y(j.error,H,j);var o=this.isNew()?"create":"update";return(this.sync||Q.sync).call(this,o,this,j)},destroy:function(k){k||(k={});if(this.isNew())return this.trigger("destroy",this,this.collection,k);var j=this,H=k.success;k.success=
function(w){j.trigger("destroy",j,j.collection,k);H&&H(j,w)};k.error=Y(k.error,j,k);return(this.sync||Q.sync).call(this,"delete",this,k)},url:function(){var k=R(this.collection)||this.urlRoot||W();if(this.isNew())return k;return k+(k.charAt(k.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(k){return k},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(k){this.trigger("change",this,k);this._previousAttributes=B.clone(this.attributes);
this._changed=false},hasChanged:function(k){if(k)return this._previousAttributes[k]!=this.attributes[k];return this._changed},changedAttributes:function(k){k||(k=this.attributes);var j=this._previousAttributes,H=false,w;for(w in k)B.isEqual(j[w],k[w])||(H=H||{},H[w]=k[w]);return H},previous:function(k){if(!k||!this._previousAttributes)return null;return this._previousAttributes[k]},previousAttributes:function(){return B.clone(this._previousAttributes)},_performValidation:function(k,j){var H=this.validate(k);
if(H)return j.error?j.error(this,H,j):this.trigger("error",this,H,j),false;return true}});Q.Collection=function(k,j){j||(j={});if(j.comparator)this.comparator=j.comparator;B.bindAll(this,"_onModelEvent","_removeReference");this._reset();k&&this.reset(k,{silent:true});this.initialize.apply(this,arguments)};B.extend(Q.Collection.prototype,Q.Events,{model:Q.Model,initialize:function(){},toJSON:function(){return this.map(function(k){return k.toJSON()})},add:function(k,j){if(B.isArray(k))for(var H=0,w=
k.length;H<w;H++)this._add(k[H],j);else this._add(k,j);return this},remove:function(k,j){if(B.isArray(k))for(var H=0,w=k.length;H<w;H++)this._remove(k[H],j);else this._remove(k,j);return this},get:function(k){if(k==null)return null;return this._byId[k.id!=null?k.id:k]},getByCid:function(k){return k&&this._byCid[k.cid||k]},at:function(k){return this.models[k]},sort:function(k){k||(k={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);
k.silent||this.trigger("reset",this,k);return this},pluck:function(k){return B.map(this.models,function(j){return j.get(k)})},reset:function(k,j){k||(k=[]);j||(j={});this.each(this._removeReference);this._reset();this.add(k,{silent:true});j.silent||this.trigger("reset",this,j);return this},fetch:function(k){k||(k={});var j=this,H=k.success;k.success=function(w,o,y){j[k.add?"add":"reset"](j.parse(w,y),k);H&&H(j,w)};k.error=Y(k.error,j,k);return(this.sync||Q.sync).call(this,"read",this,k)},create:function(k,
j){var H=this;j||(j={});k=this._prepareModel(k,j);if(!k)return false;var w=j.success;j.success=function(o,y,D){H.add(o,j);w&&w(o,y,D)};k.save(null,j);return k},parse:function(k){return k},chain:function(){return B(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(k,j){if(k instanceof Q.Model){if(!k.collection)k.collection=this}else{var H=k;k=new this.model(H,{collection:this});k.validate&&!k._performValidation(H,j)&&(k=false)}return k},
_add:function(k,j){j||(j={});k=this._prepareModel(k,j);if(!k)return false;var H=this.getByCid(k);if(H)throw Error(["Can't add the same model to a set twice",H.id]);this._byId[k.id]=k;this._byCid[k.cid]=k;this.models.splice(j.at!=null?j.at:this.comparator?this.sortedIndex(k,this.comparator):this.length,0,k);k.bind("all",this._onModelEvent);this.length++;j.silent||k.trigger("add",k,this,j);return k},_remove:function(k,j){j||(j={});k=this.getByCid(k)||this.get(k);if(!k)return null;delete this._byId[k.id];
delete this._byCid[k.cid];this.models.splice(this.indexOf(k),1);this.length--;j.silent||k.trigger("remove",k,this,j);this._removeReference(k);return k},_removeReference:function(k){this==k.collection&&delete k.collection;k.unbind("all",this._onModelEvent)},_onModelEvent:function(k,j,H,w){(k=="add"||k=="remove")&&H!=this||(k=="destroy"&&this._remove(j,w),j&&k==="change:"+j.idAttribute&&(delete this._byId[j.previous(j.idAttribute)],this._byId[j.id]=j),this.trigger.apply(this,arguments))}});B.each(["forEach",
"each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"],function(k){Q.Collection.prototype[k]=function(){return B[k].apply(B,[this.models].concat(B.toArray(arguments)))}});Q.Router=function(k){k||(k={});if(k.routes)this.routes=k.routes;this._bindRoutes();this.initialize.apply(this,arguments)};
var m=/:([\w\d]+)/g,K=/\*([\w\d]+)/g,L=/[-[\]{}()+?.,\\^$|#\s]/g;B.extend(Q.Router.prototype,Q.Events,{initialize:function(){},route:function(k,j,H){Q.history||(Q.history=new Q.History);B.isRegExp(k)||(k=this._routeToRegExp(k));Q.history.route(k,B.bind(function(w){w=this._extractParameters(k,w);H.apply(this,w);this.trigger.apply(this,["route:"+j].concat(w))},this))},navigate:function(k,j){Q.history.navigate(k,j)},_bindRoutes:function(){if(this.routes){var k=[],j;for(j in this.routes)k.unshift([j,
this.routes[j]]);j=0;for(var H=k.length;j<H;j++)this.route(k[j][0],k[j][1],this[k[j][1]])}},_routeToRegExp:function(k){k=k.replace(L,"\\$&").replace(m,"([^/]*)").replace(K,"(.*?)");return RegExp("^"+k+"$")},_extractParameters:function(k,j){return k.exec(j).slice(1)}});Q.History=function(){this.handlers=[];B.bindAll(this,"checkUrl")};var l=/^#*/,z=/msie [\w.]+/,C=false;B.extend(Q.History.prototype,{interval:50,getFragment:function(k,j){if(k==null)if(this._hasPushState||j){k=window.location.pathname;
var H=window.location.search;H&&(k+=H);k.indexOf(this.options.root)==0&&(k=k.substr(this.options.root.length))}else k=window.location.hash;return decodeURIComponent(k.replace(l,""))},start:function(k){if(C)throw Error("Backbone.history has already been started");this.options=B.extend({},{root:"/"},this.options,k);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);k=this.getFragment();var j=document.documentMode;if(j=
z.exec(navigator.userAgent.toLowerCase())&&(!j||j<=7)){this.iframe=T('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(k)}this._hasPushState?T(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!j?T(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=k;C=true;k=window.location;j=k.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!j)return this.fragment=this.getFragment(null,
true),window.location.replace(this.options.root+"#"+this.fragment),true;else if(this._wantsPushState&&this._hasPushState&&j&&k.hash){this.fragment=k.hash.replace(l,"");window.history.replaceState({},document.title,k.protocol+"//"+k.host+this.options.root+this.fragment)}if(!this.options.silent)return this.loadUrl()},route:function(k,j){this.handlers.unshift({route:k,callback:j})},checkUrl:function(){var k=this.getFragment();k==this.fragment&&this.iframe&&(k=this.getFragment(this.iframe.location.hash));
if(k==this.fragment||k==decodeURIComponent(this.fragment))return false;this.iframe&&this.navigate(k);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(k){var j=this.fragment=this.getFragment(k);return B.any(this.handlers,function(H){if(H.route.test(j))return H.callback(j),true})},navigate:function(k,j){var H=(k||"").replace(l,"");if(!(this.fragment==H||this.fragment==decodeURIComponent(H))){if(this._hasPushState){var w=window.location;H.indexOf(this.options.root)!=0&&(H=this.options.root+
H);this.fragment=H;window.history.pushState({},document.title,w.protocol+"//"+w.host+H)}else if(window.location.hash=this.fragment=H,this.iframe&&H!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=H}j&&this.loadUrl(k)}}});Q.View=function(k){this.cid=B.uniqueId("view");this._configure(k||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var i=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes",
"className","tagName"];B.extend(Q.View.prototype,Q.Events,{tagName:"div",$:function(k){return T(k,this.el)},initialize:function(){},render:function(){return this},remove:function(){T(this.el).remove();return this},make:function(k,j,H){k=document.createElement(k);j&&T(k).attr(j);H&&T(k).html(H);return k},delegateEvents:function(k){if(k||(k=this.events))for(var j in B.isFunction(k)&&(k=k.call(this)),T(this.el).unbind(".delegateEvents"+this.cid),k){var H=this[k[j]];if(!H)throw Error('Event "'+k[j]+'" does not exist');
var w=j.match(i),o=w[1];w=w[2];H=B.bind(H,this);o+=".delegateEvents"+this.cid;w===""?T(this.el).bind(o,H):T(this.el).delegate(w,o,H)}},_configure:function(k){this.options&&(k=B.extend({},this.options,k));for(var j=0,H=p.length;j<H;j++){var w=p[j];k[w]&&(this[w]=k[w])}this.options=k},_ensureElement:function(){if(this.el){if(B.isString(this.el))this.el=T(this.el).get(0)}else{var k=this.attributes||{};if(this.id)k.id=this.id;if(this.className)k["class"]=this.className;this.el=this.make(this.tagName,
k)}}});Q.Model.extend=Q.Collection.extend=Q.Router.extend=Q.View.extend=function(k,j){var H=F(this,k,j);H.extend=this.extend;return H};var r={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};Q.sync=function(k,j,H){var w=r[k];H=B.extend({type:w,dataType:"json"},H);if(!H.url)H.url=R(j)||W();if(!H.data&&j&&(k=="create"||k=="update")){H.contentType="application/json";H.data=JSON.stringify(j.toJSON())}if(Q.emulateJSON){H.contentType="application/x-www-form-urlencoded";H.data=H.data?{model:H.data}:
{}}if(Q.emulateHTTP&&(w==="PUT"||w==="DELETE")){if(Q.emulateJSON)H.data._method=w;H.type="POST";H.beforeSend=function(o){o.setRequestHeader("X-HTTP-Method-Override",w)}}if(H.type!=="GET"&&!Q.emulateJSON)H.processData=false;return T.ajax(H)};var G=function(){},F=function(k,j,H){var w;w=j&&j.hasOwnProperty("constructor")?j.constructor:function(){return k.apply(this,arguments)};B.extend(w,k);G.prototype=k.prototype;w.prototype=new G;j&&B.extend(w.prototype,j);H&&B.extend(w,H);w.prototype.constructor=
w;w.__super__=k.prototype;return w},R=function(k){if(!k||!k.url)return null;return B.isFunction(k.url)?k.url():k.url},W=function(){throw Error('A "url" property or function must be specified');},Y=function(k,j,H){return function(w){k?k(j,w,H):j.trigger("error",j,w,H)}}}).call(this);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function s(p){if(m&&(K||!B||!B.log))m.apply(Z,p)}for(var Z=this,Q=Array.prototype.slice,B=Z.console,T={},m,K,L=9,l=["error","warn","info","debug","log"],z="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),C=z.length,i=[];--C>=0;)(function(p){T[p]=function(){L!==0&&B&&B[p]&&B[p].apply(B,arguments)}})(z[C]);for(C=l.length;--C>=0;)(function(p,r){T[r]=function(){var G=Q.call(arguments),F=[r].concat(G);
i.push(F);s(F);if(B&&(L>0?L>p:l.length+L<=p))B.firebug?B[r].apply(Z,G):B[r]?B[r](G):B.log(G)}})(C,l[C]);T.setLevel=function(p){L=typeof p==="number"?p:9};T.setCallback=function(){var p=Q.call(arguments),r=i.length,G=r;m=p.shift()||null;K=typeof p[0]==="boolean"?p.shift():false;for(G-=typeof p[0]==="number"?p.shift():r;G<r;)s(i[G++])};return T}();/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(s){function Z(o,y,D,E){E={data:E||E===0||E===false?E:y?y.data:{},_wrap:y?y._wrap:null,tmpl:null,parent:y||null,nodes:[],calls:l,nest:z,wrap:C,html:i,update:p};o&&s.extend(E,o,{nodes:[],parent:y});if(D){E.tmpl=D;E._ctnt=E._ctnt||E.tmpl(s,E);E.key=++j;(w.length?W:R)[j]=E}return E}function Q(o,y,D){var E;D=D?s.map(D,function(P){return typeof P==="string"?o.key?P.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+G+'="'+o.key+'" $2'):P:Q(P,o,P._ctnt)}):o;if(y)return D;D=D.join("");D.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(P,h,q,A){E=s(q).get();L(E);if(h)E=B(h).concat(E);if(A)E=E.concat(B(A))});return E?E:B(D)}function B(o){var y=document.createElement("div");y.innerHTML=o;return s.makeArray(y.childNodes)}function T(o){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+s.trim(o).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(y,D,E,P,h,q,A){y=s.tmpl.tag[E];if(!y)throw"Unknown template tag: "+E;E=y._default||[];if(q&&!/\w$/.test(h)){h+=q;q=""}if(h){h=K(h);A=A?","+K(A)+")":q?")":"";A=q?h.indexOf(".")>-1?h+K(q):"("+h+").call($item"+A:h;q=q?A:"(typeof("+h+")==='function'?("+h+").call($item):("+h+"))"}else q=A=E.$1||"null";P=K(P);return"');"+y[D?"close":"open"].split("$notnull_1").join(h?"typeof("+h+")!=='undefined' && ("+h+")!=null":"true").split("$1a").join(q).split("$1").join(A).split("$2").join(P||E.$2||"")+"__.push('"})+
"');}return __;")}function m(o,y){o._wrap=Q(o,true,s.isArray(y)?y:[F.test(y)?y:s(y).html()]).join("")}function K(o){return o?o.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function L(o){function y(O){function X(ha){ha+=D;fa=h[ha]=h[ha]||Z(fa,R[fa.parent.key+D]||fa.parent)}var ga,ba=O,fa,la;if(la=O.getAttribute(G)){for(;ba.parentNode&&(ba=ba.parentNode).nodeType===1&&!(ga=ba.getAttribute(G)););if(ga!==la){ba=ba.parentNode?ba.nodeType===11?0:ba.getAttribute(G)||0:0;if(!(fa=R[la])){fa=W[la];fa=Z(fa,
R[ba]||W[ba]);fa.key=++j;R[j]=fa}H&&X(la)}O.removeAttribute(G)}else if(H&&(fa=s.data(O,"tmplItem"))){X(fa.key);R[fa.key]=fa;ba=(ba=s.data(O.parentNode,"tmplItem"))?ba.key:0}if(fa){for(ga=fa;ga&&ga.key!=ba;){ga.nodes.push(O);ga=ga.parent}delete fa._ctnt;delete fa._wrap;s.data(O,"tmplItem",fa)}}var D="_"+H,E,P,h={},q,A,I;q=0;for(A=o.length;q<A;q++)if((E=o[q]).nodeType===1){P=E.getElementsByTagName("*");for(I=P.length-1;I>=0;I--)y(P[I]);y(E)}}function l(o,y,D,E){if(!o)return w.pop();w.push({_:o,tmpl:y,
item:this,data:D,options:E})}function z(o,y,D){return s.tmpl(s.template(o),y,D,this)}function C(o,y){var D=o.options||{};D.wrapped=y;return s.tmpl(s.template(o.tmpl),o.data,D,o.item)}function i(o,y){var D=this._wrap;return s.map(s(s.isArray(D)?D.join(""):D).filter(o||"*"),function(E){if(y)E=E.innerText||E.textContent;else{var P;if(!(P=E.outerHTML)){P=document.createElement("div");P.appendChild(E.cloneNode(true));P=P.innerHTML}E=P}return E})}function p(){var o=this.nodes;s.tmpl(null,null,null,this).insertBefore(o[0]);
s(o).remove()}var r=s.fn.domManip,G="_tmplitem",F=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,R={},W={},Y,k={key:0,data:{}},j=0,H=0,w=[];s.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(o,y){s.fn[o]=function(D){var E=[];D=s(D);var P,h,q;P=this.length===1&&this[0].parentNode;Y=R||{};if(P&&P.nodeType===11&&P.childNodes.length===1&&D.length===1){D[y](this[0]);E=this}else{h=0;for(q=D.length;h<q;h++){H=h;P=(h>0?this.clone(true):this).get();
s(D[h])[y](P);E=E.concat(P)}H=0;E=this.pushStack(E,o,D.selector)}D=Y;Y=null;s.tmpl.complete(D);return E}});s.fn.extend({tmpl:function(o,y,D){return s.tmpl(this[0],o,y,D)},tmplItem:function(){return s.tmplItem(this[0])},template:function(o){return s.template(o,this[0])},domManip:function(o,y,D){if(o[0]&&s.isArray(o[0])){for(var E=s.makeArray(arguments),P=o[0],h=P.length,q=0,A;q<h&&!(A=s.data(P[q++],"tmplItem")););if(A&&H)E[2]=function(I){s.tmpl.afterManip(this,I,D)};r.apply(this,E)}else r.apply(this,
arguments);H=0;Y||s.tmpl.complete(R);return this}});s.extend({tmpl:function(o,y,D,E){var P=!E;if(P){E=k;o=s.template[o]||s.template(null,o);W={}}else if(!o){o=E.tmpl;R[E.key]=E;E.nodes=[];E.wrapped&&m(E,E.wrapped);return s(Q(E,null,E.tmpl(s,E)))}if(!o)return[];if(typeof y==="function")y=y.call(E||{});D&&D.wrapped&&m(D,D.wrapped);y=s.isArray(y)?s.map(y,function(h){return h?Z(D,E,o,h):null}):[Z(D,E,o,y)];return P?s(Q(E,null,y)):y},tmplItem:function(o){var y;if(o instanceof s)o=o[0];for(;o&&o.nodeType===
1&&!(y=s.data(o,"tmplItem"))&&(o=o.parentNode););return y||k},template:function(o,y){if(y){if(typeof y==="string")y=T(y);else if(y instanceof s)y=y[0]||{};if(y.nodeType)y=s.data(y,"tmpl")||s.data(y,"tmpl",T(y.innerHTML));return typeof o==="string"?s.template[o]=y:y}return o?typeof o!=="string"?s.template(null,o):s.template[o]||s.template(null,F.test(o)?o:s(o)):null},encode:function(o){return(""+o).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
s.extend(s.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){R={}},afterManip:function(o,y,D){var E=y.nodeType===11?s.makeArray(y.childNodes):y.nodeType===1?[y]:[];D.call(o,y);L(E);H++}})})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(s){function Z(B){var T=B||window.event,m=[].slice.call(arguments,1),K=0,L=0,l=0;B=s.event.fix(T);B.type="mousewheel";if(B.wheelDelta)K=B.wheelDelta/120;if(B.detail)K=-B.detail/3;l=K;if(T.axis!==undefined&&T.axis===T.HORIZONTAL_AXIS){l=0;L=-1*K}if(T.wheelDeltaY!==undefined)l=T.wheelDeltaY/120;if(T.wheelDeltaX!==undefined)L=-1*T.wheelDeltaX/120;m.unshift(B,K,L,l);return s.event.handle.apply(this,m)}var Q=["DOMMouseScroll","mousewheel"];s.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var B=
Q.length;B;)this.addEventListener(Q[--B],Z,false);else this.onmousewheel=Z},teardown:function(){if(this.removeEventListener)for(var B=Q.length;B;)this.removeEventListener(Q[--B],Z,false);else this.onmousewheel=null}};s.fn.extend({mousewheel:function(B){return B?this.bind("mousewheel",B):this.trigger("mousewheel")},unmousewheel:function(B){return this.unbind("mousewheel",B)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(s){function Z(){if(l){window.clearTimeout(C);l=false;z=null}}function Q(p){if(!l){l=true;z=p.changedTouches[0];C=window.setTimeout(function(){l=false;var r=z,G=document.createEvent("MouseEvent");G.initMouseEvent("mouseup",true,true,window,1,r.screenX,r.screenY,r.clientX,r.clientY,false,false,false,false,0,null);r.target.dispatchEvent(G);G=document.createEvent("MouseEvent");G.initMouseEvent("mousedown",true,true,window,1,r.screenX,r.screenY,r.clientX,r.clientY,false,false,false,false,2,null);
r.target.dispatchEvent(G);G=document.createEvent("MouseEvent");G.initMouseEvent("contextmenu",true,true,window,1,r.screenX+50,r.screenY+5,r.clientX+50,r.clientY+5,false,false,false,false,2,null);r.target.dispatchEvent(G);i=true;z=null},800)}}function B(p){var r=p.changedTouches[0],G="mouseover",F=document.createEvent("MouseEvent");F.initMouseEvent(G,true,true,window,1,r.screenX,r.screenY,r.clientX,r.clientY,false,false,false,false,0,null);r.target.dispatchEvent(F);G="mousedown";F=document.createEvent("MouseEvent");
F.initMouseEvent(G,true,true,window,1,r.screenX,r.screenY,r.clientX,r.clientY,false,false,false,false,0,null);r.target.dispatchEvent(F);if(K){window.clearTimeout(L);if(r.target==m){m=null;K=false;G="click";F=document.createEvent("MouseEvent");F.initMouseEvent(G,true,true,window,1,r.screenX,r.screenY,r.clientX,r.clientY,false,false,false,false,0,null);r.target.dispatchEvent(F);G="dblclick";F=document.createEvent("MouseEvent");F.initMouseEvent(G,true,true,window,1,r.screenX,r.screenY,r.clientX,r.clientY,
false,false,false,false,0,null);r.target.dispatchEvent(F)}else{m=r.target;K=true;L=window.setTimeout(function(){K=false},600);Q(p)}}else{m=r.target;K=true;L=window.setTimeout(function(){K=false},600);Q(p)}}function T(p){var r="";if(!(p.touches.length>1)){switch(p.type){case "gesturestart":p.preventDefault();break;case "touchstart":if(s(p.changedTouches[0].target).is("select"))return;B(p);p.preventDefault();return false;case "touchmove":Z();r="mousemove";p.preventDefault();break;case "touchend":if(i){i=
false;p.preventDefault();return false}Z();r="mouseup";break;default:return}p=p.changedTouches[0];var G=document.createEvent("MouseEvent");G.initMouseEvent(r,true,true,window,1,p.screenX,p.screenY,p.clientX,p.clientY,false,false,false,false,0,null);p.target.dispatchEvent(G);if(r=="mouseup"&&K&&p.target==m){G=document.createEvent("MouseEvent");G.initMouseEvent("click",true,true,window,1,p.screenX,p.screenY,p.clientX,p.clientY,false,false,false,false,0,null);p.target.dispatchEvent(G)}}}s.extend(s.support,
{touch:typeof Touch=="object"});s.fn.addTouch=function(){s.support.touch&&this.each(function(p,r){r.addEventListener("touchstart",T,false);r.addEventListener("touchmove",T,false);r.addEventListener("touchend",T,false);r.addEventListener("touchcancel",T,false)})};var m=null,K=false,L=null,l=false,z=null,C=null,i=false})(jQuery);
/iPad|iPhone/.test(navigator.userAgent)&&function(s){var Z=s.ui.mouse.prototype,Q=Z._mouseInit;s.extend(Z,{_mouseInit:function(){this.element.bind("touchstart."+this.widgetName,s.proxy(this,"_touchStart"));Q.apply(this,arguments)},_touchStart:function(B){if(B.originalEvent.targetTouches.length!=1)return false;this.element.bind("touchmove."+this.widgetName,s.proxy(this,"_touchMove")).bind("touchend."+this.widgetName,s.proxy(this,"_touchEnd"));this._modifyEvent(B);this._mouseDown(B);return false},_touchMove:function(B){this._modifyEvent(B);
this._mouseMove(B)},_touchEnd:function(B){this.element.unbind("touchmove."+this.widgetName).unbind("touchend."+this.widgetName);this._mouseUp(B)},_modifyEvent:function(B){B.which=1;var T=B.originalEvent.targetTouches[0];B.pageX=T.clientX;B.pageY=T.clientY}})}(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function s(){if(s.is(arguments[0],O)){for(var a=arguments[0],c=Na[R](s,a.splice(0,3+s.is(a[0],I))),d=c.set(),f=0,g=a[o];f<g;f++){var e=a[f]||{};L[C](e.type)&&d[ba](c[e.type]().attr(e))}return d}return Na[R](s,arguments)}function Z(){for(var a=[],c=0;c<32;c++)a[c]=(~~(D.random()*16))[X](16);a[12]=4;a[16]=(a[16]&3|8)[X](16);return"r-"+a[w]("")}function Q(a,c,d){function f(){var g=Array[z].slice.call(arguments,0),e=g[w]("\u25ba"),n=f.cache=f.cache||{},u=f.count=f.count||[];if(n[C](e))return d?
d(n[e]):n[e];u[o]>=1E3&&delete n[u.shift()];u[ba](e);n[e]=a[R](c,g);return d?d(n[e]):n[e]}return f}function B(){return this.x+Y+this.y}function T(a){return function(c,d,f,g){var e={back:a};s.is(f,"function")?g=f:e.rot=f;c&&c.constructor==ja&&(c=c.attrs.path);c&&(e.along=c);return this.animate(e,d,g)}}function m(a,c,d,f,g,e){function n(U,ea){var V,S,aa,ka;aa=U;for(S=0;S<8;S++){ka=((x*aa+v)*aa+u)*aa-U;if(h(ka)<ea)return aa;V=(3*x*aa+2*v)*aa+u;if(h(V)<1.0E-6)break;aa-=ka/V}V=0;S=1;aa=U;if(aa<V)return V;
if(aa>S)return S;for(;V<S;){ka=((x*aa+v)*aa+u)*aa;if(h(ka-U)<ea)break;U>ka?V=aa:S=aa;aa=(S-V)/2+V}return aa}var u=3*c,v=3*(f-c)-u,x=1-u-v,J=3*d,M=3*(g-d)-J,N=1-J-M;return function(U,ea){var V=n(U,ea);return((N*V+M)*V+J)*V}(a,1/(200*e))}s.version="1.5.2";var K=/[, ]+/,L={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},l=/\{(\d+)\}/g,z="prototype",C="hasOwnProperty",i=document,p=window,r={was:Object[z][C].call(p,"Raphael"),is:p.Raphael},G=function(){this.customAttributes={}},F,R="apply",W="createTouch"in
i,Y=" ",k=String,j="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(Y),H={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},w="join",o="length",y=k[z].toLowerCase,D=Math,E=D.max,P=D.min,h=D.abs,q=D.pow,A=D.PI,I="number",O="array",X="toString",ga=Object[z][X],ba="push",fa=/^url\(['"]?([^\)]+?)['"]?\)$/i,la=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ha={NaN:1,Infinity:1,"-Infinity":1},ra=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ca=D.round,$=parseFloat,na=parseInt,wa=k[z].toUpperCase,Ea={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Oa={along:"along",blur:I,"clip-rect":"csv",cx:I,cy:I,fill:"colour","fill-opacity":I,"font-size":I,height:I,opacity:I,path:"path",r:I,rotation:"csv",rx:I,ry:I,scale:"csv",stroke:"colour","stroke-opacity":I,"stroke-width":I,translation:"csv",width:I,x:I,y:I},ub=/^(from|to|\d+%?)$/,Pa=/\s*,\s*/,vb={hs:1,rg:1},wb=/,?([achlmqrstvxz]),?/gi,
xb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,yb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Za=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,zb=function(a,c){return a.key-c.key};s.type=p.SVGAngle||i.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(s.type=="VML"){var ta=i.createElement("div");ta.innerHTML='<v:shape adj="1"/>';ta=ta.firstChild;ta.style.behavior="url(#default#VML)";if(!(ta&&typeof ta.adj=="object"))return s.type=null;ta=null}s.svg=
!(s.vml=s.type=="VML");G[z]=s[z];F=G[z];s._id=0;s._oid=0;s.fn={};s.is=function(a,c){c=y.call(c);if(c=="finite")return!ha[C](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||ga.call(a).slice(8,-1).toLowerCase()==c};s.angle=function(a,c,d,f,g,e){if(g==null){a-=d;c-=f;if(!a&&!c)return 0;return((a<0)*180+D.atan(-c/-a)*180/A+360)%360}return s.angle(a,c,g,e)-s.angle(d,f,g,e)};s.rad=function(a){return a%360*A/180};s.deg=function(a){return a*
180/A%360};s.snapTo=function(a,c,d){d=s.is(d,"finite")?d:10;if(s.is(a,O))for(var f=a.length;f--;){if(h(a[f]-c)<=d)return a[f]}else{a=+a;f=c%a;if(f<d)return c-f;if(f>a-d)return c-f+a}return c};s.setWindow=function(a){p=a;i=p.document};var Fa=function(a){if(s.vml){var c=/^\s+|\s+$/g,d;try{var f=new ActiveXObject("htmlfile");f.write("<body>");f.close();d=f.body}catch(g){d=createPopup().document.body}var e=d.createTextRange();Fa=Q(function(u){try{d.style.color=k(u).replace(c,"");var v=e.queryCommandValue("ForeColor");
return"#"+("000000"+((v&255)<<16|v&65280|(v&16711680)>>>16)[X](16)).slice(-6)}catch(x){return"none"}})}else{var n=i.createElement("i");n.title="Rapha\u00ebl Colour Picker";n.style.display="none";i.body.appendChild(n);Fa=Q(function(u){n.style.color=u;return i.defaultView.getComputedStyle(n,"").getPropertyValue("color")})}return Fa(a)},$a=function(){return"hsb("+[this.h,this.s,this.b]+")"},Ab=function(){return"hsl("+[this.h,this.s,this.l]+")"},Bb=function(){return this.hex};s.hsb2rgb=function(a,c,d,
f){if(s.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){d=a.b;c=a.s;a=a.h;f=a.o}return s.hsl2rgb(a,c,d/2,f)};s.hsl2rgb=function(a,c,d,f){if(s.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){d=a.l;c=a.s;a=a.h}if(a>1||c>1||d>1){a/=360;c/=100;d/=100}var g={},e=["r","g","b"],n;if(c){d<0.5?n=d*(1+c):n=d+c-d*c;c=2*d-n;for(var u=0;u<3;u++){d=a+1/3*-(u-1);d<0&&d++;d>1&&d--;d*6<1?g[e[u]]=c+(n-c)*6*d:d*2<1?g[e[u]]=n:d*3<2?g[e[u]]=c+(n-c)*(2/3-d)*6:g[e[u]]=c}}else g={r:d,g:d,b:d};g.r*=255;g.g*=255;g.b*=255;g.hex="#"+
(16777216|g.b|g.g<<8|g.r<<16).toString(16).slice(1);s.is(f,"finite")&&(g.opacity=f);g.toString=Bb;return g};s.rgb2hsb=function(a,c,d){if(c==null&&s.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&s.is(a,"string")){d=s.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=E(a,c,d),g=P(a,c,d),e;if(g==f)return{h:0,s:0,b:f,toString:$a};g=f-g;a==f?e=(c-d)/g:c==f?e=2+(d-a)/g:e=4+(a-c)/g;e/=6;e<0&&e++;e>1&&e--;return{h:e,s:g/f,b:f,toString:$a}};s.rgb2hsl=function(a,
c,d){if(c==null&&s.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&s.is(a,"string")){d=s.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=E(a,c,d),g=P(a,c,d),e,n=(f+g)/2;if(g==f)a={h:0,s:0,l:n};else{var u=f-g;a==f?e=(c-d)/u:c==f?e=2+(d-a)/u:e=4+(a-c)/u;e/=6;e<0&&e++;e>1&&e--;a={h:e,s:n<0.5?u/(f+g):u/(2-f-g),l:n}}a.toString=Ab;return a};s._path2string=function(){return this.join(",").replace(wb,"$1")};s.getRGB=Q(function(a){if(!a||(a=k(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(vb[C](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Fa(a));var c,d,f,g,e;if(a=a.match(la)){if(a[2]){f=na(a[2].substring(5),16);d=na(a[2].substring(3,5),16);c=na(a[2].substring(1,3),16)}if(a[3]){f=na((e=a[3].charAt(3))+e,16);d=na((e=a[3].charAt(2))+e,16);c=na((e=a[3].charAt(1))+e,16)}if(a[4]){e=a[4].split(Pa);c=$(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=$(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=$(e[2]);
e[2].slice(-1)=="%"&&(f*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(g=$(e[3]));e[3]&&e[3].slice(-1)=="%"&&(g/=100)}if(a[5]){e=a[5].split(Pa);c=$(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=$(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=$(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(g=$(e[3]));e[3]&&e[3].slice(-1)=="%"&&(g/=100);return s.hsb2rgb(c,d,f,g)}if(a[6]){e=a[6].split(Pa);c=$(e[0]);e[0].slice(-1)=="%"&&(c*=
2.55);d=$(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=$(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(g=$(e[3]));e[3]&&e[3].slice(-1)=="%"&&(g/=100);return s.hsl2rgb(c,d,f,g)}a={r:c,g:d,b:f};a.hex="#"+(16777216|f|d<<8|c<<16).toString(16).slice(1);s.is(g,"finite")&&(a.opacity=g);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},s);s.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};
var c=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return c.hex};s.getColor.reset=function(){delete this.start};s.parsePathString=Q(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];s.is(a,O)&&s.is(a[0],O)&&(d=Ga(a));d[o]||k(a).replace(xb,function(f,g,e){var n=[];f=y.call(g);e.replace(yb,function(u,v){v&&n[ba](+v)});if(f=="m"&&n[o]>2){d[ba]([g].concat(n.splice(0,2)));f="l";g=g=="m"?"l":"L"}for(;n[o]>=c[f];){d[ba]([g].concat(n.splice(0,
c[f])));if(!c[f])break}});d[X]=s._path2string;return d});s.findDotsAtSegment=function(a,c,d,f,g,e,n,u,v){var x=1-v,J=q(x,3)*a+q(x,2)*3*v*d+x*3*v*v*g+q(v,3)*n;x=q(x,3)*c+q(x,2)*3*v*f+x*3*v*v*e+q(v,3)*u;var M=a+2*v*(d-a)+v*v*(g-2*d+a),N=c+2*v*(f-c)+v*v*(e-2*f+c),U=d+2*v*(g-d)+v*v*(n-2*g+d),ea=f+2*v*(e-f)+v*v*(u-2*e+f);a=(1-v)*a+v*d;c=(1-v)*c+v*f;g=(1-v)*g+v*n;e=(1-v)*e+v*u;u=90-D.atan((M-U)/(N-ea))*180/A;(M>U||N<ea)&&(u+=180);return{x:J,y:x,m:{x:M,y:N},n:{x:U,y:ea},start:{x:a,y:c},end:{x:g,y:e},alpha:u}};
var Ia=Q(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ha(a);for(var c=0,d=0,f=[],g=[],e,n=0,u=a[o];n<u;n++){e=a[n];if(e[0]=="M"){c=e[1];d=e[2];f[ba](c);g[ba](d)}else{c=Cb(c,d,e[1],e[2],e[3],e[4],e[5],e[6]);f=f.concat(c.min.x,c.max.x);g=g.concat(c.min.y,c.max.y);c=e[5];d=e[6]}}a=P[R](0,f);e=P[R](0,g);return{x:a,y:e,width:E[R](0,f)-a,height:E[R](0,g)-e}}),Ga=function(a){var c=[];if(!s.is(a,O)||!s.is(a&&a[0],O))a=s.parsePathString(a);for(var d=0,f=a[o];d<f;d++){c[d]=[];for(var g=0,e=a[d][o];g<
e;g++)c[d][g]=a[d][g]}c[X]=s._path2string;return c},Qa=Q(function(a){if(!s.is(a,O)||!s.is(a&&a[0],O))a=s.parsePathString(a);var c=[],d=0,f=0,g=0,e=0,n=0;if(a[0][0]=="M"){d=a[0][1];f=a[0][2];g=d;e=f;n++;c[ba](["M",d,f])}for(var u=a[o];n<u;n++){var v=c[n]=[],x=a[n];if(x[0]!=y.call(x[0])){v[0]=y.call(x[0]);switch(v[0]){case "a":v[1]=x[1];v[2]=x[2];v[3]=x[3];v[4]=x[4];v[5]=x[5];v[6]=+(x[6]-d).toFixed(3);v[7]=+(x[7]-f).toFixed(3);break;case "v":v[1]=+(x[1]-f).toFixed(3);break;case "m":g=x[1];e=x[2];default:for(var J=
1,M=x[o];J<M;J++)v[J]=+(x[J]-(J%2?d:f)).toFixed(3)}}else{c[n]=[];if(x[0]=="m"){g=x[1]+d;e=x[2]+f}v=0;for(J=x[o];v<J;v++)c[n][v]=x[v]}x=c[n][o];switch(c[n][0]){case "z":d=g;f=e;break;case "h":d+=+c[n][x-1];break;case "v":f+=+c[n][x-1];break;default:d+=+c[n][x-2];f+=+c[n][x-1]}}c[X]=s._path2string;return c},0,Ga),Aa=Q(function(a){if(!s.is(a,O)||!s.is(a&&a[0],O))a=s.parsePathString(a);var c=[],d=0,f=0,g=0,e=0,n=0;if(a[0][0]=="M"){d=+a[0][1];f=+a[0][2];g=d;e=f;n++;c[0]=["M",d,f]}for(var u=a[o];n<u;n++){var v=
c[n]=[],x=a[n];if(x[0]!=wa.call(x[0])){v[0]=wa.call(x[0]);switch(v[0]){case "A":v[1]=x[1];v[2]=x[2];v[3]=x[3];v[4]=x[4];v[5]=x[5];v[6]=+(x[6]+d);v[7]=+(x[7]+f);break;case "V":v[1]=+x[1]+f;break;case "H":v[1]=+x[1]+d;break;case "M":g=+x[1]+d;e=+x[2]+f;default:for(var J=1,M=x[o];J<M;J++)v[J]=+x[J]+(J%2?d:f)}}else{J=0;for(M=x[o];J<M;J++)c[n][J]=x[J]}switch(v[0]){case "Z":d=g;f=e;break;case "H":d=v[1];break;case "V":f=v[1];break;case "M":g=c[n][c[n][o]-2];e=c[n][c[n][o]-1];default:d=c[n][c[n][o]-2];f=
c[n][c[n][o]-1]}}c[X]=s._path2string;return c},null,Ga),ab=function(a,c,d,f,g,e){var n=1/3,u=2/3;return[n*a+u*d,n*c+u*f,n*g+u*d,n*e+u*f,g,e]},bb=function(a,c,d,f,g,e,n,u,v,x){var J=A*120/180,M=A/180*(+g||0),N=[],U,ea=Q(function(oa,pa,ma){var ya=oa*D.cos(ma)-pa*D.sin(ma);oa=oa*D.sin(ma)+pa*D.cos(ma);return{x:ya,y:oa}});if(x){aa=x[0];U=x[1];e=x[2];S=x[3]}else{U=ea(a,c,-M);a=U.x;c=U.y;U=ea(u,v,-M);u=U.x;v=U.y;D.cos(A/180*g);D.sin(A/180*g);U=(a-u)/2;aa=(c-v)/2;S=U*U/(d*d)+aa*aa/(f*f);if(S>1){S=D.sqrt(S);
d*=S;f*=S}S=d*d;var V=f*f;S=(e==n?-1:1)*D.sqrt(h((S*V-S*aa*aa-V*U*U)/(S*aa*aa+V*U*U)));e=S*d*aa/f+(a+u)/2;var S=S*-f*U/d+(c+v)/2,aa=D.asin(((c-S)/f).toFixed(9));U=D.asin(((v-S)/f).toFixed(9));aa=a<e?A-aa:aa;U=u<e?A-U:U;aa<0&&(aa=A*2+aa);U<0&&(U=A*2+U);n&&aa>U&&(aa-=A*2);!n&&U>aa&&(U-=A*2)}if(h(U-aa)>J){N=U;V=u;var ka=v;U=aa+J*(n&&U>aa?1:-1);u=e+d*D.cos(U);v=S+f*D.sin(U);N=bb(u,v,d,f,g,0,n,V,ka,[U,N,e,S])}e=U-aa;g=D.cos(aa);J=D.sin(aa);n=D.cos(U);U=D.sin(U);e=D.tan(e/4);d=4/3*d*e;e*=4/3*f;f=[a,c];
a=[a+d*J,c-e*g];c=[u+d*U,v-e*n];u=[u,v];a[0]=2*f[0]-a[0];a[1]=2*f[1]-a[1];if(x)return[a,c,u].concat(N);N=[a,c,u].concat(N)[w]().split(",");x=[];u=0;for(v=N[o];u<v;u++)x[u]=u%2?ea(N[u-1],N[u],M).y:ea(N[u],N[u+1],M).x;return x},Ja=function(a,c,d,f,g,e,n,u,v){var x=1-v;return{x:q(x,3)*a+q(x,2)*3*v*d+x*3*v*v*g+q(v,3)*n,y:q(x,3)*c+q(x,2)*3*v*f+x*3*v*v*e+q(v,3)*u}},Cb=Q(function(a,c,d,f,g,e,n,u){var v=g-2*d+a-(n-2*g+d),x=2*(d-a)-2*(g-d),J=a-d,M=(-x+D.sqrt(x*x-4*v*J))/2/v;v=(-x-D.sqrt(x*x-4*v*J))/2/v;var N=
[c,u],U=[a,n];h(M)>"1e12"&&(M=0.5);h(v)>"1e12"&&(v=0.5);if(M>0&&M<1){M=Ja(a,c,d,f,g,e,n,u,M);U[ba](M.x);N[ba](M.y)}if(v>0&&v<1){M=Ja(a,c,d,f,g,e,n,u,v);U[ba](M.x);N[ba](M.y)}v=e-2*f+c-(u-2*e+f);x=2*(f-c)-2*(e-f);J=c-f;M=(-x+D.sqrt(x*x-4*v*J))/2/v;v=(-x-D.sqrt(x*x-4*v*J))/2/v;h(M)>"1e12"&&(M=0.5);h(v)>"1e12"&&(v=0.5);if(M>0&&M<1){M=Ja(a,c,d,f,g,e,n,u,M);U[ba](M.x);N[ba](M.y)}if(v>0&&v<1){M=Ja(a,c,d,f,g,e,n,u,v);U[ba](M.x);N[ba](M.y)}return{min:{x:P[R](0,U),y:P[R](0,N)},max:{x:E[R](0,U),y:E[R](0,N)}}}),
Ha=Q(function(a,c){var d=Aa(a),f=c&&Aa(c),g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},n=function(V,S){var aa,ka;if(!V)return["C",S.x,S.y,S.x,S.y,S.x,S.y];!(V[0]in{T:1,Q:1})&&(S.qx=S.qy=null);switch(V[0]){case "M":S.X=V[1];S.Y=V[2];break;case "A":V=["C"].concat(bb[R](0,[S.x,S.y].concat(V.slice(1))));break;case "S":aa=S.x+(S.x-(S.bx||S.x));ka=S.y+(S.y-(S.by||S.y));V=["C",aa,ka].concat(V.slice(1));break;case "T":S.qx=S.x+(S.x-(S.qx||S.x));S.qy=S.y+(S.y-
(S.qy||S.y));V=["C"].concat(ab(S.x,S.y,S.qx,S.qy,V[1],V[2]));break;case "Q":S.qx=V[1];S.qy=V[2];V=["C"].concat(ab(S.x,S.y,V[1],V[2],V[3],V[4]));break;case "L":V=["C"].concat([S.x,S.y,V[1],V[2],V[1],V[2]]);break;case "H":V=["C"].concat([S.x,S.y,V[1],S.y,V[1],S.y]);break;case "V":V=["C"].concat([S.x,S.y,S.x,V[1],S.x,V[1]]);break;case "Z":V=["C"].concat([S.x,S.y,S.X,S.Y,S.X,S.Y])}return V},u=function(V,S){if(V[S][o]>7){V[S].shift();for(var aa=V[S];aa[o];)V.splice(S++,0,["C"].concat(aa.splice(0,6)));
V.splice(S,1);J=E(d[o],f&&f[o]||0)}},v=function(V,S,aa,ka,oa){if(V&&S&&V[oa][0]=="M"&&S[oa][0]!="M"){S.splice(oa,0,["M",ka.x,ka.y]);aa.bx=0;aa.by=0;aa.x=V[oa][1];aa.y=V[oa][2];J=E(d[o],f&&f[o]||0)}},x=0,J=E(d[o],f&&f[o]||0);for(;x<J;x++){d[x]=n(d[x],g);u(d,x);f&&(f[x]=n(f[x],e));f&&u(f,x);v(d,f,g,e,x);v(f,d,e,g,x);var M=d[x],N=f&&f[x],U=M[o],ea=f&&N[o];g.x=M[U-2];g.y=M[U-1];g.bx=$(M[U-4])||g.x;g.by=$(M[U-3])||g.y;e.bx=f&&($(N[ea-4])||e.x);e.by=f&&($(N[ea-3])||e.y);e.x=f&&N[ea-2];e.y=f&&N[ea-1]}return f?
[d,f]:d},null,Ga),cb=Q(function(a){for(var c=[],d=0,f=a[o];d<f;d++){var g={},e=a[d].match(/^([^:]*):?([\d\.]*)/);g.color=s.getRGB(e[1]);if(g.color.error)return null;g.color=g.color.hex;e[2]&&(g.offset=e[2]+"%");c[ba](g)}d=1;for(f=c[o]-1;d<f;d++)if(!c[d].offset){a=$(c[d-1].offset||0);e=0;for(g=d+1;g<f;g++)if(c[g].offset){e=c[g].offset;break}if(!e){e=100;g=f}e=$(e);for(e=(e-a)/(g-d+1);d<g;d++){a+=e;c[d].offset=a+"%"}}return c}),db=function(a,c,d,f){if(s.is(a,"string")||s.is(a,"object")){a=s.is(a,"string")?
i.getElementById(a):a;if(a.tagName)return c==null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:f}},Ra=function(a,c){var d=this,f;for(f in c)if(c[C](f)&&!(f in a))switch(typeof c[f]){case "function":(function(g){a[f]=a===d?g:function(){return g[R](d,arguments)}})(c[f]);break;case "object":a[f]=a[f]||{};Ra.call(this,a[f],c[f]);break;default:a[f]=c[f]}},za=function(a,c){a==
c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},eb=function(a,c){if(c.top!==a){za(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a}},fb=function(a,c){if(c.bottom!==a){za(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a}},gb=function(a,c,d){za(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},hb=function(a,c,d){za(a,d);c==d.bottom&&(d.bottom=a);c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;
a.next=c},ib=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+a+"\u201d of removed object");}};s.pathToRelative=Qa;if(s.svg){F.svgns="http://www.w3.org/2000/svg";F.xlink="http://www.w3.org/1999/xlink";ca=function(a){return+a+(~~a===a)*0.5};var da=function(a,c){if(c)for(var d in c)c[C](d)&&a.setAttribute(d,k(c[d]));else{a=i.createElementNS(F.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};s[X]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+
this.version};var jb=function(a,c){var d=da("path");c.canvas&&c.canvas.appendChild(d);d=new ja(d,c);d.type="path";xa(d,{fill:"none",stroke:"#000",path:a});return d},Ba=function(a,c,d){var f="linear",g=0.5,e=0.5,n=a.style;c=k(c).replace(Za,function(J,M,N){f="radial";if(M&&N){g=$(M);e=$(N);J=(e>0.5)*2-1;q(g-0.5,2)+q(e-0.5,2)>0.25&&(e=D.sqrt(0.25-q(g-0.5,2))*J+0.5)&&e!=0.5&&(e=e.toFixed(5)-1.0E-5*J)}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var u=c.shift();u=-$(u);if(isNaN(u))return null;u=[0,
0,D.cos(u*A/180),D.sin(u*A/180)];var v=1/(E(h(u[2]),h(u[3]))||1);u[2]*=v;u[3]*=v;if(u[2]<0){u[0]=-u[2];u[2]=0}if(u[3]<0){u[1]=-u[3];u[3]=0}}c=cb(c);if(!c)return null;v=a.getAttribute("fill");(v=v.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(i.getElementById(v[1]));v=da(f+"Gradient");v.id=Z();da(v,f=="radial"?{fx:g,fy:e}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3]});d.defs.appendChild(v);d=0;for(u=c[o];d<u;d++){var x=da("stop");da(x,{offset:c[d].offset?c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});
v.appendChild(x)}da(a,{fill:"url(#"+v.id+")",opacity:1,"fill-opacity":1});n.fill="";n.opacity=1;return n.fillOpacity=1},Sa=function(a){var c=a.getBBox();da(a.pattern,{patternTransform:s.format("translate({0},{1})",c.x,c.y)})},xa=function(a,c){var d={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},f=a.node,g=a.attrs,e=a.rotate(),n=function(ea,V){if(V=d[y.call(V)]){for(var S=ea.attrs["stroke-width"]||
"1",aa={round:S,square:S,butt:0}[ea.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,ka=[],oa=V[o];oa--;)ka[oa]=V[oa]*S+(oa%2?1:-1)*aa;da(f,{"stroke-dasharray":ka[w](",")})}};c[C]("rotation")&&(e=c.rotation);var u=k(e).split(K);if(u.length-1){u[1]=+u[1];u[2]=+u[2]}else u=null;$(e)&&a.rotate(0,true);for(var v in c)if(c[C](v))if(Ea[C](v)){var x=c[v];g[v]=x;switch(v){case "blur":a.blur(x);break;case "rotation":a.rotate(x,true);break;case "href":case "title":case "target":var J=f.parentNode;if(y.call(J.tagName)!=
"a"){var M=da("a");J.insertBefore(M,f);M.appendChild(f);J=M}v=="target"&&x=="blank"?J.setAttributeNS(a.paper.xlink,"show","new"):J.setAttributeNS(a.paper.xlink,v,x);break;case "cursor":f.style.cursor=x;break;case "clip-rect":J=k(x).split(K);if(J[o]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var N=da("clipPath");M=da("rect");N.id=Z();da(M,{x:J[0],y:J[1],width:J[2],height:J[3]});N.appendChild(M);a.paper.defs.appendChild(N);da(f,{"clip-path":"url(#"+N.id+")"});a.clip=M}if(!x){(x=
i.getElementById(f.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,"")))&&x.parentNode.removeChild(x);da(f,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&da(f,{d:x?g.path=Aa(x):"M0,0"});break;case "width":f.setAttribute(v,x);if(g.fx){v="x";x=g.x}else break;case "x":g.fx&&(x=-g.x-(g.width||0));case "rx":if(v=="rx"&&a.type=="rect")break;case "cx":u&&(v=="x"||v=="cx")&&(u[1]+=x-g[v]);f.setAttribute(v,x);a.pattern&&Sa(a);break;case "height":f.setAttribute(v,x);if(g.fy){v="y";x=g.y}else break;
case "y":g.fy&&(x=-g.y-(g.height||0));case "ry":if(v=="ry"&&a.type=="rect")break;case "cy":u&&(v=="y"||v=="cy")&&(u[2]+=x-g[v]);f.setAttribute(v,x);a.pattern&&Sa(a);break;case "r":a.type=="rect"?da(f,{rx:x,ry:x}):f.setAttribute(v,x);break;case "src":a.type=="image"&&f.setAttributeNS(a.paper.xlink,"href",x);break;case "stroke-width":f.style.strokeWidth=x;f.setAttribute(v,x);g["stroke-dasharray"]&&n(a,g["stroke-dasharray"]);break;case "stroke-dasharray":n(a,x);break;case "translation":x=k(x).split(K);
x[0]=+x[0]||0;x[1]=+x[1]||0;if(u){u[1]+=x[0];u[2]+=x[1]}Ka.call(a,x[0],x[1]);break;case "scale":x=k(x).split(K);a.scale(+x[0]||1,+x[1]||+x[0]||1,isNaN($(x[2]))?null:+x[2],isNaN($(x[3]))?null:+x[3]);break;case "fill":if(J=k(x).match(fa)){N=da("pattern");var U=da("image");N.id=Z();da(N,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});da(U,{x:0,y:0});U.setAttributeNS(a.paper.xlink,"href",J[1]);N.appendChild(U);x=i.createElement("img");x.style.cssText="position:absolute;left:-9999em;top-9999em";
x.onload=function(){da(N,{width:this.offsetWidth,height:this.offsetHeight});da(U,{width:this.offsetWidth,height:this.offsetHeight});i.body.removeChild(this);a.paper.safari()};i.body.appendChild(x);x.src=J[1];a.paper.defs.appendChild(N);f.style.fill="url(#"+N.id+")";da(f,{fill:"url(#"+N.id+")"});a.pattern=N;a.pattern&&Sa(a);break}J=s.getRGB(x);if(J.error)if(({circle:1,ellipse:1}[C](a.type)||k(x).charAt()!="r")&&Ba(f,x,a.paper)){g.gradient=x;g.fill="none";break}else{delete c.gradient;delete g.gradient;
!s.is(g.opacity,"undefined")&&s.is(c.opacity,"undefined")&&da(f,{opacity:g.opacity});!s.is(g["fill-opacity"],"undefined")&&s.is(c["fill-opacity"],"undefined")&&da(f,{"fill-opacity":g["fill-opacity"]})}J[C]("opacity")&&da(f,{"fill-opacity":J.opacity>1?J.opacity/100:J.opacity});case "stroke":J=s.getRGB(x);f.setAttribute(v,J.hex);v=="stroke"&&J[C]("opacity")&&da(f,{"stroke-opacity":J.opacity>1?J.opacity/100:J.opacity});break;case "gradient":(({circle:1,ellipse:1})[C](a.type)||k(x).charAt()!="r")&&Ba(f,
x,a.paper);break;case "opacity":g.gradient&&!g[C]("stroke-opacity")&&da(f,{"stroke-opacity":x>1?x/100:x});case "fill-opacity":if(g.gradient){if(J=i.getElementById(f.getAttribute("fill").replace(/^url\(#|\)$/g,""))){J=J.getElementsByTagName("stop");J[J[o]-1].setAttribute("stop-opacity",x)}break}default:v=="font-size"&&(x=na(x,10)+"px");J=v.replace(/(\-.)/g,function(ea){return wa.call(ea.substring(1))});f.style[J]=x;f.setAttribute(v,x)}}Db(a,c);u?a.rotate(u.join(Y)):$(e)&&a.rotate(e,true)},Db=function(a,
c){if(!(a.type!="text"||!(c[C]("text")||c[C]("font")||c[C]("font-size")||c[C]("x")||c[C]("y")))){var d=a.attrs,f=a.node,g=f.firstChild?na(i.defaultView.getComputedStyle(f.firstChild,"").getPropertyValue("font-size"),10):10;if(c[C]("text")){for(d.text=c.text;f.firstChild;)f.removeChild(f.firstChild);for(var e=k(c.text).split("\n"),n=0,u=e[o];n<u;n++)if(e[n]){var v=da("tspan");n&&da(v,{dy:g*1.2,x:d.x});v.appendChild(i.createTextNode(e[n]));f.appendChild(v)}}else{e=f.getElementsByTagName("tspan");n=
0;for(u=e[o];n<u;n++)n&&da(e[n],{dy:g*1.2,x:d.x})}da(f,{y:d.y});g=a.getBBox();(g=d.y-(g.y+g.height/2))&&s.is(g,"finite")&&da(f,{y:d.y+g})}},ja=function(a,c){this[0]=a;this.id=s._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},ia=ja[z];ja[z].rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,
this._.rt.cx,this._.rt.cy][w](Y);return this._.rt.deg}var f=this.getBBox();a=k(a).split(K);if(a[o]-1){c=$(a[1]);d=$(a[2])}a=$(a[0]);c!=null&&c!==false?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;c=c==null?f.x+f.width/2:c;d=d==null?f.y+f.height/2:d;if(this._.rt.deg){this.transformations[0]=s.format("rotate({0} {1} {2})",this._.rt.deg,c,d);this.clip&&da(this.clip,{transform:s.format("rotate({0} {1} {2})",-this._.rt.deg,c,d)})}else{this.transformations[0]="";this.clip&&
da(this.clip,{transform:""})}da(this.node,{transform:this.transformations[w](Y)});return this};ja[z].hide=function(){!this.removed&&(this.node.style.display="none");return this};ja[z].show=function(){!this.removed&&(this.node.style.display="");return this};ja[z].remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ja[z].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Ia(this.attrs.path);
if(this.node.style.display=="none"){this.show();var a=true}var c={};try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if(this.type=="text"){c={x:c.x,y:Infinity,width:0,height:0};for(var f=0,g=this.node.getNumberOfChars();f<g;f++){var e=this.node.getExtentOfChar(f);e.y<c.y&&(c.y=e.y);e.y+e.height-c.y>c.height&&(c.height=e.y+e.height-c.y);e.x+e.width-c.x>c.width&&(c.width=e.x+e.width-c.x)}}a&&this.hide();return c};ja[z].attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[C](f)&&
(d[f]=this.attrs[f]);this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&s.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(c==null&&s.is(a,O)){f={};d=0;for(var g=a.length;d<g;d++)f[a[d]]=
this.attr(a[d]);return f}if(c!=null){d={};d[a]=c}else a!=null&&s.is(a,"object")&&(d=a);for(g in this.paper.customAttributes)if(this.paper.customAttributes[C](g)&&d[C](g)&&s.is(this.paper.customAttributes[g],"function")){f=this.paper.customAttributes[g].apply(this,[].concat(d[g]));this.attrs[g]=d[g];for(var e in f)f[C](e)&&(d[e]=f[e])}xa(this,d);return this};ja[z].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&eb(this,a);return this};
ja[z].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);fb(this,this.paper)}return this};ja[z].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);gb(this,a,this.paper);return this};ja[z].insertBefore=function(a){if(this.removed)return this;var c=
a.node||a[0].node;c.parentNode.insertBefore(this.node,c);hb(this,a,this.paper);return this};ja[z].blur=function(a){if(+a!==0){var c=da("filter"),d=da("feGaussianBlur");this.attrs.blur=a;c.id=Z();da(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;da(this.node,{filter:"url(#"+c.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var kb=function(a,c,d,f){var g=
da("circle");a.canvas&&a.canvas.appendChild(g);a=new ja(g,a);a.attrs={cx:c,cy:d,r:f,fill:"none",stroke:"#000"};a.type="circle";da(g,a.attrs);return a},lb=function(a,c,d,f,g,e){var n=da("rect");a.canvas&&a.canvas.appendChild(n);a=new ja(n,a);a.attrs={x:c,y:d,width:f,height:g,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};a.type="rect";da(n,a.attrs);return a},mb=function(a,c,d,f,g){var e=da("ellipse");a.canvas&&a.canvas.appendChild(e);a=new ja(e,a);a.attrs={cx:c,cy:d,rx:f,ry:g,fill:"none",stroke:"#000"};
a.type="ellipse";da(e,a.attrs);return a},nb=function(a,c,d,f,g,e){var n=da("image");da(n,{x:d,y:f,width:g,height:e,preserveAspectRatio:"none"});n.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(n);a=new ja(n,a);a.attrs={x:d,y:f,width:g,height:e,src:c};a.type="image";return a},ob=function(a,c,d,f){var g=da("text");da(g,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(g);a=new ja(g,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:f,font:Ea.font,stroke:"none",fill:"#000"};
a.type="text";xa(a,a.attrs);return a},pb=function(a,c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Na=function(){var a=db[R](0,arguments),c=a&&a.container,d=a.x,f=a.y,g=a.width;a=a.height;if(!c)throw Error("SVG container not found.");var e=da("svg");d=d||0;f=f||0;g=g||512;a=a||342;da(e,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:g,height:a});if(c==1){e.style.cssText="position:absolute;left:"+
d+"px;top:"+f+"px";i.body.appendChild(e)}else c.firstChild?c.insertBefore(e,c.firstChild):c.appendChild(e);c=new G;c.width=g;c.height=a;c.canvas=e;Ra.call(c,c,s.fn);c.clear();return c};F.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=da("desc")).appendChild(i.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=da("defs"))};F.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);
for(var a in this)this[a]=ib(a)}}if(s.vml){var qb={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Eb=/([clmz]),?([^clmz]*)/gi,Fb=/ progid:\S+Blur\([^\)]+\)/g,Gb=/-?[^,\s-]+/g,Ca=1E3+Y+1E3,Da={path:1,rect:1},Hb=function(a){var c=/[ahqstv]/ig,d=Aa;k(a).match(c)&&(d=Ha);c=/[clmz]/g;if(d==Aa&&!k(a).match(c))return a=k(a).replace(Eb,function(v,x,J){var M=[],N=y.call(x)=="m",U=qb[x];J.replace(Gb,function(ea){if(N&&M[o]==2){U+=M+qb[x=="m"?"l":"L"];M=[]}M[ba](ca(ea*10))});return U+M});c=d(a);var f;a=[];
for(var g=0,e=c[o];g<e;g++){d=c[g];f=y.call(c[g][0]);f=="z"&&(f="x");for(var n=1,u=d[o];n<u;n++)f+=ca(d[n]*10)+(n!=u-1?",":"");a[ba](f)}return a[w](Y)};s[X]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};jb=function(a,c){var d=qa("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var f=qa("shape"),g=f.style;g.width=c.width+
"px";g.height=c.height+"px";f.coordsize=Ca;f.coordorigin=c.coordorigin;d.appendChild(f);f=new ja(f,d,c);g={fill:"none",stroke:"#000"};a&&(g.path=a);f.type="path";f.path=[];f.Path="";xa(f,g);c.canvas.appendChild(d);return f};xa=function(a,c){a.attrs=a.attrs||{};var d=a.node,f=a.attrs,g=d.style,e;e=(c.x!=f.x||c.y!=f.y||c.width!=f.width||c.height!=f.height||c.r!=f.r)&&a.type=="rect";for(var n in c)c[C](n)&&(f[n]=c[n]);if(e){f.path=rb(f.x,f.y,f.width,f.height,f.r);a.X=f.x;a.Y=f.y;a.W=f.width;a.H=f.height}c.href&&
(d.href=c.href);c.title&&(d.title=c.title);c.target&&(d.target=c.target);c.cursor&&(g.cursor=c.cursor);"blur"in c&&a.blur(c.blur);if(c.path&&a.type=="path"||e)d.path=Hb(f.path);c.rotation!=null&&a.rotate(c.rotation,true);if(c.translation){e=k(c.translation).split(K);Ka.call(a,e[0],e[1]);if(a._.rt.cx!=null){a._.rt.cx+=+e[0];a._.rt.cy+=+e[1];a.setBox(a.attrs,e[0],e[1])}}if(c.scale){e=k(c.scale).split(K);a.scale(+e[0]||1,+e[1]||+e[0]||1,+e[2]||null,+e[3]||null)}if("clip-rect"in c){e=k(c["clip-rect"]).split(K);
if(e[o]==4){e[2]=+e[2]+ +e[0];e[3]=+e[3]+ +e[1];n=d.clipRect||i.createElement("div");var u=n.style,v=d.parentNode;u.clip=s.format("rect({1}px {2}px {3}px {0}px)",e);if(!d.clipRect){u.position="absolute";u.top=0;u.left=0;u.width=a.paper.width+"px";u.height=a.paper.height+"px";v.parentNode.insertBefore(n,v);n.appendChild(v);d.clipRect=n}}c["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="")}a.type=="image"&&c.src&&(d.src=c.src);if(a.type=="image"&&c.opacity){d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+
c.opacity*100+")";g.filter=(d.filterMatrix||"")+(d.filterOpacity||"")}c.font&&(g.font=c.font);c["font-family"]&&(g.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');c["font-size"]&&(g.fontSize=c["font-size"]);c["font-weight"]&&(g.fontWeight=c["font-weight"]);c["font-style"]&&(g.fontStyle=c["font-style"]);if(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=
null||c["stroke-miterlimit"]!=null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){d=a.shape||d;e=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];n=false;!e&&(n=e=qa("fill"));if("fill-opacity"in c||"opacity"in c){g=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+s.getRGB(c.fill).o+1||2)-1);g=P(E(g,0),1);e.opacity=g}c.fill&&(e.on=true);if(e.on==null||c.fill=="none")e.on=false;if(e.on&&c.fill)if(g=c.fill.match(fa)){e.src=g[1];e.type="tile"}else{e.color=s.getRGB(c.fill).hex;
e.src="";e.type="solid";if(s.getRGB(c.fill).error&&(a.type in{circle:1,ellipse:1}||k(c.fill).charAt()!="r")&&Ba(a,c.fill)){f.fill="none";f.gradient=c.fill}}n&&d.appendChild(e);e=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];n=false;!e&&(n=e=qa("stroke"));if(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])e.on=true;(c.stroke=="none"||e.on==null||c.stroke==0||c["stroke-width"]==
0)&&(e.on=false);g=s.getRGB(c.stroke);e.on&&c.stroke&&(e.color=g.hex);g=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+g.o+1||2)-1);u=($(c["stroke-width"])||1)*0.75;g=P(E(g,0),1);c["stroke-width"]==null&&(u=f["stroke-width"]);c["stroke-width"]&&(e.weight=u);u&&u<1&&(g*=u)&&(e.weight=1);e.opacity=g;c["stroke-linejoin"]&&(e.joinstyle=c["stroke-linejoin"]||"miter");e.miterlimit=c["stroke-miterlimit"]||8;c["stroke-linecap"]&&(e.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]==
"square"?"square":"round");if(c["stroke-dasharray"]){g={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};e.dashstyle=g[C](c["stroke-dasharray"])?g[c["stroke-dasharray"]]:""}n&&d.appendChild(e)}if(a.type=="text"){g=a.paper.span.style;f.font&&(g.font=f.font);f["font-family"]&&(g.fontFamily=f["font-family"]);f["font-size"]&&(g.fontSize=f["font-size"]);f["font-weight"]&&(g.fontWeight=
f["font-weight"]);f["font-style"]&&(g.fontStyle=f["font-style"]);a.node.string&&(a.paper.span.innerHTML=k(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=f.w=a.paper.span.offsetWidth;a.H=f.h=a.paper.span.offsetHeight;a.X=f.x;a.Y=f.y+ca(a.H/2);switch(f["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=ca(a.W/2);break;case "end":a.node.style["v-text-align"]="right";a.bbx=-ca(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Ba=function(a,
c){a.attrs=a.attrs||{};var d,f="linear",g=".5 .5";a.attrs.gradient=c;c=k(c).replace(Za,function(J,M,N){f="radial";if(M&&N){M=$(M);N=$(N);q(M-0.5,2)+q(N-0.5,2)>0.25&&(N=D.sqrt(0.25-q(M-0.5,2))*((N>0.5)*2-1)+0.5);g=M+Y+N}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var e=c.shift();e=-$(e);if(isNaN(e))return null}var n=cb(c);if(!n)return null;a=a.shape||a.node;d=a.getElementsByTagName("fill")[0]||qa("fill");!d.parentNode&&a.appendChild(d);if(n[o]){d.on=true;d.method="none";d.color=n[0].color;d.color2=
n[n[o]-1].color;for(var u=[],v=0,x=n[o];v<x;v++)n[v].offset&&u[ba](n[v].offset+Y+n[v].color);d.colors&&(d.colors.value=u[o]?u[w]():"0% "+d.color);if(f=="radial"){d.type="gradientradial";d.focus="100%";d.focussize=g;d.focusposition=g}else{d.type="gradient";d.angle=(270-e)%360}}return 1};ja=function(a,c,d){this[0]=a;this.id=s._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&
(d.top.next=this);d.top=this;this.next=null};ia=ja[z];ia.rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][w](Y);return this._.rt.deg}a=k(a).split(K);if(a[o]-1){c=$(a[1]);d=$(a[2])}a=$(a[0]);c!=null?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;this.setBox(this.attrs,c,d);this.Group.style.rotation=this._.rt.deg;return this};ia.setBox=function(a,c,d){if(this.removed)return this;var f=this.Group.style,
g=this.shape&&this.shape.style||this.node.style;a=a||{};for(var e in a)a[C](e)&&(this.attrs[e]=a[e]);c=c||this._.rt.cx;d=d||this._.rt.cy;var n=this.attrs,u;switch(this.type){case "circle":a=n.cx-n.r;e=n.cy-n.r;u=n=n.r*2;break;case "ellipse":a=n.cx-n.rx;e=n.cy-n.ry;u=n.rx*2;n=n.ry*2;break;case "image":a=+n.x;e=+n.y;u=n.width||0;n=n.height||0;break;case "text":this.textpath.v=["m",ca(n.x),", ",ca(n.y-2),"l",ca(n.x)+1,", ",ca(n.y-2)][w]("");a=n.x-ca(this.W/2);e=n.y-this.H/2;u=this.W;n=this.H;break;case "rect":case "path":if(this.attrs.path){n=
Ia(this.attrs.path);a=n.x;e=n.y;u=n.width;n=n.height}else{e=a=0;u=this.paper.width;n=this.paper.height}break;default:e=a=0;u=this.paper.width;n=this.paper.height}c=(c==null?a+u/2:c)-this.paper.width/2;d=(d==null?e+n/2:d)-this.paper.height/2;var v;f.left!=(v=c+"px")&&(f.left=v);f.top!=(v=d+"px")&&(f.top=v);this.X=Da[C](this.type)?-c:a;this.Y=Da[C](this.type)?-d:e;this.W=u;this.H=n;if(Da[C](this.type)){g.left!=(v=-c*10+"px")&&(g.left=v);g.top!=(v=-d*10+"px")&&(g.top=v)}else if(this.type=="text"){g.left!=
(v=-c+"px")&&(g.left=v);g.top!=(v=-d+"px")&&(g.top=v)}else{f.width!=(v=this.paper.width+"px")&&(f.width=v);f.height!=(v=this.paper.height+"px")&&(f.height=v);g.left!=(v=a-c+"px")&&(g.left=v);g.top!=(v=e-d+"px")&&(g.top=v);g.width!=(v=u+"px")&&(g.width=v);g.height!=(v=n+"px")&&(g.height=v)}};ia.hide=function(){!this.removed&&(this.Group.style.display="none");return this};ia.show=function(){!this.removed&&(this.Group.style.display="block");return this};ia.getBBox=function(){if(this.removed)return this;
if(Da[C](this.type))return Ia(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};ia.remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=true}};ia.attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[C](f)&&(d[f]=this.attrs[f]);
this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&s.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(this.attrs&&c==null&&s.is(a,O)){var g={};f=0;for(d=a[o];f<d;f++)g[a[f]]=this.attr(a[f]);
return g}if(c!=null){d={};d[a]=c}c==null&&s.is(a,"object")&&(d=a);if(d){for(g in this.paper.customAttributes)if(this.paper.customAttributes[C](g)&&d[C](g)&&s.is(this.paper.customAttributes[g],"function")){f=this.paper.customAttributes[g].apply(this,[].concat(d[g]));this.attrs[g]=d[g];for(var e in f)f[C](e)&&(d[e]=f[e])}d.text&&this.type=="text"&&(this.node.string=d.text);xa(this,d);d.gradient&&({circle:1,ellipse:1}[C](this.type)||k(d.gradient).charAt()!="r")&&Ba(this,d.gradient);(!Da[C](this.type)||
this._.rt.deg)&&this.setBox(this.attrs)}return this};ia.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&eb(this,this.paper);return this};ia.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);fb(this,this.paper)}return this};ia.insertAfter=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[a.length-1]);a.Group.nextSibling?
a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);gb(this,a,this.paper);return this};ia.insertBefore=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);hb(this,a,this.paper);return this};ia.blur=function(a){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(Fb,"");if(+a!==0){this.attrs.blur=a;c.filter=d+Y+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";
c.margin=s.format("-{0}px 0 0 -{0}px",ca(+a||1.5))}else{c.filter=d;c.margin=0;delete this.attrs.blur}};kb=function(a,c,d,f){var g=qa("group"),e=qa("oval");g.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";g.coordsize=Ca;g.coordorigin=a.coordorigin;g.appendChild(e);e=new ja(e,g,a);e.type="circle";xa(e,{stroke:"#000",fill:"none"});e.attrs.cx=c;e.attrs.cy=d;e.attrs.r=f;e.setBox({x:c-f,y:d-f,width:f*2,height:f*2});a.canvas.appendChild(g);return e};var rb=function(a,
c,d,f,g){return g?s.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+g,c,d-g*2,g,-g,f-g*2,g*2-d,g*2-f):s.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,f,-d)};lb=function(a,c,d,f,g,e){var n=rb(c,d,f,g,e);a=a.path(n);var u=a.attrs;a.X=u.x=c;a.Y=u.y=d;a.W=u.width=f;a.H=u.height=g;u.r=e;u.path=n;a.type="rect";return a};mb=function(a,c,d,f,g){var e=qa("group"),n=qa("oval");e.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";e.coordsize=Ca;e.coordorigin=a.coordorigin;e.appendChild(n);n=new ja(n,e,a);n.type="ellipse";xa(n,{stroke:"#000"});n.attrs.cx=c;n.attrs.cy=d;n.attrs.rx=f;n.attrs.ry=g;n.setBox({x:c-f,y:d-g,width:f*2,height:g*2});a.canvas.appendChild(e);return n};nb=function(a,c,d,f,g,e){var n=qa("group"),u=qa("image");n.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";n.coordsize=Ca;n.coordorigin=a.coordorigin;u.src=c;n.appendChild(u);u=new ja(u,
n,a);u.type="image";u.attrs.src=c;u.attrs.x=d;u.attrs.y=f;u.attrs.w=g;u.attrs.h=e;u.setBox({x:d,y:f,width:g,height:e});a.canvas.appendChild(n);return u};ob=function(a,c,d,f){var g=qa("group"),e=qa("shape"),n=e.style,u=qa("path"),v=qa("textpath");g.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";g.coordsize=Ca;g.coordorigin=a.coordorigin;u.v=s.format("m{0},{1}l{2},{1}",ca(c*10),ca(d*10),ca(c*10)+1);u.textpathok=true;n.width=a.width;n.height=a.height;v.string=
k(f);v.on=true;e.appendChild(v);e.appendChild(u);g.appendChild(e);n=new ja(v,g,a);n.shape=e;n.textpath=u;n.type="text";n.attrs.text=f;n.attrs.x=c;n.attrs.y=d;n.attrs.w=1;n.attrs.h=1;xa(n,{font:Ea.font,stroke:"none",fill:"#000"});n.setBox();a.canvas.appendChild(g);return n};pb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this};var qa;i.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!i.namespaces.rvml&&
i.namespaces.add("rvml","urn:schemas-microsoft-com:vml");qa=function(a){return i.createElement("<rvml:"+a+' class="rvml">')}}catch(Ob){qa=function(a){return i.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Na=function(){var a=db[R](0,arguments),c=a.container,d=a.height,f=a.width,g=a.x;a=a.y;if(!c)throw Error("VML container not found.");var e=new G,n=e.canvas=i.createElement("div"),u=n.style;g=g||0;a=a||0;f=f||512;d=d||342;f==+f&&(f+="px");d==+d&&(d+="px");e.width=1E3;
e.height=1E3;e.coordsize=1E4+Y+1E4;e.coordorigin="0 0";e.span=i.createElement("span");e.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";n.appendChild(e.span);u.cssText=s.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d);if(c==1){i.body.appendChild(n);u.left=g+"px";u.top=a+"px";u.position="absolute"}else c.firstChild?c.insertBefore(n,c.firstChild):c.appendChild(n);
Ra.call(e,e,s.fn);return e};F.clear=function(){this.canvas.innerHTML="";this.span=i.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};F.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a);return true}}ta=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(ta&&ta[1]<
4||navigator.platform.slice(0,2)=="iP")?F.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});p.setTimeout(function(){a.remove()})}:F.safari=function(){};var Ib=function(){this.returnValue=false},Jb=function(){return this.originalEvent.preventDefault()},Kb=function(){this.cancelBubble=true},Lb=function(){return this.originalEvent.stopPropagation()},Mb=function(){if(i.addEventListener)return function(a,c,d,f){var g=W&&H[c]?H[c]:c,e=function(n){if(W&&H[C](c))for(var u=
0,v=n.targetTouches&&n.targetTouches.length;u<v;u++)if(n.targetTouches[u].target==a){v=n;n=n.targetTouches[u];n.originalEvent=v;n.preventDefault=Jb;n.stopPropagation=Lb;break}return d.call(f,n)};a.addEventListener(g,e,false);return function(){a.removeEventListener(g,e,false);return true}};if(i.attachEvent)return function(a,c,d,f){var g=function(e){e=e||p.event;e.preventDefault=e.preventDefault||Ib;e.stopPropagation=e.stopPropagation||Kb;return d.call(f,e)};a.attachEvent("on"+c,g);return function(){a.detachEvent("on"+
c,g);return true}}}(),ua=[],Ta=function(a){for(var c=a.clientX,d=a.clientY,f=i.documentElement.scrollTop||i.body.scrollTop,g=i.documentElement.scrollLeft||i.body.scrollLeft,e,n=ua.length;n--;){e=ua[n];if(W)for(var u=a.touches.length,v;u--;){v=a.touches[u];if(v.identifier==e.el._drag.id){c=v.clientX;d=v.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=g;d+=f;e.move&&e.move.call(e.move_scope||e.el,c-e.el._drag.x,d-e.el._drag.y,c,d,a)}},Ua=function(a){s.unmousemove(Ta).unmouseup(Ua);
for(var c=ua.length,d;c--;){d=ua[c];d.el._drag={};d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a)}ua=[]};for(ta=j[o];ta--;)(function(a){s[a]=ja[z][a]=function(c,d){if(s.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:Mb(this.shape||this.node||i,a,c,d||this)})}return this};s["un"+a]=ja[z]["un"+a]=function(c){for(var d=this.events,f=d[o];f--;)if(d[f].name==a&&d[f].f==c){d[f].unbind();d.splice(f,1);!d.length&&delete this.events;break}return this}})(j[ta]);
ia.hover=function(a,c,d,f){return this.mouseover(a,d).mouseout(c,f||d)};ia.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};ia.drag=function(a,c,d,f,g,e){this._drag={};this.mousedown(function(n){(n.originalEvent||n).preventDefault();var u=i.documentElement.scrollTop||i.body.scrollTop,v=i.documentElement.scrollLeft||i.body.scrollLeft;this._drag.x=n.clientX+v;this._drag.y=n.clientY+u;this._drag.id=n.identifier;c&&c.call(g||f||this,n.clientX+v,n.clientY+u,n);!ua.length&&s.mousemove(Ta).mouseup(Ua);
ua.push({el:this,move:a,end:d,move_scope:f,start_scope:g,end_scope:e})});return this};ia.undrag=function(a,c,d){for(c=ua.length;c--;)ua[c].el==this&&ua[c].move==a&&ua[c].end==d&&ua.splice(c++,1);!ua.length&&s.unmousemove(Ta).unmouseup(Ua)};F.circle=function(a,c,d){return kb(this,a||0,c||0,d||0)};F.rect=function(a,c,d,f,g){return lb(this,a||0,c||0,d||0,f||0,g||0)};F.ellipse=function(a,c,d,f){return mb(this,a||0,c||0,d||0,f||0)};F.path=function(a){a&&!s.is(a,"string")&&!s.is(a[0],O)&&(a+="");return jb(s.format[R](s,
arguments),this)};F.image=function(a,c,d,f,g){return nb(this,a||"about:blank",c||0,d||0,f||0,g||0)};F.text=function(a,c,d){return ob(this,a||0,c||0,k(d))};F.set=function(a){arguments[o]>1&&(a=Array[z].splice.call(arguments,0,arguments[o]));return new sa(a)};F.setSize=pb;F.top=F.bottom=null;F.raphael=s;ia.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};ia.scale=function(a,c,d,f){if(this.removed)return this;if(a==null&&c==null)return{x:this._.sx,y:this._.sy,
toString:B};c=c||a;!+c&&(c=a);var g,e,n=this.attrs;if(a!=0){var u=this.getBBox(),v=u.x+u.width/2,x=u.y+u.height/2;g=h(a/this._.sx);e=h(c/this._.sy);d=+d||d==0?d:v;f=+f||f==0?f:x;var J=this._.sx>0,M=this._.sy>0;u=~~(a/h(a));var N=~~(c/h(c)),U=g*u,ea=e*N,V=this.node.style;v=d+h(v-d)*U*(v>d==J?1:-1);x=f+h(x-f)*ea*(x>f==M?1:-1);var S=a*u>c*N?e:g;switch(this.type){case "rect":case "image":var aa=n.width*g,ka=n.height*e;this.attr({height:ka,r:n.r*S,width:aa,x:v-aa/2,y:x-ka/2});break;case "circle":case "ellipse":this.attr({rx:n.rx*
g,ry:n.ry*e,r:n.r*S,cx:v,cy:x});break;case "text":this.attr({x:v,y:x});break;case "path":S=Qa(n.path);var oa=true;J=J?U:g;M=M?ea:e;ea=0;for(U=S[o];ea<U;ea++){var pa=S[ea],ma=wa.call(pa[0]);if(!(ma=="M"&&oa)){oa=false;if(ma=="A"){pa[S[ea][o]-2]*=J;pa[S[ea][o]-1]*=M;pa[1]*=g;pa[2]*=e;pa[5]=+(u+N?!!+pa[5]:!+pa[5])}else if(ma=="H"){ma=1;for(var ya=pa[o];ma<ya;ma++)pa[ma]*=J}else if(ma=="V"){ma=1;for(ya=pa[o];ma<ya;ma++)pa[ma]*=M}else{ma=1;for(ya=pa[o];ma<ya;ma++)pa[ma]*=ma%2?J:M}}}e=Ia(S);g=v-e.x-e.width/
2;e=x-e.y-e.height/2;S[0][1]+=g;S[0][2]+=e;this.attr({path:S})}if(this.type in{text:1,image:1}&&(u!=1||N!=1))if(this.transformations){this.transformations[2]="scale(".concat(u,",",N,")");this.node.setAttribute("transform",this.transformations[w](Y));g=u==-1?-n.x-(aa||0):n.x;e=N==-1?-n.y-(ka||0):n.y;this.attr({x:g,y:e});n.fx=u-1;n.fy=N-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(u,", M12=0, M21=0, M22=",N,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");
V.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[w](Y));n.fx=0;n.fy=0}else{this.node.filterMatrix="";V.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}n.scale=[a,c,d,f][w](Y);this._.sx=a;this._.sy=c}return this};ia.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};
var Va={},La=function(a,c,d,f,g,e,n,u,v){var x=0,J=100,M=[a,c,d,f,g,e,n,u].join(),N=Va[M],U,ea;!N&&(Va[M]=N={data:[]});N.timer&&clearTimeout(N.timer);N.timer=setTimeout(function(){delete Va[M]},2E3);if(v!=null)J=~~La(a,c,d,f,g,e,n,u)*10;for(var V=0;V<J+1;V++){if(N.data[v]>V)ea=N.data[V*J];else{ea=s.findDotsAtSegment(a,c,d,f,g,e,n,u,V/J);N.data[V]=ea}V&&(x+=q(q(U.x-ea.x,2)+q(U.y-ea.y,2),0.5));if(v!=null&&x>=v)return ea;U=ea}if(v==null)return x};j=function(a,c){return function(d,f,g){d=Ha(d);for(var e,
n,u,v,x="",J={},M=0,N=0,U=d.length;N<U;N++){u=d[N];if(u[0]=="M"){e=+u[1];n=+u[2]}else{v=La(e,n,u[1],u[2],u[3],u[4],u[5],u[6]);if(M+v>f){if(c&&!J.start){e=La(e,n,u[1],u[2],u[3],u[4],u[5],u[6],f-M);x+=["C",e.start.x,e.start.y,e.m.x,e.m.y,e.x,e.y];if(g)return x;J.start=x;x=["M",e.x,e.y+"C",e.n.x,e.n.y,e.end.x,e.end.y,u[5],u[6]][w]();M+=v;e=+u[5];n=+u[6];continue}if(!a&&!c){e=La(e,n,u[1],u[2],u[3],u[4],u[5],u[6],f-M);return{x:e.x,y:e.y,alpha:e.alpha}}}M+=v;e=+u[5];n=+u[6]}x+=u}J.end=x;e=a?M:c?J:s.findDotsAtSegment(e,
n,u[1],u[2],u[3],u[4],u[5],u[6],1);e.alpha&&(e={x:e.x,y:e.y,alpha:e.alpha});return e}};var sb=j(1),Ma=j(),Wa=j(0,1);ia.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return sb(this.attrs.path)}};ia.getPointAtLength=function(a){if(this.type=="path")return Ma(this.attrs.path,a)};ia.getSubpath=function(a,c){if(this.type=="path"){if(h(this.getTotalLength()-c)<"1e-6")return Wa(this.attrs.path,a).end;var d=Wa(this.attrs.path,c,1);return a?Wa(d,
a).end:d}};s.easing_formulas={linear:function(a){return a},"<":function(a){return q(a,3)},">":function(a){return q(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return q(a,3)/2;a-=2;return(q(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||a==1)return a;return q(2,-10*a)*D.sin((a-0.075)*2*A/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/2.75){a-=
2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var va=[],tb=function(){for(var a=+new Date,c=0;c<va[o];c++){var d=va[c];if(!(d.stop||d.el.removed)){var f=a-d.start,g=d.ms,e=d.easing,n=d.from,u=d.diff,v=d.to,x=d.t,J=d.el;d={};var M;if(f<g){f=e(f/g);for(var N in n)if(n[C](N)){switch(Oa[N]){case "along":M=f*g*u[N];v.back&&(M=v.len-M);e=Ma(v[N],M);J.translate(u.sx-u.x||0,u.sy-u.y||0);u.x=e.x;u.y=e.y;J.translate(e.x-u.sx,e.y-u.sy);v.rot&&J.rotate(u.r+e.alpha,e.x,e.y);
break;case I:M=+n[N]+f*g*u[N];break;case "colour":M="rgb("+[Xa(ca(n[N].r+f*g*u[N].r)),Xa(ca(n[N].g+f*g*u[N].g)),Xa(ca(n[N].b+f*g*u[N].b))][w](",")+")";break;case "path":M=[];e=0;for(var U=n[N][o];e<U;e++){M[e]=[n[N][e][0]];for(var ea=1,V=n[N][e][o];ea<V;ea++)M[e][ea]=+n[N][e][ea]+f*g*u[N][e][ea];M[e]=M[e][w](Y)}M=M[w](Y);break;case "csv":switch(N){case "translation":M=f*g*u[N][0]-x.x;e=f*g*u[N][1]-x.y;x.x+=M;x.y+=e;M=M+Y+e;break;case "rotation":M=+n[N][0]+f*g*u[N][0];n[N][1]&&(M+=","+n[N][1]+","+
n[N][2]);break;case "scale":M=[+n[N][0]+f*g*u[N][0],+n[N][1]+f*g*u[N][1],2 in v[N]?v[N][2]:"",3 in v[N]?v[N][3]:""][w](Y);break;case "clip-rect":M=[];for(e=4;e--;)M[e]=+n[N][e]+f*g*u[N][e]}break;default:U=[].concat(n[N]);M=[];for(e=J.paper.customAttributes[N].length;e--;)M[e]=+U[e]+f*g*u[N][e]}d[N]=M}J.attr(d);J._run&&J._run.call(J)}else{if(v.along){e=Ma(v.along,v.len*!v.back);J.translate(u.sx-(u.x||0)+e.x-u.sx,u.sy-(u.y||0)+e.y-u.sy);v.rot&&J.rotate(u.r+e.alpha,e.x,e.y)}(x.x||x.y)&&J.translate(-x.x,
-x.y);v.scale&&(v.scale+="");J.attr(v);va.splice(c--,1)}}}s.svg&&J&&J.paper&&J.paper.safari();va[o]&&setTimeout(tb)},Nb=function(a,c,d,f,g){var e=d-f;c.timeouts.push(setTimeout(function(){s.is(g,"function")&&g.call(c);c.animate(a,e,a.easing)},f))},Xa=function(a){return E(P(a,255),0)},Ka=function(a,c){if(a==null)return{x:this._.tx,y:this._.ty,toString:B};this._.tx+=+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+
this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Qa(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};ia.animateWith=function(a,c,d,f,g){for(var e=0,n=va.length;e<n;e++)va[e].el.id==a.id&&(c.start=va[e].start);return this.animate(c,d,f,g)};ia.animateAlong=T();ia.animateAlongBack=T(1);ia.onAnimation=function(a){this._run=a||0;return this};ia.animate=function(a,c,d,f){var g=this;g.timeouts=g.timeouts||[];if(s.is(d,"function")||!d)f=d||null;if(g.removed){f&&f.call(g);
return g}var e={},n={},u=false,v={},x;for(x in a)if(a[C](x))if(Oa[C](x)||g.paper.customAttributes[C](x)){u=true;e[x]=g.attr(x);e[x]==null&&(e[x]=Ea[x]);n[x]=a[x];switch(Oa[x]){case "along":var J=sb(a[x]),M=Ma(a[x],J*!!a.back),N=g.getBBox();v[x]=J/c;v.tx=N.x;v.ty=N.y;v.sx=M.x;v.sy=M.y;n.rot=a.rot;n.back=a.back;n.len=J;a.rot&&(v.r=$(g.rotate())||0);break;case I:v[x]=(n[x]-e[x])/c;break;case "colour":e[x]=s.getRGB(e[x]);J=s.getRGB(n[x]);v[x]={r:(J.r-e[x].r)/c,g:(J.g-e[x].g)/c,b:(J.b-e[x].b)/c};break;
case "path":J=Ha(e[x],n[x]);e[x]=J[0];N=J[1];v[x]=[];J=0;for(M=e[x][o];J<M;J++){v[x][J]=[0];for(var U=1,ea=e[x][J][o];U<ea;U++)v[x][J][U]=(N[J][U]-e[x][J][U])/c}break;case "csv":M=k(a[x]).split(K);N=k(e[x]).split(K);switch(x){case "translation":e[x]=[0,0];v[x]=[M[0]/c,M[1]/c];break;case "rotation":e[x]=N[1]==M[1]&&N[2]==M[2]?N:[0,M[1],M[2]];v[x]=[(M[0]-e[x][0])/c,0,0];break;case "scale":a[x]=M;e[x]=k(e[x]).split(K);v[x]=[(M[0]-e[x][0])/c,(M[1]-e[x][1])/c,0,0];break;case "clip-rect":e[x]=k(e[x]).split(K);
v[x]=[];for(J=4;J--;)v[x][J]=(M[J]-e[x][J])/c}n[x]=M;break;default:M=[].concat(a[x]);N=[].concat(e[x]);v[x]=[];for(J=g.paper.customAttributes[x][o];J--;)v[x][J]=((M[J]||0)-(N[J]||0))/c}}if(u){x=s.easing_formulas[d];if(!x)if((x=k(d).match(ra))&&x[o]==5){var V=x;x=function(ka){return m(ka,+V[1],+V[2],+V[3],+V[4],c)}}else x=function(ka){return ka};va.push({start:a.start||+new Date,ms:c,easing:x,from:e,diff:v,to:n,el:g,t:{x:0,y:0}});s.is(f,"function")&&(g._ac=setTimeout(function(){f.call(g)},c));va[o]==
1&&setTimeout(tb)}else{d=[];var S,aa;for(aa in a)if(a[C](aa)&&ub.test(aa)){x={value:a[aa]};aa=="from"&&(aa=0);aa=="to"&&(aa=100);x.key=na(aa,10);d.push(x)}d.sort(zb);d[0].key&&d.unshift({key:0,value:g.attrs});J=0;for(M=d[o];J<M;J++)Nb(d[J].value,g,c/100*d[J].key,c/100*(d[J-1]&&d[J-1].key||0),d[J-1]&&d[J-1].value.callback);(S=d[d[o]-1].value.callback)&&g.timeouts.push(setTimeout(function(){S.call(g)},c))}return this};ia.stop=function(){for(var a=0;a<va.length;a++)va[a].el.id==this.id&&va.splice(a--,
1);a=0;for(ii=this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};ia.translate=function(a,c){return this.attr({translation:a+" "+c})};ia[X]=function(){return"Rapha\u00ebl\u2019s object"};s.ae=va;var sa=function(a){this.items=[];this[o]=0;this.type="set";if(a)for(var c=0,d=a[o];c<d;c++)if(a[c]&&(a[c].constructor==ja||a[c].constructor==sa)){this[this.items[o]]=this.items[this.items[o]]=a[c];this[o]++}};sa[z][ba]=
function(){for(var a,c,d=0,f=arguments[o];d<f;d++)if((a=arguments[d])&&(a.constructor==ja||a.constructor==sa)){c=this.items[o];this[c]=this.items[c]=a;this[o]++}return this};sa[z].pop=function(){delete this[this[o]--];return this.items.pop()};for(var Ya in ia)ia[C](Ya)&&(sa[z][Ya]=function(a){return function(){for(var c=0,d=this.items[o];c<d;c++)this.items[c][a][R](this.items[c],arguments);return this}}(Ya));sa[z].attr=function(a,c){if(a&&s.is(a,O)&&s.is(a[0],"object"))for(var d=0,f=a[o];d<f;d++)this.items[d].attr(a[d]);
else{d=0;for(f=this.items[o];d<f;d++)this.items[d].attr(a,c)}return this};sa[z].animate=function(a,c,d,f){(s.is(d,"function")||!d)&&(f=d||null);var g=this.items[o],e=g,n,u=this,v;f&&(v=function(){!--g&&f.call(u)});d=s.is(d,"string")?d:v;for(n=this.items[--e].animate(a,c,d,v);e--;)this.items[e]&&!this.items[e].removed&&this.items[e].animateWith(n,a,c,d,v);return this};sa[z].insertAfter=function(a){for(var c=this.items[o];c--;)this.items[c].insertAfter(a);return this};sa[z].getBBox=function(){for(var a=
[],c=[],d=[],f=[],g=this.items[o];g--;){var e=this.items[g].getBBox();a[ba](e.x);c[ba](e.y);d[ba](e.x+e.width);f[ba](e.y+e.height)}a=P[R](0,a);c=P[R](0,c);return{x:a,y:c,width:E[R](0,d)-a,height:E[R](0,f)-c}};sa[z].clone=function(a){a=new sa;for(var c=0,d=this.items[o];c<d;c++)a[ba](this.items[c].clone());return a};s.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],f;for(f in a.face)a.face[C](f)&&(c.face[f]=a.face[f]);this.fonts[d]?
this.fonts[d][ba](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=na(a.face["units-per-em"],10);for(var g in a.glyphs)if(a.glyphs[C](g)){d=a.glyphs[g];c.glyphs[g]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(n){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[n]||"M"})+"z"};if(d.k)for(var e in d.k)d[C](e)&&(c.glyphs[g].k[e]=d.k[e])}}return a};F.getFont=function(a,c,d,f){f=f||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(s.fonts){var g=s.fonts[a];
if(!g){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var e in s.fonts)if(s.fonts[C](e))if(a.test(e)){g=s.fonts[e];break}}var n;if(g){e=0;for(a=g[o];e<a;e++){n=g[e];if(n.face["font-weight"]==c&&(n.face["font-style"]==d||!n.face["font-style"])&&n.face["font-stretch"]==f)break}}return n}};F.print=function(a,c,d,f,g,e,n){e=e||"middle";n=E(P(n||0,1),-1);var u=this.set(),v=k(d).split(""),x=0;s.is(f,d)&&(f=this.getFont(f));if(f){d=(g||16)/f.face["units-per-em"];var J=f.face.bbox.split(K);
g=+J[0];e=+J[1]+(e=="baseline"?J[3]-J[1]+ +f.face.descent:(J[3]-J[1])/2);J=0;for(var M=v[o];J<M;J++){var N=J&&f.glyphs[v[J-1]]||{},U=f.glyphs[v[J]];x+=J?(N.w||f.w)+(N.k&&N.k[v[J]]||0)+f.w*n:0;U&&U.d&&u[ba](this.path(U.d).attr({fill:"#000",stroke:"none",translation:[x,0]}))}u.scale(d,d,g,e).translate(a-g,c-e)}return u};s.format=function(a,c){var d=s.is(c,O)?[0].concat(c):arguments;a&&s.is(a,"string")&&d[o]-1&&(a=a.replace(l,function(f,g){return d[++g]==null?"":d[g]}));return a||""};s.ninja=function(){r.was?
p.Raphael=r.is:delete Raphael;return s};s.el=ia;s.st=sa[z];r.was?p.Raphael=s:Raphael=s})();(function(){function s(w){return(w+"").replace(W,"")}function Z(w,o,y){for(var D=w.length;D<o;D++)w=y?"0"+w:w+"0";return w}function Q(w){return H.call(w)==="[object Array]"}function B(w,o){if(w.indexOf)return w.indexOf(o);for(var y=0,D=w.length;y<D;y++)if(w[y]===o)return y;return-1}function T(w,o,y){var D=o["-"];o=o["+"];var E;switch(y){case "n -":D=" "+D;o=" "+o;case "n-":if(w.substr(w.length-D.length)===D)E=["-",w.substr(0,w.length-D.length)];else if(w.substr(w.length-o.length)===o)E=["+",w.substr(0,
w.length-o.length)];break;case "- n":D+=" ";o+=" ";case "-n":if(w.indexOf(D)===0)E=["-",w.substr(D.length)];else if(w.indexOf(o)===0)E=["+",w.substr(o.length)];break;case "(n)":if(w.indexOf("(")===0&&w.substr(w.length-1)===")")E=["-",w.substr(1,w.length-2)]}return E||["",w]}function m(w,o){if(!o)return 0;for(var y,D=w.getTime(),E=0,P=o.length;E<P;E++){y=o[E].start;if(y===null||D>=y)return E}return 0}function K(w){return w.split("\u00a0").join(" ").toUpperCase()}function L(w){for(var o=[],y=0,D=w.length;y<
D;y++)o[y]=K(w[y]);return o}function l(w,o,y,D){w=w.getFullYear();if(!D&&o.eras)w-=o.eras[y].offset;return w}function z(w,o){for(var y=0,D=false,E=0,P=w.length;E<P;E++){var h=w.charAt(E);switch(h){case "'":if(D)o.push("'");else y++;D=false;break;case "\\":D&&o.push("\\");D=!D;break;default:o.push(h);D=false}}return y}function C(w,o){o=o||"F";var y;y=w.patterns;var D=o.length;if(D===1){y=y[o];if(!y)throw"Invalid date format string '"+o+"'.";o=y}else if(D===2&&o.charAt(0)==="%")o=o.charAt(1);return o}
function i(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function p(w,o,y){w=s(w);y=y.calendar;a:{var D=y._parseRegExp;if(D){var E=D[o];if(E){o=E;break a}}else y._parseRegExp=D={};E=C(y,o).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var P=["^"],h=[],q=0,A=0,I=i(),O;(O=I.exec(E))!==null;){var X=E.slice(q,O.index);q=I.lastIndex;A+=z(X,P);if(A%2)P.push(O[0]);else{X=O[0];var ga=X.length;switch(X){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":X=
"(\\D+)";break;case "tt":case "t":X="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":X="(\\d{"+ga+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":X="(\\d\\d?)";break;case "zzz":X="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":X="([+-]?\\d\\d?)";break;case "/":X="(\\"+y["/"]+")";break;default:throw"Invalid date format pattern '"+X+"'.";}X&&P.push(X);h.push(O[0])}}z(E.slice(q),P);P.push("$");E=
{regExp:P.join("").replace(/\s+/g,"\\s+"),groups:h};o=D[o]=E}A=RegExp(o.regExp).exec(w);if(A===null)return null;I=o.groups;var ba=w=null,fa=null,la=o=null;h=P=E=D=0;O=null;q=false;X=0;for(ga=I.length;X<ga;X++){var ha=A[X+1];if(ha){var ra=I[X],ca=ra.length,$=parseInt(ha,10);switch(ra){case "dd":case "d":o=$;if(o<1||o>31)return null;break;case "MMM":case "MMMM":fa=y;ca=ca===3;ra=fa.months;var na=fa.monthsGenitive||fa.months,wa=fa._upperMonths;$=fa._upperMonthsGen;if(!wa){fa._upperMonths=wa=[L(ra.names),
L(ra.namesAbbr)];fa._upperMonthsGen=$=[L(na.names),L(na.namesAbbr)]}ha=K(ha);fa=B(ca?wa[1]:wa[0],ha);if(fa<0)fa=B(ca?$[1]:$[0],ha);if(fa<0||fa>11)return null;break;case "M":case "MM":fa=$-1;if(fa<0||fa>11)return null;break;case "y":case "yy":case "yyyy":if(ca<4){ba=y;ha=$;$=new Date;ra=m($);if(ha<100){ca=ba.twoDigitYearMax;ca=typeof ca==="string"?(new Date).getFullYear()%100+parseInt(ca,10):ca;ba=l($,ba,ra);ha+=ba-ba%100;if(ha>ca)ha-=100}ba=ha}else ba=$;if(ba<0||ba>9999)return null;break;case "h":case "hh":D=
$;if(D===12)D=0;if(D<0||D>11)return null;break;case "H":case "HH":D=$;if(D<0||D>23)return null;break;case "m":case "mm":E=$;if(E<0||E>59)return null;break;case "s":case "ss":P=$;if(P<0||P>59)return null;break;case "tt":case "t":q=y.PM&&(ha===y.PM[0]||ha===y.PM[1]||ha===y.PM[2]);if(!q&&(!y.AM||ha!==y.AM[0]&&ha!==y.AM[1]&&ha!==y.AM[2]))return null;break;case "f":case "ff":case "fff":h=$*Math.pow(10,3-ca);if(h<0||h>999)return null;break;case "ddd":case "dddd":la=ha;ha=ca===3;$=void 0;$=y.days;ca=y._upperDays;
if(!ca)y._upperDays=ca=[L($.names),L($.namesAbbr),L($.namesShort)];la=K(la);if(ha){$=B(ca[1],la);if($===-1)$=B(ca[2],la)}else $=B(ca[0],la);la=$;if(la<0||la>6)return null;break;case "zzz":ca=ha.split(/:/);if(ca.length!==2)return null;O=parseInt(ca[0],10);if(O<-12||O>13)return null;ca=parseInt(ca[1],10);if(ca<0||ca>59)return null;O=O*60+(ha.indexOf("-")===0?-ca:ca);break;case "z":case "zz":O=$;if(O<-12||O>13)return null;O*=60;break;case "g":case "gg":if(!ha||!y.eras)return null;ha=s(ha.toLowerCase());
ca=0;for($=y.eras.length;ca<$;ca++)if(ha===y.eras[ca].name.toLowerCase()){w=ca;break}if(w===null)return null}}}A=new Date;I=(X=y.convert)?X.fromGregorian(A)[0]:A.getFullYear();if(ba===null)ba=I;else if(y.eras)ba+=y.eras[w||0].offset;if(fa===null)fa=0;if(o===null)o=1;if(X){A=X.toGregorian(ba,fa,o);if(A===null)return null}else{A.setFullYear(ba,fa,o);if(A.getDate()!==o)return null;if(la!==null&&A.getDay()!==la)return null}if(q&&D<12)D+=12;A.setHours(D,E,P,h);if(O!==null){y=A.getMinutes()-(O+A.getTimezoneOffset());
A.setHours(A.getHours()+parseInt(y/60,10),y%60)}return A}function r(w,o,y){function D(ca,$){var na;na=ca+"";if($>1&&na.length<$){na=X[$-2]+na;return na.substr(na.length-$,$)}return na}function E(){if(ga||ba)return ga;ga=fa.test(o);ba=true;return ga}function P(ca,$){if(ra)return ra[$];switch($){case 0:return ca.getFullYear();case 1:return ca.getMonth();case 2:return ca.getDate()}}var h=y.calendar,q=h.convert;if(!o||!o.length||o==="i"){if(y&&y.name.length)if(q)y=r(w,h.patterns.F,y);else{y=new Date(w.getTime());
var A=m(w,h.eras);y.setFullYear(l(w,h,A));y=y.toLocaleString()}else y=w.toString();return y}A=h.eras;var I=o==="s";o=C(h,o);y=[];var O,X=["0","00","000"],ga,ba,fa=/([^d]|^)(d|dd)([^d]|$)/g,la=0,ha=i(),ra;if(!I&&q)ra=q.fromGregorian(w);for(;;){O=ha.lastIndex;q=ha.exec(o);O=o.slice(O,q?q.index:o.length);la+=z(O,y);if(!q)break;if(la%2)y.push(q[0]);else{O=q[0];q=O.length;switch(O){case "ddd":case "dddd":y.push((q===3?h.days.namesAbbr:h.days.names)[w.getDay()]);break;case "d":case "dd":ga=true;y.push(D(P(w,
2),q));break;case "MMM":case "MMMM":O=P(w,1);y.push(h.monthsGenitive&&E()?h.monthsGenitive[q===3?"namesAbbr":"names"][O]:h.months[q===3?"namesAbbr":"names"][O]);break;case "M":case "MM":y.push(D(P(w,1)+1,q));break;case "y":case "yy":case "yyyy":O=ra?ra[0]:l(w,h,m(w,A),I);if(q<4)O%=100;y.push(D(O,q));break;case "h":case "hh":O=w.getHours()%12;if(O===0)O=12;y.push(D(O,q));break;case "H":case "HH":y.push(D(w.getHours(),q));break;case "m":case "mm":y.push(D(w.getMinutes(),q));break;case "s":case "ss":y.push(D(w.getSeconds(),
q));break;case "t":case "tt":O=w.getHours()<12?h.AM?h.AM[0]:" ":h.PM?h.PM[0]:" ";y.push(q===1?O.charAt(0):O);break;case "f":case "ff":case "fff":y.push(D(w.getMilliseconds(),3).substr(0,q));break;case "z":case "zz":O=w.getTimezoneOffset()/60;y.push((O<=0?"+":"-")+D(Math.floor(Math.abs(O)),q));break;case "zzz":O=w.getTimezoneOffset()/60;y.push((O<=0?"+":"-")+D(Math.floor(Math.abs(O)),2)+":"+D(Math.abs(w.getTimezoneOffset()%60),2));break;case "g":case "gg":h.eras&&y.push(h.eras[m(w,A)].name);break;
case "/":y.push(h["/"]);break;default:throw"Invalid date format pattern '"+O+"'.";}}}return y.join("")}var G={},F={en:{}};F["default"]=F.en;G.extend=function(w){for(var o=arguments[1]||{},y=2,D=arguments.length;y<D;y++){var E=arguments[y];if(E)for(var P in E){var h=E[P];if(typeof h!=="undefined")if(w&&(H.call(h)==="[object Object]"||Q(h))){var q=o[P];q=q&&(H.call(q)==="[object Object]"||Q(q))?q:Q(h)?[]:{};o[P]=this.extend(true,q,h)}else o[P]=h}}return o};G.findClosestCulture=function(w){var o;if(!w)return this.culture||
this.cultures["default"];if(H.call(w)==="[object String]")w=w.split(",");if(Q(w)){var y,D=this.cultures,E=w,P,h=E.length,q=[];for(P=0;P<h;P++){w=s(E[P]);w=w.split(";");y=s(w[0]);if(w.length===1)w=1;else{w=s(w[1]);if(w.indexOf("q=")===0){w=w.substr(2);w=parseFloat(w,10);w=isNaN(w)?0:w}else w=1}q.push({lang:y,pri:w})}q.sort(function(I,O){return I.pri<O.pri?1:-1});for(P=0;P<h;P++){y=q[P].lang;if(o=D[y])return o}for(P=0;P<h;P++){y=q[P].lang;do{E=y.lastIndexOf("-");if(E===-1)break;y=y.substr(0,E);if(o=
D[y])return o}while(1)}for(P=0;P<h;P++){y=q[P].lang;for(var A in D){E=D[A];if(E.language==y)return E}}}else if(typeof w==="object")return w;return o||null};G.preferCulture=function(w){this.culture=this.findClosestCulture(w)||this.cultures["default"]};G.localize=function(w,o,y){if(typeof o!=="string")o=this.culture.name||this.culture||"default";o=this.cultures[o]||{name:o};var D=F[o.name];if(arguments.length===3){D||(D=F[o.name]={});D[w]=y}else{if(D)y=D[w];if(typeof y==="undefined"){if(D=F[o.language])y=
D[w];if(typeof y==="undefined")y=F["default"][w]}}return typeof y==="undefined"?null:y};G.format=function(w,o,y){y=this.findClosestCulture(y);if(typeof w==="number"){var D=w;if(!o||o==="i")w=y.name.length?D.toLocaleString():D.toString();else{o=o||"D";y=y.numberFormat;w=Math.abs(D);var E=-1;if(o.length>1)E=parseInt(o.slice(1),10);var P=o.charAt(0).toUpperCase(),h;switch(P){case "D":o="n";if(E!==-1)w=Z(""+w,E,true);if(D<0)w=-w;break;case "N":h=y;case "C":h=h||y.currency;case "P":h=h||y.percent;o=D<
0?h.pattern[0]:h.pattern[1]||"n";if(E===-1)E=h.decimals;b:{var q=w*(P==="P"?100:1);P=h;h=P.groupSizes;w=h[0];D=1;var A=Math.pow(10,E),I=Math.round(q*A)/A;isFinite(I)||(I=q);A="";A=(I+"").split(/e/i);I=A.length>1?parseInt(A[1],10):0;q=A[0];A=q.split(".");q=A[0];A=A.length>1?A[1]:"";if(I>0){A=Z(A,I,false);q+=A.slice(0,I);A=A.substr(I)}else if(I<0){I=-I;q=Z(q,I+1);A=q.slice(-I,q.length)+A;q=q.slice(0,-I)}A=E>0?P["."]+(A.length>E?A.slice(0,E):Z(A,E)):"";E=q.length-1;P=P[","];for(I="";E>=0;){if(w===0||
w>E){w=q.slice(0,E+1)+(I.length?P+I+A:A);break b}I=q.slice(E-w+1,E+1)+(I.length?P+I:"");E-=w;if(D<h.length){w=h[D];D++}}w=q.slice(0,E+1)+P+I+A}break;default:throw"Bad number format specifier: "+P;}h=/n|\$|-|%/g;for(D="";;){E=h.lastIndex;P=h.exec(o);D+=o.slice(E,P?P.index:o.length);if(!P)break;switch(P[0]){case "n":D+=w;break;case "$":D+=y.currency.symbol;break;case "-":if(/[1-9]/.test(w))D+=y["-"];break;case "%":D+=y.percent.symbol}}w=D}}else if(w instanceof Date)w=r(w,o,y);return w};G.parseInt=function(w,
o,y){return Math.floor(this.parseFloat(w,o,y))};G.parseFloat=function(w,o,y){if(typeof o==="string"){y=o;o=10}y=this.findClosestCulture(y);var D=NaN,E=y.numberFormat;if(w.indexOf(y.numberFormat.currency.symbol)>-1){w=w.replace(y.numberFormat.currency.symbol,"");w=w.replace(y.numberFormat.currency["."],y.numberFormat["."])}w=s(w);if(Y.test(w))D=parseFloat(w,o);else if(!o&&k.test(w))D=parseInt(w,16);else{y=T(w,E,E.pattern[0]);o=y[0];y=y[1];if(o===""&&E.pattern[0]!=="-n"){y=T(w,E,"-n");o=y[0];y=y[1]}o=
o||"+";var P;w=y.indexOf("e");if(w<0)w=y.indexOf("E");if(w<0){P=y;w=null}else{P=y.substr(0,w);w=y.substr(w+1)}var h=E["."],q=P.indexOf(h);if(q<0){y=P;P=null}else{y=P.substr(0,q);P=P.substr(q+h.length)}h=E[","];y=y.split(h).join("");q=h.replace(/\u00A0/g," ");if(h!==q)y=y.split(q).join("");o+=y;if(P!==null)o+="."+P;if(w!==null){E=T(w,E,"-n");o+="e"+(E[0]||"+")+E[1]}if(j.test(o))D=parseFloat(o)}return D};G.parseDate=function(w,o,y){y=this.findClosestCulture(y);var D,E;if(o){if(typeof o==="string")o=
[o];if(o.length){E=0;for(var P=o.length;E<P;E++){var h=o[E];if(h)if(D=p(w,h,y))break}}}else{o=y.calendar.patterns;for(E in o)if(D=p(w,o[E],y))break}return D||null};var R=G.cultures=G.cultures||{};R=R["default"]=R.en=G.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)",
"$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},R.en);R.calendar=R.calendar||R.calendars.standard;var W=/^\s+|\s+$/g,Y=/^[+-]?infinity$/i,k=/^0x[a-f0-9]+$/i,j=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,H=Object.prototype.toString;
jQuery.global=G})();/*

 jQuery Tiny Pub/Sub - v0.3pre - 11/4/2010
 http://benalman.com/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/
*/
(function(s){var Z=s({});s.subscribe=function(){Z.bind.apply(Z,arguments)};s.unsubscribe=function(){Z.unbind.apply(Z,arguments)};s.publish=function(){Z.trigger.apply(Z,arguments)}})(jQuery);timeglider=window.timeglider||{version:"0.1.0"};
(function(s){s=timeglider;var Z=jQuery,Q={},B={},T={},m={},K={};s.TG_Date=function(l,z,C){var i,p,r=C||0;if(typeof l=="number"){i=C=L.getDateFromSec(l);p=l+r}else{if(l=="today")l=L.getToday();i=C=l}l=jQuery.trim(i);reg=RegExp(/[T0-9-: ]/);if((reg.test(l)?l:false)===false)return{error:"invalid date"};else{l=L.parse8601(i);if(l.tz_ho)l=L.toFromUTC(l,{hours:l.tz_ho,minutes:l.tz_mi},"to");Z.extend(this,l);this.rd=L.getRataDie(this);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*
12+(12-(this.mo-1)));if(!p){p=Math.abs(this.rd)*86400;l=this.ho*3600;i=(this.mi-1)*60;r=1;if(this.rd<0)r=-1;p=r*(p+l+i)}this.sec=p;this.date_display=z?z.toLowerCase().substr(0,2):"da";this.dateStr=C}};var L=s.TG_Date;L.getTimeUnitSerial=function(l,z){var C=0;switch(z){case "ye":C=l.ye;break;case "mo":C=l.mo_num;break;case "da":C=l.rd;break;case "de":C=Math.floor(l.ye/10);break;case "ce":C=Math.floor(l.ye/100);break;case "thou":C=Math.floor(l.ye/1E3);break;case "tenthou":C=Math.floor(l.ye/1E4);break;
case "hundredthou":C=Math.floor(l.ye/1E5);break;case "mill":C=Math.floor(l.ye/1E6);break;case "tenmill":C=Math.floor(l.ye/1E7);break;case "hundredmill":C=Math.floor(l.ye/1E8);break;case "bill":C=Math.floor(l.ye/1E9)}return C};L.getMonthDays=function(l,z){return L.isLeapYear(z)==true&&l==2?29:L.monthsDayNums[l]};L.twentyFourToTwelve=function(l){var z={};z.ye=l.ye;z.mo=l.mo;z.da=l.da;z.ho=l.ho;z.mi=l.mi;z.ampm="am";if(l.ho)if(l.ho>=12){z.ampm="pm";z.ho=l.ho>12?l.ho-12:12}else if(l.ho==0){z.ho=12;z.ampm=
"am"}else z.ho=l.ho;else{z.ho=12;z.mi=0;z.ampm="am"}return z};L.getMonthAdj=function(l,z){var C=L.getDateFromMonthNum(l);switch(C.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:C=Math.floor(z+z/28*3);return{width:C,days:31};case 2:if(L.isLeapYear(C.ye)==true){C=Math.floor(z+z/28);return{width:C,days:29}}else return{width:z,days:28};default:C=Math.floor(z+z/28*2);return{width:C,days:30}}};L.getDateFromMonthNum=function(l){var z=0;if(l>0){z=l%12;if(z==0)z=12;l=Math.ceil(l/12)}else{z=Math.abs(l)%
12;z=12-z+1;if(z==13)z=1;l=-1*Math.ceil(Math.abs(l)/12)}return{ye:l,mo:z}};L.getMonthWidth=function(l,z,C){z=t/28;var i;switch(l){case 1:case 3:case 5:case 7:case 8:case 10:case 12:i=3;break;case 4:case 6:case 9:case 11:i=2;break;case 2:i=L.isLeapYear(yr)==true?1:0}return{width:Math.floor(C+z*i),numDays:28+i}};L.getToday=function(){var l=new Date;return l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()+" "+l.getHours()+":"+l.getMinutes()+":00"};L.getMonthFromRemDays=function(l,z){var C=0;var i=
C=0;C=L.isLeapYear(z)?1:0;if(l<=31){i=1;C=l}else if(l>31&&l<=59+C){i=2;C=l-(31+C)}else if(l>59+C&&l<=90+C){i=3;C=l-(59+C)}else if(l>90+C&&l<=120+C){i=4;C=l-(90+C)}else if(l>120+C&&l<=151+C){i=5;C=l-(120+C)}else if(l>151+C&&l<=181+C){i=6;C=l-(151+C)}else if(l>181+C&&l<=212+C){i=7;C=l-(181+C)}else if(l>212+C&&l<=243+C){i=8;C=l-(212+C)}else if(l>243+C&&l<=273+C){i=9;C=l-(243+C)}else if(l>273+C&&l<=304+C){i=10;C=l-(273+C)}else if(l>304+C&&l<=334+C){i=11;C=l-(304+C)}else{i=12;C=l-(334+C)}return{mo:i,da:C}};
L.getDateFromRD=function(l){if(m[l])return m[l];for(var z=Math.floor(l),C=Math.floor(z/146097)*400,i=z-Math.floor(z/146097)*146097,p=1,r=C+1,G=r+400;r<=G;r++)if(i>365){i-=365;if(L.isLeapYear(r))i-=1;p++}else r=G;C+=p;if(i==0)i=1;i=L.getMonthFromRemDays(i,C);p=(l-z)*1440;z=Math.floor(p%60);p=Math.floor(p/60);if(L.isLeapYear(C)&&i.mo==2)i.da+=1;z=C+"-"+i.mo+"-"+i.da+" "+p+":"+z+":00";return m[l]=z};L.getDateFromSec=function(l){if(K[l])return K[l];var z=L.getDateFromRD(l/86400);return K[l]=z};L.isLeapYear=
function(l){return l%400==0?true:l%100==0?false:l%4==0?true:false};L.getRataDie=function(l){function z(R,W){if(B[R+"-"+W])return B[R+"-"+W];for(var Y=0,k=R;k<W;k++)Y+=L.isLeapYear(k)?366:365;return B[R+"-"+W]=Y}function C(R,W){var Y;switch(R){case 1:Y=0;break;case 2:Y=31;break;case 3:Y=59;break;case 4:Y=90;break;case 5:Y=120;break;case 6:Y=151;break;case 7:Y=181;break;case 8:Y=212;break;case 9:Y=243;break;case 10:Y=273;break;case 11:Y=304;break;case 12:Y=334}if(R>2)if(L.isLeapYear(W))Y+=1;return Y}
var i=l.ye,p=l.mo;l=l.da;var r=0;if(Q[i+"-"+p+"-"+l])return Q[i+"-"+p+"-"+l];if(i>=0){if(i==0)i=1;r=Math.floor(i/400)*146097;var G=parseInt(z(i-i%400,i)),F=parseInt(C(p,i));r=r+G+F+l-366}else if(i<0)r=L.getBCRataDie({ye:i,mo:p,da:l});return Q[i+"-"+p+"-"+l]=r};L.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];L.monthsDayNums=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];L.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];L.getBCRataDie=
function(l){var z=l.ye,C=l.mo;l=l.da;if(T[z+"-"+C+"-"+l])return T[z+"-"+C+"-"+l];if(C==0)C=1;if(l==0)l=1;var i=Math.abs(z);debug.log("mo for neg date:",C);i=-1*((i-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][C]+(L.monthsDayNums[C]-l+1));return T[z+"-"+C+"-"+l]=i};L.setCulture=function(l){jQuery.global.culture=jQuery.global.cultures[l];L.monthNames=Z.merge([""],jQuery.global.culture.calendar.months.names);L.monthNamesAbbr=Z.merge([""],jQuery.global.culture.calendar.months.namesAbbr);L.dayNames=
jQuery.global.culture.calendar.days.names;L.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;L.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;L.patterns=jQuery.global.culture.calendar.patterns};L.prototype={format:function(l,z,C){C=C||{hours:0,minutes:0};if(z==true)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":l="yyyy";break;case "mo":l="MMM yyyy";break;case "da":l="MMM d, yyyy";break;case "ho":l="MMM d, yyyy h:mm tt";break;default:l="f"}if(this.ye>-27E4){z=
L.toFromUTC(_.clone(this),C,"from");z=new Date(z.ye,z.mo-1,z.da,z.ho,z.mi,z.se,0);return Z.global.format(z,l)}else return this.ye}};L.getTimeOffset=function(l){l=l.replace(/[^-\d:]/gi,"");var z=l.split(":"),C=parseInt(z[0],10);z=parseInt(z[1],10);var i=C+(C<0?-1:1)*(z/60);return{decimal:i,hours:C,minutes:z,seconds:i*3600,string:l}};L.tzOffsetStr=function(l,z){if(l){if(l.length==19)l+=z;else if(l.length==16)l+=":00"+z;return l}};L.parse8601=function(l){var z,C,i,p,r;r=function(F){return F?parseInt(F.replace("-",
""),10):0};var G=l.match(/^(\-?\d+)?(\-\d{1,2})?(\-\d{1,2})?(?:T| )?(\d{1,2})?(?::)?(\d{1,2})?(?::)?(\d{1,2})?(\+|\-)?(\d{1,2})?(?::)?(\d{1,2})?/);l=parseInt(G[1]);if(!l)return{error:"invalid date; no year provided"};z=r(G[2])||1;C=r(G[3])||1;i=r(G[4])||1;p=r(G[5])||0;r=r(G[6])||0;tz_pm=G[7]||"+";tz_ho=parseInt(G[8],10)||0;if(tz_pm=="-")tz_ho*=-1;tz_mi=parseInt(G[9],10)||0;if(tz_pm=="-")tz_mi*=-1;return{ye:l,mo:z,da:C,ho:i,mi:p,se:r,tz_ho:tz_ho,tz_mi:tz_mi}};L.getLastDayOfMonth=function(l,z){var C=
[0,31,28,31,30,31,30,31,31,30,31,30,31],i=0;return i=z==2&&L.isLeapYear(l)==true?29:C[z]};L.getDateTimeStrings=function(l){var z=L.parse8601(l);l=z.ye+"-"+z.mo+"-"+z.da;var C="pm";if(z.ho>12){z.ho-=12;C="pm"}else{if(z.ho==0)z.ho="12";C="am"}z=parseInt(z.ho,10)+":"+z.mi+" "+C;return{date:l,time:z}};L.validateInputDateString=function(l){if(!l)return false;return(l=l.match(/^(\-?\d+|today|now)-?(\d{1,2})?-?(\d{1,2})?/))?l:false};L.validateInputTimeString=function(l){if(!l)return true;l=l.match(/^(\d{1,2}|noon):?(\d{1,2})? ?(am|pm)?/);
if(l[1]){l[3]||(l[3]="am");return l}else return false};L.toFromUTC=function(l,z,C){var i=0,p=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];i={};if(C=="from"){i.ho=-1*z.hours;i.mi=-1*z.minutes}else if(C=="to"){i.ho=z.hours;i.mi=z.minutes}else{i.ho=-1*l.tz_ho;i.mi=-1*l.tz_mi}if(i.ho==0&&i.mi==0)return l;C=l.ho+l.mi/60+(-1*i.ho+i.mi*-1/60);if(C<0){i=24+C;if(l.da>1)l.da-=1;else if(l.mo==1){l.ye-=1;l.mo=12;l.da=31}else{l.mo-=1;l.da=L.getLastDayOfMonth(l.ye,l.mo)}}else if(C>24){i=C-24;if(L.isLeapYear(l.ye)&&
l.mo==2&&l.da==28)l.da=29;else if(l.da==p[l.mo]){if(l.mo==12){l.ye+=1;l.mo=1}else l.mo+=1;l.da=1}else l.da+=1}else i=C;p=function(r){r=Math.abs(r);var G=Math.floor(r);return{ho:G,mi:Math.round((r-G)*60)}}(i);l.ho=p.ho;l.mi=p.mi;if(z){l.tz_ho=z.tz_ho;l.tz_mi=z.tz_mi}else{l.tz_ho=0;l.tz_mi=0}return l};L.timezones=[{offset:"-12:00",name:"Int'l Date Line West"},{offset:"-11:00",name:"Bering & Nome"},{offset:"-10:00",name:"Alaska-Hawaii Standard Time"},{offset:"-10:00",name:"U.S. Hawaiian Standard Time"},
{offset:"-10:00",name:"U.S. Central Alaska Time"},{offset:"-09:00",name:"U.S. Yukon Standard Time"},{offset:"-08:00",name:"U.S. Pacific Standard Time"},{offset:"-07:00",name:"U.S. Mountain Standard Time"},{offset:"-07:00",name:"U.S. Pacific Daylight Time"},{offset:"-06:00",name:"U.S. Central Standard Time"},{offset:"-06:00",name:"U.S. Mountain Daylight Time"},{offset:"-05:00",name:"U.S. Eastern Standard Time"},{offset:"-05:00",name:"U.S. Central Daylight Time"},{offset:"-04:00",name:"U.S. Atlantic Standard Time"},
{offset:"-04:00",name:"U.S. Eastern Daylight Time"},{offset:"-03:30",name:"Newfoundland Standard Time"},{offset:"-03:00",name:"Brazil Standard Time"},{offset:"-03:00",name:"Atlantic Daylight Time"},{offset:"-03:00",name:"Greenland Standard Time"},{offset:"-02:00",name:"Azores Time"},{offset:"-01:00",name:"West Africa Time"},{offset:"00:00",name:"Greenwich Mean Time/UTC"},{offset:"00:00",name:"Western European Time"},{offset:"01:00",name:"Central European Time"},{offset:"01:00",name:"Middle European Time"},
{offset:"01:00",name:"British Summer Time"},{offset:"01:00",name:"Middle European Winter Time"},{offset:"01:00",name:"Swedish Winter Time"},{offset:"01:00",name:"French Winter Time"},{offset:"02:00",name:"Eastean EU"},{offset:"02:00",name:"USSR-zone1"},{offset:"02:00",name:"Middle European Summer Time"},{offset:"02:00",name:"French Summer Time"},{offset:"03:00",name:"Baghdad Time"},{offset:"03:00",name:"USSR-zone2"},{offset:"03:30",name:"Iran"},{offset:"04:00",name:"USSR-zone3"},{offset:"05:00",name:"USSR-zone4"},
{offset:"05:30",name:"Indian Standard Time"},{offset:"06:00",name:"USSR-zone5"},{offset:"06:30",name:"North Sumatra Time"},{offset:"07:00",name:"USSR-zone6"},{offset:"07:00",name:"West Australian Standard Time"},{offset:"07:30",name:"Java"},{offset:"08:00",name:"China & Hong Kong"},{offset:"08:00",name:"USSR-zone7"},{offset:"08:00",name:"West Australian Daylight Time"},{offset:"09:00",name:"Japan"},{offset:"09:00",name:"Korea"},{offset:"09:00",name:"USSR-zone8"},{offset:"09:30",name:"South Australian Standard Time"},
{offset:"09:30",name:"Central Australian Standard Time"},{offset:"10:00",name:"Guam Standard Time"},{offset:"10:00",name:"USSR-zone9"},{offset:"10:00",name:"East Australian Standard Time"},{offset:"10:30",name:"Central Australian Daylight Time"},{offset:"10:30",name:"South Australian Daylight Time"},{offset:"11:00",name:"USSR-zone10"},{offset:"11:00",name:"East Australian Daylight Time"},{offset:"12:00",name:"New Zealand Standard Time"},{offset:"12:00",name:"Int'l Date Line East"},{offset:"13:00",
name:"New Zealand Daylight Time"}]})(timeglider);(function(s){var Z=s.levelHeight=10,Q=jQuery;s.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var B=this;this.addBlock=function(K,L){K.right=K.left+K.width;K.bottom=K.top+K.height;K.tickScope=L;B.blocks.push(K)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(K,L){if(K=="sweep"){B.tree=[];for(var l=0;l<300;l++)B.tree[l]=[];this.vis=[]}this.blocks.sort(T);var z,C="",i="";b_htm=html="";b={};blength=this.blocks.length;for(var p=
title_adj=0;p<blength;p++){b=this.blocks[p];if(b.tickScope==K)if(Q.inArray(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div"){b_htm="<div style='left:"+b.left+"px' id='"+b.id+"'"+b.html.substr(4);html+=b_htm}else{if(b.image){if(b.image.display_class=="layout")title_adj=b.image.height+4;C="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else C="";m(b,0);if(b.y_position>0)b.top=-1*b.y_position;b.fontsize<10?b.opacity=
b.fontsize/10:b.opacity=1;if(b.span==true){l="timeglider-event-spanning";z="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"}else z=l="";i=b.icon?"<img class='timeglider-event-icon' src='"+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";html+=Math.abs(b.top)>L-16?"<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(L-Math.floor(16/3))+"px'>+</div>":"<div class='timeglider-timeline-event "+
l+"' id='"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+i+C+z+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>"}}}return html};var T=function(K,L){var l=L.importance,z=K.importance;return l<z?-1:l>z?1:0},m=function(K,L){var l=false,z=B.tree,C=z[L],i=L+1,p=false,r=2;bump_ht=Z;if(C!=undefined){for(r=0;r<C.length;r++){a:{l=C[r];if(!(K.left>l.right||K.right<l.left))if(K.left>=
l.left&&K.left<=l.right||K.right>=l.left&&K.right<=l.right||K.right>=l.right&&K.left<=l.left||K.right<=l.right&&K.left>=l.left)if(K.bottom<=l.bottom&&K.bottom>=l.top||K.top<=l.bottom&&K.top>=l.top||K.top==l.bottom&&K.top==l.top){l=true;break a}l=false}if(l==true){K.top-=bump_ht;K.bottom-=bump_ht;m(K,i);p=true;break}}if(p==false){K.top-=K.fontsize;C.push(K);r=Math.ceil(K.height/Z);C=0;for(C=1;C<=r;C++){i=L+C;z[i].push(K)}}}}}})(timeglider);(function(s){var Z=s.TG_Date,Q=jQuery,B={},T;s.TG_EventCollection=Backbone.Collection.extend({model:s.TG_Event});s.TG_Event=Backbone.Model.extend({urlRoot:"/event",defaults:{title:"Untitled"},initialize:function(m){if(m.image){m.image={id:m.id,src:m.image,display_class:m.image_class||"above",width:0,height:0};this.getEventImageSize(m.image)}else m.image="";m.titleWidth=s.getStringWidth(m.title);this.set(m)},validate:function(){},getEventImageSize:function(m){function K(C,i){return function(){return i.apply(C,
arguments)}}var L=this,l=new Image,z=l.src=m.src;l.onerror=K(l,function(){debug.log("error loading image:"+z)});l.onload=K(l,function(){L.get("image").height=this.height;L.get("image").width=this.width})}});s.TG_TimelineCollection=Backbone.Collection.extend({model:s.TG_Timeline});s.TG_Timeline=Backbone.Model.extend({urlRoot:"/timeline",defaults:{initial_zoom:25,focus_date:"today",timezone:"00:00",title:"Untitled",events:[],legend:[]},_chewTimeline:function(m){T=m.mediator;B=T.options;var K={da:[],
mo:[],ye:[],de:[],ce:[],thou:[],tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},L=Z.units;m.startSeconds=[];m.endSeconds=[];m.spans=[];m.hasImagesAbove=false;m.timeOffset=Z.getTimeOffset(m.timezone||"00:00");if(!m.color)m.color="#333333";if(m.events.length>0){for(var l,z,C,i,p=m.events.length,r=0;r<p;r++){z=m.events[r];if(z.map)if(T.main_map){if(timeglider.mapping.ready){z.map.marker_instance=timeglider.mapping.addAddMarkerToMap(z,T.main_map);debug.log("marker_instance",z.map.marker_instance)}}else{debug.log("NO MAIN MAP... BUT LOAD MAPS FOR MODAL");
s.googleMapsLoad()}if(z.id)C=z.id;else z.id=C="anon"+this.anonEventId++;l=z.date_display||z.date_limit||"da";z.date_display=l.toLowerCase().substr(0,2);if(m.timeOffset.seconds){z.startdate=Z.tzOffsetStr(z.startdate,m.timeOffset.string);if(z.enddate)z.enddate=Z.tzOffsetStr(z.enddate,m.timeOffset.string)}z.startdateObj=new Z(z.startdate,z.date_display);if(z.enddate&&z.enddate!==z.startdate){z.enddateObj=new Z(z.enddate,z.date_display);z.span=true;m.spans.push({id:z.id,start:z.startdateObj.sec,end:z.enddateObj.sec})}else{z.enddateObj=
z.startdateObj;z.span=false}if(z.image_class=="above")m.hasImagesAbove=true;z.icon=!z.icon||z.icon==="none"?"":B.icon_folder+z.icon;m.startSeconds.push(z.startdateObj.sec);m.endSeconds.push(z.enddateObj.sec);for(var G=L.length,F=0;F<G;F++){l=L[F];i=Z.getTimeUnitSerial(z.startdateObj,l);if(K[l][i]!==undefined)K[l][i].push(C);else K[l][i]=[C]}z=new s.TG_Event(z);T.eventCollection.add(z)}L=timeglider.getLowHigh(Q.merge(m.startSeconds,m.endSeconds));m.bounds={first:L.low,last:L.high}}if(m.legend.length>
0){L=m.legend;for(p=0;p<L.length;p++);}m.display="expanded";m.dateHash=K;delete m.events;return m},initialize:function(m){this.set(this._chewTimeline(m));this.bind("change",function(){debug.log("changola")})}})})(timeglider);(function(s){var Z=s.TG_Date,Q="",B="",T={},m=jQuery,K={},L="",l,z,C;s.TG_PlayerView=function(i,p){var r=this;B=p;T=B.options;Q="#"+i._id;L=i._id;this._views={PLACE:Q,CONTAINER:Q+" .timeglider-container",DATE:Q+" .timeglider-date-display",TIMELINE_MENU:Q+" .timeglider-timeline-menu",TIMELINE_MENU_UL:Q+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:Q+" .timeglider-list-bt",SLIDER_CONTAINER:Q+" .timeglider-slider-container",SLIDER:Q+" .timeglider-slider",ZOOM_DISPLAY:Q+" .timeglider-zoomlevel-display",
TRUCK:Q+" .timeglider-truck",CENTERLINE:Q+" .timeglider-centerline",TICKS:Q+" .timeglider-ticks",HANDLE:Q+" .timeglider-handle",FOOTER:Q+" .timeglider-footer",FILTER_BT:Q+" .timeglider-filter-bt",FILTER_BOX:Q+" .timeglider-filter-box",SETTINGS_BT:Q+" .timeglider-settings-bt"};l=this._views.CONTAINER;z=this._views.TICKS;C=this._views.DATE;this.initTimelineVOffset=100;this.tick_height=34;this._templates={};this._templates={test:"testola",event_modal_small:"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><div class='dateline'>{{html dateline}}</div><h4 id='title'>${title}</h4><p>{{html image}}{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>",
event_modal_full:m.template(null,"<div class='tg-modal full_modal' id='ev_${id}_modal'><div class='full_modal_scrim'></div><div class='full_modal_panel'><div class='close-button full_modal_close'>x</div><div class='dateline'>{{html dateline}}</div><table><tr><td><h4>${title}</h4><div class='description'><p>{{html description}}</p></div></td><td><div>{{html image}}</div><div id='insert'></div></td></tr></table><div class='footer'><ul>{{html links}}</ul></div></div>"),filter_modal:m.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),settings_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-settings-modal'><div class='close-button'></div><h3>settings</h3><div class='timeglider-menu-modal-content'><div class='timeglider-settings-timezone'></div></div><div class='timeglider-menu-modal-point-right'></div>"),
legend_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-display-none'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};this.timelineModal=s.TG_TimelineView.extend({tagName:"div",model:s.TG_Timeline,className:"tg-modal timeglider-timeline-modal ui-widget-content",events:{"click .close-button-remove":"remove"},
template:"<div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p>",initialize:function(){this.model.bind("change",this.render,this)},render:function(){m(this.el).html(m.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id")+"_timelineModal");return this},remove:function(){m(this.el).fadeOut()}});m(l).delegate(".tg-timeline-envelope .timeline-info","click",function(){var F=m(this).data("timeline_id");r.openTimelineModal(F)}).delegate(".tg-timeline-envelope .expand-collapse",
"click",function(){var F=m(this).data("timeline_id");r.expandCollapseTimeline(F)}).delegate(".tg-timeline-envelope .tg-timeline-legend-bt","click",function(){var F=m(this).data("timeline_id");r.legendModal(F)}).delegate(".close-button-remove","click",function(){var F=m(this).parent().attr("id");m("#"+F).remove()}).delegate(".full_modal_scrim, .full_modal_close","click",function(){m(".full_modal").remove()}).delegate(".timeglider-more-plus","click",function(){B.zoom(-1)}).delegate(".timeglider-legend-close",
"click",function(){var F=m(l+" .timeglider-legend");F.fadeOut(300,function(){F.remove()})}).delegate(".timeglider-legend-all","click",function(){m(l+" .timeglider-legend li").each(function(){m(this).removeClass("tg-legend-icon-selected")});B.setFilters({origin:"legend",icon:"all"})}).css("height",m(Q).height());this.basicFontSize=T.basic_fontsize;T.show_footer==false&&m(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=
this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();this.setPanButton(m(".timeglider-pan-right"),-30);this.setPanButton(m(".timeglider-pan-left"),30);m(this._views.TRUCK).dblclick(function(F){var R=F.pageX-r.dimensions.container.offset.left-r.dimensions.container.width/2,W=B.getZoomInfo().spp;F=B.getFocusDate().sec;R=new Z(Math.floor(F+R*W));F=new Z(F);debug.log("DOUBLECLICK:: FOCUS date:"+F.mo+"-"+
F.ye+".......CLICK date:"+R.mo+"-"+R.ye)}).bind("mousewheel",function(F,R){var W=Math.ceil(-1*R*3),Y=B.getZoomLevel();B.setZoomLevel(Y+W);return false});m(z).draggable({axis:"x",drag:function(){B.setTicksOffset(m(this).position().left)},stop:function(){r.resetTicksHandle();r.registerDragging()}}).delegate(l+" .timeglider-timeline-event","click",function(){var F=m(this).attr("id"),R=B.eventCollection.get(F).attributes;if(R.click_callback){F=R.click_callback.split(".");var W=F.length;if(W==1)window[F[0]](R);
else if(W==2)window[F[0]][F[1]](R);else if(W==3)window[F[0]][F[1]][F[2]](R)}else r.eventModal(F)}).delegate(".timeglider-timeline-event","mouseover",function(){var F=B.eventCollection.get(m(this).attr("id")).attributes;r.eventHover(m(this),F)}).delegate(".timeglider-timeline-event","mouseout",function(){var F=B.eventCollection.get(m(this).attr("id")).attributes;r.eventUnHover(m(this),F)}).delegate(".timeglider-event-collapsed","hover",function(){var F=B.eventCollection.get(m(this).attr("id")).attributes.title;
debug.trace("collapsed, title:"+F,"note")});B.options.show_centerline===true?m(this._views.CENTERLINE).css({height:r.dimensions.container.height,left:r.dimensions.container.centerx}):m(this._views.CENTERLINE).css({display:"none"});m.subscribe("mediator.ticksOffsetChange",function(){r.tickHangies();r.registerTitles();r.registerDragging()});m.subscribe("mediator.focusToEvent",function(){});m.subscribe("mediator.zoomLevelChange",function(){r.tickNum=0;r.leftside=0;var F=B.getZoomLevel();m(r._views.SLIDER).slider("value",
r.invSliderVal(F));r.displayZoomLevel(F);r.castTicks("zoomLevelChange")});m.subscribe("mediator.ticksReadySignal",function(){B.ticksReady===true&&r.freshTimelines()});m.subscribe("mediator.refreshSignal",function(){r.tickNum=0;r.leftside=0;r.castTicks("refreshSignal")});m.subscribe("mediator.ticksArrayChange",function(){});m.subscribe("mediator.focusDateChange",function(){this.displayFocusDate()});m.subscribe("mediator.timelineDataLoaded",function(){m(".timeglider-loading").fadeOut(500);r.buildSettingsMenu();
r.buildTimelineMenu()});m.subscribe("mediator.activeTimelinesChange",function(){m(r._views.TIMELINE_MENU_UL+" li").each(function(){var F=m(this).attr("id");m.inArray(F,B.activeTimelines)!=-1?m(this).addClass("activeTimeline"):m(this).removeClass("activeTimeline")})});m.subscribe("mediator.filterChange",function(){});if(m.support.touch){m("#"+L).addTouch();var G=document.getElementById(L);G.addEventListener("gesturestart",function(F){F.preventDefault();m("#output").append("<br>gesture zoom:"+B.getZoomLevel())},
false);G.addEventListener("gestureend",function(F){F.preventDefault();m("#output").append("<br>gesture end:"+B.getZoomLevel())},false);G.addEventListener("gesturechange",function(F){F.preventDefault();F.preventDefault();if(B.gesturing===false){B.gesturing=true;B.gestureStartZoom=B.getZoomLevel()}B.setZoomLevel(Math.ceil(B.gestureStartZoom/F.scale))},false)}};s.TG_PlayerView.prototype={getWidgetDimensions:function(){var i=m(l),p=i.width(),r=Math.floor(p/2)+1,G=i.height(),F=Math.floor(G/2),R=this.tick_height,
W=i.position().left;i=i.offset();var Y=T.show_footer==true?m(this._views.FOOTER).height():0;return{container:{width:p,height:G,centerx:r,centery:F,left:W,offset:i},tick:{top:G-Y-R},footer:{height:Y}}},scaleToImportance:function(i,p){return i/p},displayZoomLevel:function(){var i=B.getZoomLevel();i>0&&T.display_zoom_level==true&&m(this._views.ZOOM_DISPLAY).text(i)},displayFocusDate:function(){var i=B.getFocusDate();m(C).text(i.format("d MMM yyyy",false))},doSomething:function(){alert("DO SOMETHING, viewer")},
setPanButton:function(i,p){var r=this;m(i).live("mousedown",function(){r.intervalMachine("pan",{type:"set",fn:r.pan,args:[p],intvl:33})}).live("mouseup",function(){r.intervalMachine("pan",{type:"clear",fn:r.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){r.intervalMachine("pan",{type:"clear",fn:r.pan,callback:"resetTicksHandle"})})},intervalMachine:function(i,p){var r=this;if(p.type==="clear"){clearInterval(K[i]);if(p.callback)r[p.callback]()}else K[i]=setInterval(function(){p.fn.apply(r,
p.args)},p.intvl)},invSliderVal:function(i){return Math.abs(i-101)},pan:function(i){i=i||20;$t=m(z);newPos=$t.position().left+i;$t.css({left:newPos});B.setTicksOffset(newPos)},registerTitles:function(){var i,p,r,G,F,R,W,Y,k,j,H,w=m(l).offset().left;m(".timeglider-event-spanning").each(function(){i=m(this).offset().left-w;p=m(this).outerWidth();W=m(".timeglider-event-title",this);r=W.outerWidth()+5;G=W.siblings(".timeglider-event-spanner").outerWidth();G>r&&i<0&&Math.abs(i)<p-r&&W.css({marginLeft:-1*
i+5})});m(".tg-timeline-envelope").each(function(){Y=m(this).offset().left-w;k=m(".titleBar",this);j=m(".titleBar .timeline-title",this);F=k.position().left;H=F+Y;k.outerWidth();r=k.outerWidth();R=-1*H;H<0&&j.css({marginLeft:R+5})})},registerDragging:function(){var i=B.startSec,p=m(z).position().left,r=B.getZoomInfo().spp;i=new Z(i-p*r);B.setFocusDate(i);this.displayFocusDate()},setupFilter:function(){var i=this;$filter=m.tmpl(i._templates.filter_modal,{}).appendTo(i._views.CONTAINER);$filter.css("z-index",
i.ztop++).position({my:"right bottom",at:"right top",of:m(i._views.FILTER_BT),offset:"-8, -12"}).hide();m(l).delegate(".timeglider-filter-box .close-button","click",function(){$filter.fadeOut()});m(i._views.FILTER_BT).click(function(){$filter.fadeIn();m(this);var p=i._views.FILTER_BOX;if(i.filterBoxActivated==false){i.filterBoxActivated=true;var r=m(p+" .timeglider-filter-apply"),G=m(".timeglider-filter-box .close-button"),F=m(p+" .timeglider-filter-clear"),R="",W="";r.click(function(){R=m(p+" .timeglider-filter-include").val();
W=m(p+" .timeglider-filter-exclude").val();B.setFilters({origin:"clude",include:R,exclude:W});m(p).toggleClass("timeglider-display-block")});G.click(function(){m(p).toggleClass("timeglider-display-none")});F.click(function(){B.setFilters({origin:"clude",include:"",exclude:""});m(p+" .timeglider-filter-include").val("");m(p+" .timeglider-filter-exclude").val("");m(p).toggleClass("timeglider-display-block")})}})},buildTimelineMenu:function(){debug.log("buildTimelineMenu");var i=this,p;m(i._views.TIMELINE_LIST_BT);
if(m(i._views.TIMELINE_MENU)[0]){debug.log("REBUILDING");m(i._views.TIMELINE_MENU).remove()}p=m.tmpl(i._templates.timeline_list_modal,{}).appendTo(i._views.CONTAINER);var r=Backbone.View.extend({initialize:function(){this.model.bind("change",this.render,this)},tagName:"li",className:"timeglider-timeline-list-item",template:"<a href='#'>${title}</a>...",events:{click:"toggleTimeline"},toggleTimeline:function(){B.toggleTimeline(this.model.get("id"))},render:function(){m(this.el).html(m.tmpl(this.template,
this.model.attributes)).attr("id",this.model.get("id")+"_listItem");return this}});m(i._views.TIMELINE_MENU_UL).html("");_.each(B.timelineCollection.models,function(G){m(i._views.TIMELINE_MENU_UL).append((new r({model:G})).render().el)});p.position({my:"right bottom",at:"right top",of:m(i._views.TIMELINE_LIST_BT),offset:"-8, -12"}).hide();m(l).delegate(".timeglider-timeline-menu .close-button","click",function(){p.fadeOut()}).delegate(this._views.TIMELINE_LIST_BT,"click",function(){p.fadeIn()})},
getTimezonePulldown:function(i,p){var r="<select name='timezone' id='"+i+"'>",G=false,F="selected";m.map(Z.timezones,function(R){if(p==R.offset&&G==false){F="selected";G=true}else F="";r+="<option value='"+R.offset+"' "+F+">"+R.name+"</option>"});r+="</select>";return r},buildSettingsMenu:function(){var i=m.tmpl(this._templates.settings_modal,{}).appendTo(this._views.CONTAINER),p=this.getTimezonePulldown("timeglider-settings-timezone",B.timeOffset.string);i.find(".timeglider-settings-timezone").append('<p>Make changes below, then click on "save". More settings options to come!</p>').append('<span class="settings-label">timezone:</span> '+
p).append("<p style='clear:both'>&nbsp;</p><div class='btn success' id='timeglider-settings-save'>save</div>");i.position({my:"right bottom",at:"right top",of:m(this._views.SETTINGS_BT),offset:"-8, -12"}).hide();m(l).delegate(".timeglider-settings-modal .close-button","click",function(){i.fadeOut()}).delegate(this._views.SETTINGS_BT,"click",function(){i.fadeIn()}).delegate("#timeglider-settings-save","click",function(){var r=m(l+" #timeglider-settings-timezone").val();B.setTimeoffset(r)})},buildSlider:function(){var i=
B.getZoomLevel();if(T.min_zoom==T.max_zoom)m(this._views.SLIDER_CONTAINER).css("display","none");else{T.display_zoom_level==true&&m("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var p=this;i=p.invSliderVal(i);var r=B.max_zoom,G=B.min_zoom;m(this._views.SLIDER).css("height",(1+r-G)*3).slider({steps:100,handle:m(".knob"),animate:300,orientation:"vertical",min:p.invSliderVal(r),max:p.invSliderVal(G),value:i,start:function(){p.sliderActive=true},
stop:function(){p.sliderActive=false},change:function(){},slide:function(F,R){B.setZoomLevel(p.invSliderVal(R.value))}})}},getEventDateLine:function(i){var p="<span class='timeglider-dateline-startdate'>"+i.startdateObj.format("",true,B.timeOffset)+"</span>";endDateF="";if(i.span==true)endDateF=" &ndash; <span class='timeglider-dateline-enddate'>"+i.enddateObj.format("",true,B.timeOffset)+"</span>";return p+endDateF},eventHover:function(i,p){var r=m(".timeglider-event-hover-info");p.date_display!=
"no"&&r.position({my:"left bottom",at:"left top",of:i,offset:"1, -10",collision:"flip flip"}).html(this.getEventDateLine(p));i.addClass("tg-event-hovered")},eventUnHover:function(i){m(".timeglider-event-hover-info").css("left","-1000px");i.removeClass("tg-event-hovered")},clearTicks:function(){this.tickNum=this.leftside=0;m(z).css("left",0);m(l+" .tg-timeline-envelope").remove();m(l+" .timeglider-tick").remove()},castTicks:function(){this.clearTicks();B.getZoomLevel();var i=B.getFocusDate(),p=B.getZoomInfo().width;
p=Math.ceil(this.dimensions.container.width/p)+4;var r="l";B.setTicksReady(false);this.addTick({type:"init",focus_date:i});for(i=1;i<=p;i+=1){this.addTick({type:r});r=r=="l"?"r":"l"}B.setTicksReady(true);this.displayFocusDate()},addTick:function(i){var p=0,r=0,G=r=0,F=0,R=0,W="";F={};R={};G={};var Y={};R={};Y="";var k=0,j=1;W="";tickUnit=B.getZoomInfo().unit;tickWidth=B.getZoomInfo().width;focusDate=B.getFocusDate();tick_top=parseInt(this.dimensions.tick.top);F=B.addToTicksArray({type:i.type,unit:tickUnit},
focusDate);if(tickUnit=="mo"){R=Z.getMonthAdj(F,tickWidth);tickWidth=R.width;p=R.days}this.tickNum++;if(i.type=="init"){R=this.tickOffsetFromDate(B.getZoomInfo(),B.getFocusDate(),tickWidth);this.leftside=r=Math.ceil(this.dimensions.container.centerx+R);this.rightside=r+tickWidth}else if(i.type=="l")this.leftside=r=Math.floor(this.leftside-tickWidth);else if(i.type=="r"){r=Math.floor(this.rightside);this.rightside+=tickWidth}B.getTickBySerial(F).width=tickWidth;B.getTickBySerial(F).left=r;W=this._views.PLACE+
"_"+tickUnit+"_"+F+"-"+this.tickNum;R=m("<div class='timeglider-tick' id='"+W+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(z);R.css({width:tickWidth,left:r,top:tick_top});G=this.getTickMarksInfo({unit:tickUnit,width:tickWidth});G=p||G.tperu;r=tickWidth/G;if(r>5){i=Raphael(W,tickWidth,30);var H="";for(p=0;p<G;p++){W=p*r;H+="M"+W+" 20 L"+W+" 30";if(tickUnit=="da"&&r>16){W=this.getHourLabelFromHour(k,r);Y+="<div class='timeglider-tick-sub-label' style='width:"+(r-4)+"px'>"+
W+"</div>";k++}if(tickUnit=="mo"&&r>16){Y+="<div class='timeglider-tick-sub-label' style='width:"+(r-4)+"px'>"+j+"</div>";j++}}i.path(H).attr({stroke:"#333","stroke-width":1})}Y&&R.append("<div style='width:"+(tickWidth+10)+"px;position:absolute;top:17px;left:0;overflow:hidden'>"+Y+"</div>");Y={unit:tickUnit,width:tickWidth,serial:F};F=this.getDateLabelForTick(Y);R.children("#label").text(F);return Y},getHourLabelFromHour:function(i,p){var r="";r=r="";r=i>12?i-12:i;if(r==0)r=12;return r+(p>60?":00":
"")+(i>11?" pm":" am")},getTickMarksInfo:function(i){switch(i.unit){case "da":i=24;break;case "mo":i=30;break;case "ye":i=12;break;default:i=10}return{tperu:i}},getDateLabelForTick:function(i){var p=i.serial,r=i.width;switch(i.unit){case "bill":return p==0?"1":p>0?p+" billion":p+" b.y. bce";case "hundredmill":return p==0?"1":p>0?p+"00 million":p+"00 m.y. bce";case "tenmill":return p==0?"1":p>0?p+"0 million":p+"0 m.y. bce";case "mill":return p==0?"1":p>0?p+" million":p+" m.y. bce";case "hundredthou":return p==
0?"1":p>0?p+"00,000":p+"00,000 bce";case "tenthou":return p==0?"1":p>0?p+"0,000":p+"0,000 bce";case "thou":return p==0?"1("+p+")":p>0?p+"000":p+"000 bce";case "ce":return p==0?"1("+p+")":p>0?p+"00":p+"00 bce";case "de":return p>120?p*10+"s":p*10;case "ye":return p;case "mo":i=Z.getDateFromMonthNum(p);return r<120?Z.monthNamesAbbr[i.mo]+" "+i.ye:Z.monthNames[i.mo]+", "+i.ye;case "da":i=new Z(Z.getDateFromRD(p));return r<120?Z.monthNamesAbbr[i.mo]+" "+i.da+", "+i.ye:Z.monthNames[i.mo]+" "+i.da+", "+
i.ye;default:return i.unit+":"+p+":"+r}},tickHangies:function(){var i=m(z).position().left,p=this.rightside+i-this.dimensions.container.width;if(this.leftside+i>-100){i=this.addTick({type:"l"});this.appendTimelines(i)}else if(p<100){i=this.addTick({type:"r"});this.appendTimelines(i)}},tickOffsetFromDate:function(i,p,r){switch(i.unit){case "da":p=p.ho/24+p.mi/1440;r*=p;break;case "mo":i=Z.getMonthDays(p.mo,p.ye);p=(p.da-1)/i+p.ho/(24*i)+p.mi/(1440*i);r*=p;break;case "ye":p=((p.mo-1)*30+p.da)/365;r*=
p;break;case "de":p=p.ye%10/10+p.mo/120;r*=p;break;case "ce":p=p.ye%100/100+p.mo/1200;r*=p;break;case "thou":p=p.ye%1E3/1E3;r*=p;break;case "tenthou":p=p.ye%1E4/1E4;r*=p;break;case "hundredthou":p=p.ye%1E5/1E5;r*=p;break;default:r=0}return-1*r},resetTicksHandle:function(){m(this._views.HANDLE).offset({left:m(l).offset().left})},easeOutTicks:function(){Math.abs(this.dragSpeed)>5&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(i){var p=i.tick.unit,r=i.tick.serial;i=i.timeline.dateHash;
return i[p][r]&&i[p][r].length>0?i[p][r]:0},setTimelineProp:function(i,p,r){B.timelineCollection.get(i).attributes[p]=r},getTimelineProp:function(i,p){return B.timelineCollection.get(i).attributes[p]},passesFilters:function(i,p){var r=true,G="",F=[],R;G="";F=[];if(p<i.low_threshold||p>i.high_threshold)return false;if(G=B.filters.include){F=G.split(",");r=false;for(R=0;R<F.length;R++){G=RegExp(m.trim(F[R]),"i");if(i.title.match(G))r=true}}if(G=B.filters.exclude){F=G.split(",");for(R=0;R<F.length;R++){G=
RegExp(m.trim(F[R]),"i");if(i.title.match(G))r=false}}G=i.icon;if(B.filters.legend.length>0)if(m.inArray(G,B.filters.legend)==-1)r=false;return r},freshTimelines:function(){var i=this,p,r,G,F=B.activeTimelines,R=B.ticksArray,W="",Y;r="";var k=i.dimensions.container.centerx,j=i.dimensions.container.width,H=B.getFocusDate().sec,w=B.getZoomInfo().spp;B.getZoomInfo();r=[];var o=[];j=H-Math.floor(w*(j/2));G=0;for(var y,D=0,E=i.dimensions.container.height,P=D=0;P<F.length;P++){r=B.timelineCollection.get(F[P]);
p=r.attributes;y=p.display;D=p.top?parseInt(p.top.replace("px","")):E-i.initTimelineVOffset;r=new s.TG_TimelineView({model:r});G=B.timeOffset.seconds/w;$tl=m(r.render().el).appendTo(z);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){i.setTimelineProp(p.id,"top",m(this).css("top"));B.refresh()}}).css({top:D,left:G});Y=$tl.children(".titleBar");r=k+(p.bounds.first-H)/w;G=k+(p.bounds.last-H)/w;Y.css({top:void 0,left:r,width:G-r});if(y=="expanded")p.borg=W=new timeglider.TG_Org;for(G=0;G<R.length;G++){r=
this.getTimelineEventsByTick({tick:R[G],timeline:p});m.merge(o,r)}for(G=0;G<p.spans.length;G++){r=p.spans[G];r.start<j&&r.end>j&&m.inArray(r.id,o)==-1&&o.unshift(r.id)}r=this.compileTickEventsAsHtml(p,o,0,"sweep");D=p.hasImagesAbove?D-56:D;if(y=="expanded"){r=W.getHTML("sweep",D);p.borg=W.getBorg()}r!="undefined"&&$tl.append(r);this.registerEventImages($tl)}i.registerTitles()},appendTimelines:function(i){for(var p=B.activeTimelines,r,G="",F=0;F<p.length;F++){r=B.timelineCollection.get(p[F]).attributes;
idArr=this.getTimelineEventsByTick({tick:i,timeline:r});G=this.compileTickEventsAsHtml(r,idArr,i.serial,"append");if(r.display=="expanded")G=r.borg.getHTML(i.serial,r.top);r=m(l+" .tg-timeline-envelope#"+r.id).append(G);this.registerEventImages(r)}},compileTickEventsAsHtml:function(i,p,r,G){var F;F=0;var R=this.dimensions.container.centerx,W=i.display,Y=$tl.height();stuff="";foSec=B.startSec;spp=B.getZoomInfo().spp;zl=B.getZoomInfo().level;buffer=20;borg=i.borg;block_arg="sweep";if(G=="append")block_arg=
r;for(r=0;r<p.length;r++){ev=B.eventCollection.get(p[r]).attributes;if(this.passesFilters(ev,zl)===true){F=R+(ev.startdateObj.sec-foSec)/spp;if(W=="expanded"){impq=i.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=F;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=ev.spanwidth}F=0;if(ev.image&&ev.image.display_class==="layout"){F=
ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+F;ev.top=Y-ev.height;borg.addBlock(ev,block_arg)}else if(W=="collapsed")stuff+="<div id='"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(Y-2)+"px;left:"+F+"px'></div>"}}return W=="collapsed"?stuff:""},registerEventImages:function(i){m(l+" .timeglider-event-image-bar").each(function(){m(this).position({my:"top",at:"bottom",of:i,offset:"0, 0"}).css("left",0)});m(l+" .timeglider-event-image-above").each(function(){m(this).position({my:"top",
at:"top",of:m(l),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(i){i=B.timelineCollection.get(i).attributes;i.display=i.display=="expanded"?"collapsed":"expanded";B.refresh()},openTimelineModal:function(i){i=new this.timelineModal({model:B.timelineCollection.get(i)});m(i.render().el).appendTo("body").position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).css("z-index",this.ztop++).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(i){if(!i)return"";
var p="",r=0,G="",F="";if(typeof i=="string")p="<li><a href='"+i+"' target='_blank'>link</a></li>";else if(typeof i=="object")for(r=0;r<i.length;r++){G=i[r].url;F=i[r].label;p+="<li><a href='"+G+"' target='_blank'>"+F+"</a></li>"}return p},eventModal:function(i){m(l+" #"+i+"_modal").remove();var p=this,r=false,G=false,F="";F={};F=0;var R=T.event_modal.type;F=m("#"+i);var W=B.eventCollection.get(i).attributes,Y=W.image&&W.image.src?"<img src='"+W.image.src+"'>":"",k=this.createEventLinksMenu(W.link);
i={title:W.title,description:W.description,id:i,dateline:p.getEventDateLine(W),links:k,image:Y,video:W.video};if(W.video){i.video=W.video;R="full";G=true}else if(W.map)if(W.map.latlong){r=true;R="full"}switch(R){case "full":i=m.tmpl(p._templates.event_modal_full,i);i.appendTo(l).css({"z-index":p.ztop++}).position({my:"left top",at:"left top",of:l,offset:"0, 0",collision:"none none"});if(r==true){i.find("#insert").append("<div id='map_modal_map'></div>");F=W.map.zoom||12;llarr=String(W.map.latlong).split(",");
map_ll=new google.maps.LatLng(parseFloat(llarr[0]),parseFloat(llarr[1]));F={zoom:F,center:map_ll,mapTypeId:google.maps.MapTypeId.ROADMAP};F=new google.maps.Map(m("#map_modal_map")[0],F);if(W.map.markers)for(r=0;r<W.map.markers.length;r++){G=W.map.markers[r];new google.maps.MarkerImage(G.image,new google.maps.Size(24,32),new google.maps.Point(0,0),new google.maps.Point(0,32));i=G.latlong.split(",");i=new google.maps.LatLng(i[0],i[1]);G=new google.maps.Marker({position:i,map:F,icon:G.icon,title:G.title,
zIndex:G.zIndex})}}else G==true&&i.find("#insert").append("<iframe width='100%' height='300' src='"+W.video+"'></iframe></div>");W=p.dimensions.container.height;r=p.dimensions.container.width;G=m(l+" .full_modal_panel");i=G.width();F=G.height();G.css({top:(W-F)/2+"px",left:(r-i)/2+"px"});break;case "video":i=m.tmpl(p._templates.event_modal_video,i);i.appendTo(z).css("z-index",p.ztop++).position({my:"right center",at:"left center",of:F,offset:"-12, -1",collision:"flip fit"}).hover(function(){m(this).css("z-index",
p.ztop++)});break;default:i=m.tmpl(p._templates.event_modal_small,i);i.appendTo(z).css("z-index",p.ztop++).position({my:"right center",at:"left center",of:F,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){m(this).css("z-index",p.ztop++)})}},legendModal:function(i){var p=B.timelineCollection.get(i).attributes.legend,r,G,F,R="";for(r=0;r<p.length;r++){G=T.icon_folder+p[r].icon;F=p[r].title;R+="<li><img src='"+G+"'>"+F+"</li>"}i={id:i,legend_list:R};m(l+" .timeglider-legend").remove();
m.tmpl(this._templates.legend_modal,i).appendTo(l).css("z-index",this.ztop++).toggleClass("timeglider-display-none").position({my:"left top",at:"left top",of:l,offset:"16, -4",collision:"none none"});m(l+" .timeglider-legend li").click(function(){m(this).parent().attr("id");var W=m(this).children("img").attr("src");m(this).toggleClass("tg-legend-icon-selected");B.setFilters({origin:"legend",icon:W})})},parseHTMLTable:function(i){var p={},r=+new Date,G=[];m("#"+i).find("tr").each(function(F){var R=
m(this).children(),W;if(F===0)G=R.map(function(){return m(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{W={};R.each(function(Y){W[G[Y]]=m(this).text()});p["prefix"+r++]=W}});return p}};s.TG_TimelineView=Backbone.View.extend({initialize:function(){var i=this;this.model.bind("change:title",function(){m(i.el).find(".timeline-title-span").text(i.model.get("title"))});this.model.bind("destroy",this.remove,this)},tagName:"div",template:"",events:{"click .timeline-title-span":"titleClick"},
className:"tg-timeline-envelope",template:"<div class='titleBar'><div class='timeline-title'><span class='timeline-title-span'>${title}</span><div class='tg-timeline-env-buttons'><span class='timeline-info' data-timeline_id='${id}'>info</span><span class='tg-timeline-legend-bt' data-timeline_id='${id}'>legend</span></div></div></div></div>",render:function(){this.model.get("id");this.model.get("title");m(this.el).html(m.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id"));return this},
setText:function(){},titleClick:function(){alert("TITLE CLICK")},remove:function(){m(this.el).remove()}});s.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",
width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},
{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,
label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",
width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},
{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",
width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},
{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,
level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},
{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},
{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,label:"100 billion years"}];s.calculateSecPerPx=function(i){for(var p=1;p<i.length;p++){var r=i[p],G=0;switch(r.unit){case "da":G=86400;break;case "mo":G=2419200;break;case "ye":G=31536E3;break;case "de":G=31536E4;break;case "ce":G=31536E5;break;case "thou":G=31536E6;break;case "tenthou":G=31536E7;
break;case "hundredthou":G=31536E8;break;case "mill":G=31536E9;break;case "tenmill":G=31536E10;break;case "hundredmill":G=31536E11;break;case "bill":G=31536E12}r.spp=G/parseInt(r.width)}}(s.zoomTree);s.getStringWidth=function(i){if(i)return m("#timeglider-measure-span").html(i).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")};if(debug)debug.trace=function(i,p){m("#"+p).text(i)};s.googleMapsInit=function(){debug.log("initializing google maps...")};s.googleMapsLoaded=
false;s.googleMapsLoad=function(){}})(timeglider);(function(s){var Z={},Q=s.TG_Date,B={},T=jQuery;s.TG_Mediator=function(m){this.options=B=m;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=B.max_zoom;this.min_zoom=B.min_zoom;this.timeOffset=Q.getTimeOffset(B.timezone);this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=0;this.filters={include:"",exclude:"",legend:[]};this.timelineCollection=
new s.TG_TimelineCollection;this.eventCollection=new s.TG_EventCollection;this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.initial_timeline_id=B.initial_timeline_id||"";this.focusedEvent=this.sole_timeline_id="";if(B.max_zoom===B.min_zoom)this.fixed_zoom=B.min_zoom;if(B.main_map){this.main_map=B.main_map;timeglider.mapping.setMap(this.main_map,this)}Z=this};s.TG_Mediator.prototype={focusToEvent:function(m){this.focusedEvent=m;this.setFocusDate(m.startdateObj);T.publish("mediator.focusToEvent")},
gotoDateZoom:function(m,K){var L=false;this.setFocusDate(new Q(m));if(K)L=this.setZoomLevel(K);if(!K||L==false)this.refresh()},zoom:function(m){this.setZoomLevel(this.getZoomLevel()+parseInt(m))},loadTimelineData:function(m){var K=this;if(m)if(typeof m==="object")K.parseData(m);else if(m.substr(0,1)=="#"){m=[K.getTableTimelineData(m)];K.parseData(m)}else T.getJSON(m,function(L){K.parseData(L)});else{this.timelineDataLoaded=true;this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},
mapMarkerClick:function(m){this.focusToEvent(m)},getTimelineCollection:function(){return this.timelineCollection},getTableTimelineData:function(m){var K={},L=0,l=[],z,C,i="",p=T(m);K.id=m.substr(1);K.title=p.attr("title")||"untitled";K.description=p.attr("description")||"";K.focus_date=p.attr("focus_date")||Q.getToday;K.initial_zoom=p.attr("initial_zoom")||20;K.events=[];p.find("tr").each(function(r){var G=T(this).children(),F;if(r===0)l=G.map(function(){return T(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,
"$1")}).get();else{F={};G.each(function(R){z=l[R];C=T(this).text();F[z]=C});i="ev_"+L++;F.id=i;K.events.push(F)}});p.css("display","none");return K},parseData:function(m){var K=0,L=m.length,l={};l={};for(var z=0;z<L;z++){l=m[z];l.mediator=this;l=(new s.TG_Timeline(l)).toJSON();if(l.id.length>0){K++;this.swallowTimeline(l)}}if(K===0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var m=this.timelineDataLoaded==true;if(this.imagesSized==
this.imagesToSize&&m){this.setInitialTimelines();T.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(m){this.sole_timeline_id=m.id;this.timelineCollection.add(m);T.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var m=this.initial_timeline_id||this.sole_timeline_id;if(timeglider.mode=="authoring")this.setZoomLevel(40);else m?setTimeout(function(){Z.toggleTimeline(m)},1E3):this.setZoomLevel(40)},refresh:function(){this.startSec=this._focusDate.sec;T.publish("mediator.refreshSignal")},
setTicksReady:function(m){this.ticksReady=m;m===true&&T.publish("mediator.ticksReadySignal")},setTimeoffset:function(m){this.timeOffset=Q.getTimeOffset(m);this.refresh()},getTimeoffset:function(){return this.timeOffset},setFocusDate:function(m){if(m!=this._focusDate)this._focusDate=m},getFocusDate:function(){return this._focusDate},getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(m){if(m<=this.max_zoom&&m>=this.min_zoom){this.startSec=this._focusDate.sec;if(m!=this._zoomLevel){this._zoomLevel=
m;this._zoomInfo=s.zoomTree[m];T.publish("mediator.zoomLevelChange");return true}else return false}else return false},getZoomInfo:function(){return this._zoomInfo},setFilters:function(m){switch(m.origin){case "clude":this.filters.include=m.include;this.filters.exclude=m.exclude;break;case "legend":var K=m.icon;if(K=="all"){this.filters.legend=[];T.publish("mediator.legendAll")}else if(T.inArray(K,this.filters.legend)==-1)this.filters.legend.push(K);else{m=[];m=T.grep(this.filters.legend,function(L){return L!=
K});this.filters.legend=m}}T.publish("mediator.filtersChange");this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(m){this._ticksOffset=m;T.publish("mediator.ticksOffsetChange")},getTickBySerial:function(m){for(var K=this.ticksArray,L=K.length,l=0;l<L;l++){var z=K[l];if(z.serial==m)return z}return false},addToTicksArray:function(m,K){if(m.type=="init"){m.serial=Q.getTimeUnitSerial(K,m.unit);this.ticksArray=[m]}else if(m.type=="l"){m.serial=this.ticksArray[0].serial-
1;this.ticksArray.unshift(m)}else{m.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(m)}T.publish("mediator.ticksArrayChange");return m.serial},toggleTimeline:function(m){this.activeTimelines=[];var K=this.timelineCollection.get(m).attributes,L=T.inArray(m,this.activeTimelines);if(L==-1){this.activeTimelines.push(m);this.setFocusDate(new Q(K.focus_date));this.setZoomLevel(K.initial_zoom)}else this.activeTimelines.splice(L,1);this.refresh();T.publish("mediator.activeTimelinesChange")},
reportImageSize:function(m){var K=Z.eventCollection.get(m.id);if(K.has("image")){if(m.error){K.attributes.image={};debug.log("WHOOPS: MISSING IMAGE: "+m.src)}else{K.attributes.image.width=m.width;K.attributes.image.height=m.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}}};s.getLowHigh=function(m){var K,L,l=parseFloat(m[0]),z=l;for(K=0;K<m.length;K++){L=parseFloat(m[K]);if(L<z)z=L;if(L>l)l=L}return{high:l,low:z}};s.validateOptions=function(m){this.optionsMaster={initial_focus:{type:"date"},
timezone:{type:"timezone"},editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},
display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};var K=this,L="";T.each(m,function(l,z){if(K.optionsMaster[l])switch(K.optionsMaster[l].type){case "string":if(typeof z!="string")L+=l+" needs to be a string.\n";if(K.optionsMaster[l].possible)if(T.inArray(z,K.optionsMaster[l].possible)==-1)L+=l+" must be: "+K.optionsMaster[l].possible.join(" or ");break;case "number":if(typeof z!="number")L+=z+" needs to be a number.\n";if(K.optionsMaster[l].min)if(z<K.optionsMaster[l].min)L+=l+" must be greater than or equal to "+
K.optionsMaster[l].min+"\n";if(K.optionsMaster[l].max)if(z>K.optionsMaster[l].max)L+=l+" must be less than or equal to "+K.optionsMaster[l].max+"\n";break;case "timezone":var C=/[+|-]?[0-9]+:[0-9]+/;if(T.inArray(z,["New York","Denver","Chicago","Los Angeles"])==-1&&z.match(C)==-1)L+="The timezone is not formatted properly";break;case "boolean":if(typeof z!="boolean")L+=z+" needs to be a number.\n"}});return L}})(timeglider);(function(s){var Z,Q,B=timeglider,T=timeglider.TG_Date;s.widget("timeglider.timeline",{options:{timezone:"00:00",initial_focus:B.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"}},_create:function(){this._id=s(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-date-display'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-settings-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var m=timeglider.validateOptions(this.options);if(m==""){B.TG_Date.setCulture(this.options.culture);Q=new B.TG_Mediator(this.options);Z=new B.TG_PlayerView(this,Q);Q.setFocusDate(new T(this.options.initial_focus));Q.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+m)},goTo:function(m,K){Q.gotoDateZoom(m,K)},getMediator:function(){return Q},zoom:function(m){switch(m){case "in":m=-1;break;case "out":m=1}if(m>99||m<-99)return false;
Q.zoom(m)},load:function(m){Q.loadTimelineData(m)},panButton:function(m,K){var L=0;switch(K){case "left":L=30;break;case "right":L=-30;break;default:L=K}Z.setPanButton(m,L)},destroy:function(){s.Widget.prototype.destroy.apply(this,arguments);s(this.element).html("")}})})(jQuery);
