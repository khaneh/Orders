/*

 Underscore.js 1.1.4
 (c) 2011 Jeremy Ashkenas, DocumentCloud Inc.
 Underscore is freely distributable under the MIT license.
 Portions of Underscore are inspired or borrowed from Prototype,
 Oliver Steele's Functional, and John Resig's Micro-Templating.
 For all details and documentation:
 http://documentcloud.github.com/underscore
*/
(function(){var w=this,Z=w._,N={},C=Array.prototype,U=Object.prototype,n=C.slice,E=C.unshift,M=U.toString,x=U.hasOwnProperty,H=C.forEach,h=C.map,k=C.reduce,s=C.reduceRight,G=C.filter,F=C.every,O=C.some,S=C.indexOf,da=C.lastIndexOf;U=Array.isArray;var W=Object.keys,f=function(j){return new u(j)};if(typeof module!=="undefined"&&module.exports){module.exports=f;f._=f}else w._=f;f.VERSION="1.1.4";var z=f.each=f.forEach=function(j,o,y){if(j!=null)if(H&&j.forEach===H)j.forEach(o,y);else if(f.isNumber(j.length))for(var B=
0,P=j.length;B<P;B++){if(o.call(y,j[B],B,j)===N)break}else for(B in j)if(x.call(j,B))if(o.call(y,j[B],B,j)===N)break};f.map=function(j,o,y){var B=[];if(j==null)return B;if(h&&j.map===h)return j.map(o,y);z(j,function(P,R,$){B[B.length]=o.call(y,P,R,$)});return B};f.reduce=f.foldl=f.inject=function(j,o,y,B){var P=y!==void 0;if(j==null)j=[];if(k&&j.reduce===k){if(B)o=f.bind(o,B);return P?j.reduce(o,y):j.reduce(o)}z(j,function(R,$,ka){if(!P&&$===0){y=R;P=true}else y=o.call(B,y,R,$,ka)});if(!P)throw new TypeError("Reduce of empty array with no initial value");
return y};f.reduceRight=f.foldr=function(j,o,y,B){if(j==null)j=[];if(s&&j.reduceRight===s){if(B)o=f.bind(o,B);return y!==void 0?j.reduceRight(o,y):j.reduceRight(o)}j=(f.isArray(j)?j.slice():f.toArray(j)).reverse();return f.reduce(j,o,y,B)};f.find=f.detect=function(j,o,y){var B;J(j,function(P,R,$){if(o.call(y,P,R,$)){B=P;return true}});return B};f.filter=f.select=function(j,o,y){var B=[];if(j==null)return B;if(G&&j.filter===G)return j.filter(o,y);z(j,function(P,R,$){if(o.call(y,P,R,$))B[B.length]=
P});return B};f.reject=function(j,o,y){var B=[];if(j==null)return B;z(j,function(P,R,$){o.call(y,P,R,$)||(B[B.length]=P)});return B};f.every=f.all=function(j,o,y){o=o||f.identity;var B=true;if(j==null)return B;if(F&&j.every===F)return j.every(o,y);z(j,function(P,R,$){if(!(B=B&&o.call(y,P,R,$)))return N});return B};var J=f.some=f.any=function(j,o,y){o=o||f.identity;var B=false;if(j==null)return B;if(O&&j.some===O)return j.some(o,y);z(j,function(P,R,$){if(B=o.call(y,P,R,$))return N});return B};f.include=
f.contains=function(j,o){var y=false;if(j==null)return y;if(S&&j.indexOf===S)return j.indexOf(o)!=-1;J(j,function(B){if(y=B===o)return true});return y};f.invoke=function(j,o){var y=n.call(arguments,2);return f.map(j,function(B){return(o?B[o]:B).apply(B,y)})};f.pluck=function(j,o){return f.map(j,function(y){return y[o]})};f.max=function(j,o,y){if(!o&&f.isArray(j))return Math.max.apply(Math,j);var B={computed:-Infinity};z(j,function(P,R,$){R=o?o.call(y,P,R,$):P;R>=B.computed&&(B={value:P,computed:R})});
return B.value};f.min=function(j,o,y){if(!o&&f.isArray(j))return Math.min.apply(Math,j);var B={computed:Infinity};z(j,function(P,R,$){R=o?o.call(y,P,R,$):P;R<B.computed&&(B={value:P,computed:R})});return B.value};f.sortBy=function(j,o,y){return f.pluck(f.map(j,function(B,P,R){return{value:B,criteria:o.call(y,B,P,R)}}).sort(function(B,P){var R=B.criteria,$=P.criteria;return R<$?-1:R>$?1:0}),"value")};f.sortedIndex=function(j,o,y){y=y||f.identity;for(var B=0,P=j.length;B<P;){var R=B+P>>1;y(j[R])<y(o)?
B=R+1:P=R}return B};f.toArray=function(j){if(!j)return[];if(j.toArray)return j.toArray();if(f.isArray(j))return j;if(f.isArguments(j))return n.call(j);return f.values(j)};f.size=function(j){return f.toArray(j).length};f.first=f.head=function(j,o,y){return o&&!y?n.call(j,0,o):j[0]};f.rest=f.tail=function(j,o,y){return n.call(j,f.isUndefined(o)||y?1:o)};f.last=function(j){return j[j.length-1]};f.compact=function(j){return f.filter(j,function(o){return!!o})};f.flatten=function(j){return f.reduce(j,function(o,
y){if(f.isArray(y))return o.concat(f.flatten(y));o[o.length]=y;return o},[])};f.without=function(j){var o=n.call(arguments,1);return f.filter(j,function(y){return!f.include(o,y)})};f.uniq=f.unique=function(j,o){return f.reduce(j,function(y,B,P){if(0==P||(o===true?f.last(y)!=B:!f.include(y,B)))y[y.length]=B;return y},[])};f.intersect=function(j){var o=n.call(arguments,1);return f.filter(f.uniq(j),function(y){return f.every(o,function(B){return f.indexOf(B,y)>=0})})};f.zip=function(){for(var j=n.call(arguments),
o=f.max(f.pluck(j,"length")),y=Array(o),B=0;B<o;B++)y[B]=f.pluck(j,""+B);return y};f.indexOf=function(j,o,y){if(j==null)return-1;if(y){y=f.sortedIndex(j,o);return j[y]===o?y:-1}if(S&&j.indexOf===S)return j.indexOf(o);y=0;for(var B=j.length;y<B;y++)if(j[y]===o)return y;return-1};f.lastIndexOf=function(j,o){if(j==null)return-1;if(da&&j.lastIndexOf===da)return j.lastIndexOf(o);for(var y=j.length;y--;)if(j[y]===o)return y;return-1};f.range=function(j,o,y){var B=n.call(arguments),P=B.length<=1;j=P?0:B[0];
o=P?B[0]:B[1];y=B[2]||1;B=Math.max(Math.ceil((o-j)/y),0);P=0;for(var R=Array(B);P<B;){R[P++]=j;j+=y}return R};f.bind=function(j,o){var y=n.call(arguments,2);return function(){return j.apply(o||{},y.concat(n.call(arguments)))}};f.bindAll=function(j){var o=n.call(arguments,1);if(o.length==0)o=f.functions(j);z(o,function(y){j[y]=f.bind(j[y],j)});return j};f.memoize=function(j,o){var y={};o=o||f.identity;return function(){var B=o.apply(this,arguments);return B in y?y[B]:y[B]=j.apply(this,arguments)}};
f.delay=function(j,o){var y=n.call(arguments,2);return setTimeout(function(){return j.apply(j,y)},o)};f.defer=function(j){return f.delay.apply(f,[j,1].concat(n.call(arguments,1)))};var v=function(j,o,y){var B;return function(){var P=this,R=arguments,$=function(){B=null;j.apply(P,R)};y&&clearTimeout(B);if(y||!B)B=setTimeout($,o)}};f.throttle=function(j,o){return v(j,o,false)};f.debounce=function(j,o){return v(j,o,true)};f.wrap=function(j,o){return function(){var y=[j].concat(n.call(arguments));return o.apply(this,
y)}};f.compose=function(){var j=n.call(arguments);return function(){for(var o=n.call(arguments),y=j.length-1;y>=0;y--)o=[j[y].apply(this,o)];return o[0]}};f.keys=W||function(j){if(f.isArray(j))return f.range(0,j.length);var o=[],y;for(y in j)if(x.call(j,y))o[o.length]=y;return o};f.values=function(j){return f.map(j,f.identity)};f.functions=f.methods=function(j){return f.filter(f.keys(j),function(o){return f.isFunction(j[o])}).sort()};f.extend=function(j){z(n.call(arguments,1),function(o){for(var y in o)j[y]=
o[y]});return j};f.clone=function(j){return f.isArray(j)?j.slice():f.extend({},j)};f.tap=function(j,o){o(j);return j};f.isEqual=function(j,o){if(j===o)return true;var y=typeof j;if(y!=typeof o)return false;if(j==o)return true;if(!j&&o||j&&!o)return false;if(j._chain)j=j._wrapped;if(o._chain)o=o._wrapped;if(j.isEqual)return j.isEqual(o);if(f.isDate(j)&&f.isDate(o))return j.getTime()===o.getTime();if(f.isNaN(j)&&f.isNaN(o))return false;if(f.isRegExp(j)&&f.isRegExp(o))return j.source===o.source&&j.global===
o.global&&j.ignoreCase===o.ignoreCase&&j.multiline===o.multiline;if(y!=="object")return false;if(j.length&&j.length!==o.length)return false;y=f.keys(j);var B=f.keys(o);if(y.length!=B.length)return false;for(var P in j)if(!(P in o)||!f.isEqual(j[P],o[P]))return false;return true};f.isEmpty=function(j){if(f.isArray(j)||f.isString(j))return j.length===0;for(var o in j)if(x.call(j,o))return false;return true};f.isElement=function(j){return!!(j&&j.nodeType==1)};f.isArray=U||function(j){return M.call(j)===
"[object Array]"};f.isArguments=function(j){return!!(j&&x.call(j,"callee"))};f.isFunction=function(j){return!!(j&&j.constructor&&j.call&&j.apply)};f.isString=function(j){return!!(j===""||j&&j.charCodeAt&&j.substr)};f.isNumber=function(j){return!!(j===0||j&&j.toExponential&&j.toFixed)};f.isNaN=function(j){return j!==j};f.isBoolean=function(j){return j===true||j===false};f.isDate=function(j){return!!(j&&j.getTimezoneOffset&&j.setUTCFullYear)};f.isRegExp=function(j){return!!(j&&j.test&&j.exec&&(j.ignoreCase||
j.ignoreCase===false))};f.isNull=function(j){return j===null};f.isUndefined=function(j){return j===void 0};f.noConflict=function(){w._=Z;return this};f.identity=function(j){return j};f.times=function(j,o,y){for(var B=0;B<j;B++)o.call(y,B)};f.mixin=function(j){z(f.functions(j),function(o){D(o,f[o]=j[o])})};var m=0;f.uniqueId=function(j){var o=m++;return j?j+o:o};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};f.template=function(j,o){var y=f.templateSettings;y="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+
j.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(y.interpolate,function(B,P){return"',"+P.replace(/\\'/g,"'")+",'"}).replace(y.evaluate||null,function(B,P){return"');"+P.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";y=new Function("obj",y);return o?y(o):y};var u=function(j){this._wrapped=j};f.prototype=u.prototype;var A=function(j,o){return o?f(j).chain():j},D=function(j,o){u.prototype[j]=function(){var y=
n.call(arguments);E.call(y,this._wrapped);return A(o.apply(f,y),this._chain)}};f.mixin(f);z(["pop","push","reverse","shift","sort","splice","unshift"],function(j){var o=C[j];u.prototype[j]=function(){o.apply(this._wrapped,arguments);return A(this._wrapped,this._chain)}});z(["concat","join","slice"],function(j){var o=C[j];u.prototype[j]=function(){return A(o.apply(this._wrapped,arguments),this._chain)}});u.prototype.chain=function(){this._chain=true;return this};u.prototype.value=function(){return this._wrapped}})();(function(){var w=this,Z=w.Backbone,N;N=typeof exports!=="undefined"?exports:w.Backbone={};N.VERSION="0.5.1";var C=w._;if(!C&&typeof require!=="undefined")C=require("underscore")._;var U=w.jQuery||w.Zepto;N.noConflict=function(){w.Backbone=Z;return this};N.emulateHTTP=false;N.emulateJSON=false;N.Events={bind:function(f,z){var J=this._callbacks||(this._callbacks={});(J[f]||(J[f]=[])).push(z);return this},unbind:function(f,z){var J;if(f){if(J=this._callbacks)if(z){J=J[f];if(!J)return this;for(var v=
0,m=J.length;v<m;v++)if(z===J[v]){J[v]=null;break}}else J[f]=[]}else this._callbacks={};return this},trigger:function(f){var z,J,v,m,u=2;if(!(J=this._callbacks))return this;for(;u--;)if(z=u?f:"all",z=J[z])for(var A=0,D=z.length;A<D;A++)(v=z[A])?(m=u?Array.prototype.slice.call(arguments,1):arguments,v.apply(this,m)):(z.splice(A,1),A--,D--);return this}};N.Model=function(f,z){var J;f||(f={});if(J=this.defaults){C.isFunction(J)&&(J=J());f=C.extend({},J,f)}this.attributes={};this._escapedAttributes={};
this.cid=C.uniqueId("c");this.set(f,{silent:true});this._changed=false;this._previousAttributes=C.clone(this.attributes);if(z&&z.collection)this.collection=z.collection;this.initialize(f,z)};C.extend(N.Model.prototype,N.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return C.clone(this.attributes)},get:function(f){return this.attributes[f]},escape:function(f){var z;if(z=this._escapedAttributes[f])return z;z=this.attributes[f];return this._escapedAttributes[f]=
(z==null?"":""+z).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27").replace(/\//g,"&#x2F;")},has:function(f){return this.attributes[f]!=null},set:function(f,z){z||(z={});if(!f)return this;if(f.attributes)f=f.attributes;var J=this.attributes,v=this._escapedAttributes;if(!z.silent&&this.validate&&!this._performValidation(f,z))return false;if(this.idAttribute in f)this.id=f[this.idAttribute];var m=this._changing;this._changing=
true;for(var u in f){var A=f[u];if(!C.isEqual(J[u],A)){J[u]=A;delete v[u];this._changed=true;z.silent||this.trigger("change:"+u,this,A,z)}}!m&&!z.silent&&this._changed&&this.change(z);this._changing=false;return this},unset:function(f,z){if(!(f in this.attributes))return this;z||(z={});var J={};J[f]=void 0;if(!z.silent&&this.validate&&!this._performValidation(J,z))return false;delete this.attributes[f];delete this._escapedAttributes[f];f==this.idAttribute&&delete this.id;this._changed=true;z.silent||
(this.trigger("change:"+f,this,void 0,z),this.change(z));return this},clear:function(f){f||(f={});var z,J=this.attributes,v={};for(z in J)v[z]=void 0;if(!f.silent&&this.validate&&!this._performValidation(v,f))return false;this.attributes={};this._escapedAttributes={};this._changed=true;if(!f.silent){for(z in J)this.trigger("change:"+z,this,void 0,f);this.change(f)}return this},fetch:function(f){f||(f={});var z=this,J=f.success;f.success=function(v,m,u){if(!z.set(z.parse(v,u),f))return false;J&&J(z,
v)};f.error=W(f.error,z,f);return(this.sync||N.sync).call(this,"read",this,f)},save:function(f,z){z||(z={});if(f&&!this.set(f,z))return false;var J=this,v=z.success;z.success=function(u,A,D){if(!J.set(J.parse(u,D),z))return false;v&&v(J,u,D)};z.error=W(z.error,J,z);var m=this.isNew()?"create":"update";return(this.sync||N.sync).call(this,m,this,z)},destroy:function(f){f||(f={});if(this.isNew())return this.trigger("destroy",this,this.collection,f);var z=this,J=f.success;f.success=function(v){z.trigger("destroy",
z,z.collection,f);J&&J(z,v)};f.error=W(f.error,z,f);return(this.sync||N.sync).call(this,"delete",this,f)},url:function(){var f=S(this.collection)||this.urlRoot||da();if(this.isNew())return f;return f+(f.charAt(f.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(f){return f},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(f){this.trigger("change",this,f);this._previousAttributes=C.clone(this.attributes);this._changed=false},
hasChanged:function(f){if(f)return this._previousAttributes[f]!=this.attributes[f];return this._changed},changedAttributes:function(f){f||(f=this.attributes);var z=this._previousAttributes,J=false,v;for(v in f)C.isEqual(z[v],f[v])||(J=J||{},J[v]=f[v]);return J},previous:function(f){if(!f||!this._previousAttributes)return null;return this._previousAttributes[f]},previousAttributes:function(){return C.clone(this._previousAttributes)},_performValidation:function(f,z){var J=this.validate(f);if(J)return z.error?
z.error(this,J,z):this.trigger("error",this,J,z),false;return true}});N.Collection=function(f,z){z||(z={});if(z.comparator)this.comparator=z.comparator;C.bindAll(this,"_onModelEvent","_removeReference");this._reset();f&&this.reset(f,{silent:true});this.initialize.apply(this,arguments)};C.extend(N.Collection.prototype,N.Events,{model:N.Model,initialize:function(){},toJSON:function(){return this.map(function(f){return f.toJSON()})},add:function(f,z){if(C.isArray(f))for(var J=0,v=f.length;J<v;J++)this._add(f[J],
z);else this._add(f,z);return this},remove:function(f,z){if(C.isArray(f))for(var J=0,v=f.length;J<v;J++)this._remove(f[J],z);else this._remove(f,z);return this},get:function(f){if(f==null)return null;return this._byId[f.id!=null?f.id:f]},getByCid:function(f){return f&&this._byCid[f.cid||f]},at:function(f){return this.models[f]},sort:function(f){f||(f={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);f.silent||this.trigger("reset",
this,f);return this},pluck:function(f){return C.map(this.models,function(z){return z.get(f)})},reset:function(f,z){f||(f=[]);z||(z={});this.each(this._removeReference);this._reset();this.add(f,{silent:true});z.silent||this.trigger("reset",this,z);return this},fetch:function(f){f||(f={});var z=this,J=f.success;f.success=function(v,m,u){z[f.add?"add":"reset"](z.parse(v,u),f);J&&J(z,v)};f.error=W(f.error,z,f);return(this.sync||N.sync).call(this,"read",this,f)},create:function(f,z){var J=this;z||(z={});
f=this._prepareModel(f,z);if(!f)return false;var v=z.success;z.success=function(m,u,A){J.add(m,z);v&&v(m,u,A)};f.save(null,z);return f},parse:function(f){return f},chain:function(){return C(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(f,z){if(f instanceof N.Model){if(!f.collection)f.collection=this}else{var J=f;f=new this.model(J,{collection:this});f.validate&&!f._performValidation(J,z)&&(f=false)}return f},_add:function(f,
z){z||(z={});f=this._prepareModel(f,z);if(!f)return false;var J=this.getByCid(f)||this.get(f);if(J)throw Error(["Can't add the same model to a set twice",J.id]);this._byId[f.id]=f;this._byCid[f.cid]=f;this.models.splice(z.at!=null?z.at:this.comparator?this.sortedIndex(f,this.comparator):this.length,0,f);f.bind("all",this._onModelEvent);this.length++;z.silent||f.trigger("add",f,this,z);return f},_remove:function(f,z){z||(z={});f=this.getByCid(f)||this.get(f);if(!f)return null;delete this._byId[f.id];
delete this._byCid[f.cid];this.models.splice(this.indexOf(f),1);this.length--;z.silent||f.trigger("remove",f,this,z);this._removeReference(f);return f},_removeReference:function(f){this==f.collection&&delete f.collection;f.unbind("all",this._onModelEvent)},_onModelEvent:function(f,z,J,v){(f=="add"||f=="remove")&&J!=this||(f=="destroy"&&this._remove(z,v),z&&f==="change:"+z.idAttribute&&(delete this._byId[z.previous(z.idAttribute)],this._byId[z.id]=z),this.trigger.apply(this,arguments))}});C.each(["forEach",
"each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"],function(f){N.Collection.prototype[f]=function(){return C[f].apply(C,[this.models].concat(C.toArray(arguments)))}});N.Router=function(f){f||(f={});if(f.routes)this.routes=f.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var n=/:([\w\d]+)/g,
E=/\*([\w\d]+)/g,M=/[-[\]{}()+?.,\\^$|#\s]/g;C.extend(N.Router.prototype,N.Events,{initialize:function(){},route:function(f,z,J){N.history||(N.history=new N.History);C.isRegExp(f)||(f=this._routeToRegExp(f));N.history.route(f,C.bind(function(v){v=this._extractParameters(f,v);J.apply(this,v);this.trigger.apply(this,["route:"+z].concat(v))},this))},navigate:function(f,z){N.history.navigate(f,z)},_bindRoutes:function(){if(this.routes){var f=[],z;for(z in this.routes)f.unshift([z,this.routes[z]]);z=0;
for(var J=f.length;z<J;z++)this.route(f[z][0],f[z][1],this[f[z][1]])}},_routeToRegExp:function(f){f=f.replace(M,"\\$&").replace(n,"([^/]*)").replace(E,"(.*?)");return RegExp("^"+f+"$")},_extractParameters:function(f,z){return f.exec(z).slice(1)}});N.History=function(){this.handlers=[];C.bindAll(this,"checkUrl")};var x=/^#*/,H=/msie [\w.]+/,h=false;C.extend(N.History.prototype,{interval:50,getFragment:function(f,z){if(f==null)if(this._hasPushState||z){f=window.location.pathname;var J=window.location.search;
J&&(f+=J);f.indexOf(this.options.root)==0&&(f=f.substr(this.options.root.length))}else f=window.location.hash;return f.replace(x,"")},start:function(f){if(h)throw Error("Backbone.history has already been started");this.options=C.extend({},{root:"/"},this.options,f);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);f=this.getFragment();var z=document.documentMode;if(z=H.exec(navigator.userAgent.toLowerCase())&&(!z||
z<=7)){this.iframe=U('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(f)}this._hasPushState?U(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!z?U(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=f;h=true;f=window.location;z=f.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!z){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+
"#"+this.fragment)}else if(this._wantsPushState&&this._hasPushState&&z&&f.hash){this.fragment=f.hash.replace(x,"");window.history.replaceState({},document.title,f.protocol+"//"+f.host+this.options.root+this.fragment)}return this.loadUrl()},route:function(f,z){this.handlers.unshift({route:f,callback:z})},checkUrl:function(){var f=this.getFragment();f==this.fragment&&this.iframe&&(f=this.getFragment(this.iframe.location.hash));if(f==this.fragment||f==decodeURIComponent(this.fragment))return false;this.iframe&&
this.navigate(f);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(f){var z=this.fragment=this.getFragment(f);return C.any(this.handlers,function(J){if(J.route.test(z))return J.callback(z),true})},navigate:function(f,z){var J=(f||"").replace(x,"");if(!(this.fragment==J||this.fragment==decodeURIComponent(J))){if(this._hasPushState){var v=window.location;J.indexOf(this.options.root)!=0&&(J=this.options.root+J);this.fragment=J;window.history.pushState({},document.title,v.protocol+
"//"+v.host+J)}else if(window.location.hash=this.fragment=J,this.iframe&&J!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=J}z&&this.loadUrl(f)}}});N.View=function(f){this.cid=C.uniqueId("view");this._configure(f||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var k=/^(\S+)\s*(.*)$/,s=["model","collection","el","id","attributes","className","tagName"];C.extend(N.View.prototype,N.Events,{tagName:"div",
$:function(f){return U(f,this.el)},initialize:function(){},render:function(){return this},remove:function(){U(this.el).remove();return this},make:function(f,z,J){f=document.createElement(f);z&&U(f).attr(z);J&&U(f).html(J);return f},delegateEvents:function(f){if(f||(f=this.events))for(var z in U(this.el).unbind(".delegateEvents"+this.cid),f){var J=this[f[z]];if(!J)throw Error('Event "'+f[z]+'" does not exist');var v=z.match(k),m=v[1];v=v[2];J=C.bind(J,this);m+=".delegateEvents"+this.cid;v===""?U(this.el).bind(m,
J):U(this.el).delegate(v,m,J)}},_configure:function(f){this.options&&(f=C.extend({},this.options,f));for(var z=0,J=s.length;z<J;z++){var v=s[z];f[v]&&(this[v]=f[v])}this.options=f},_ensureElement:function(){if(this.el){if(C.isString(this.el))this.el=U(this.el).get(0)}else{var f=this.attributes||{};if(this.id)f.id=this.id;if(this.className)f["class"]=this.className;this.el=this.make(this.tagName,f)}}});N.Model.extend=N.Collection.extend=N.Router.extend=N.View.extend=function(f,z){var J=O(this,f,z);
J.extend=this.extend;return J};var G={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};N.sync=function(f,z,J){var v=G[f];J=C.extend({type:v,dataType:"json",processData:false},J);if(!J.url)J.url=S(z)||da();if(!J.data&&z&&(f=="create"||f=="update")){J.contentType="application/json";J.data=JSON.stringify(z.toJSON())}if(N.emulateJSON){J.contentType="application/x-www-form-urlencoded";J.processData=true;J.data=J.data?{model:J.data}:{}}if(N.emulateHTTP&&(v==="PUT"||v==="DELETE")){if(N.emulateJSON)J.data._method=
v;J.type="POST";J.beforeSend=function(m){m.setRequestHeader("X-HTTP-Method-Override",v)}}return U.ajax(J)};var F=function(){},O=function(f,z,J){var v;v=z&&z.hasOwnProperty("constructor")?z.constructor:function(){return f.apply(this,arguments)};C.extend(v,f);F.prototype=f.prototype;v.prototype=new F;z&&C.extend(v.prototype,z);J&&C.extend(v,J);v.prototype.constructor=v;v.__super__=f.prototype;return v},S=function(f){if(!f||!f.url)return null;return C.isFunction(f.url)?f.url():f.url},da=function(){throw Error('A "url" property or function must be specified');
},W=function(f,z,J){return function(v){f?f(z,v,J):z.trigger("error",z,v,J)}}}).call(this);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function w(s){if(n&&(E||!C||!C.log))n.apply(Z,s)}for(var Z=this,N=Array.prototype.slice,C=Z.console,U={},n,E,M=9,x=["error","warn","info","debug","log"],H="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),h=H.length,k=[];--h>=0;)(function(s){U[s]=function(){M!==0&&C&&C[s]&&C[s].apply(C,arguments)}})(H[h]);for(h=x.length;--h>=0;)(function(s,G){U[G]=function(){var F=N.call(arguments),O=[G].concat(F);
k.push(O);w(O);if(C&&(M>0?M>s:x.length+M<=s))C.firebug?C[G].apply(Z,F):C[G]?C[G](F):C.log(F)}})(h,x[h]);U.setLevel=function(s){M=typeof s==="number"?s:9};U.setCallback=function(){var s=N.call(arguments),G=k.length,F=G;n=s.shift()||null;E=typeof s[0]==="boolean"?s.shift():false;for(F-=typeof s[0]==="number"?s.shift():G;F<G;)w(k[F++])};return U}();/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(w){function Z(m,u,A,D){D={data:D||D===0||D===false?D:u?u.data:{},_wrap:u?u._wrap:null,tmpl:null,parent:u||null,nodes:[],calls:x,nest:H,wrap:h,html:k,update:s};m&&w.extend(D,m,{nodes:[],parent:u});if(A){D.tmpl=A;D._ctnt=D._ctnt||D.tmpl(w,D);D.key=++z;(v.length?da:S)[z]=D}return D}function N(m,u,A){var D;A=A?w.map(A,function(j){return typeof j==="string"?m.key?j.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+F+'="'+m.key+'" $2'):j:N(j,m,j._ctnt)}):m;if(u)return A;A=A.join("");A.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(j,o,y,B){D=w(y).get();M(D);if(o)D=C(o).concat(D);if(B)D=D.concat(C(B))});return D?D:C(A)}function C(m){var u=document.createElement("div");u.innerHTML=m;return w.makeArray(u.childNodes)}function U(m){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+w.trim(m).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(u,A,D,j,o,y,B){u=w.tmpl.tag[D];if(!u)throw"Unknown template tag: "+D;D=u._default||[];if(y&&!/\w$/.test(o)){o+=y;y=""}if(o){o=E(o);B=B?","+E(B)+")":y?")":"";B=y?o.indexOf(".")>-1?o+E(y):"("+o+").call($item"+B:o;y=y?B:"(typeof("+o+")==='function'?("+o+").call($item):("+o+"))"}else y=B=D.$1||"null";j=E(j);return"');"+u[A?"close":"open"].split("$notnull_1").join(o?"typeof("+o+")!=='undefined' && ("+o+")!=null":"true").split("$1a").join(y).split("$1").join(B).split("$2").join(j||D.$2||"")+"__.push('"})+
"');}return __;")}function n(m,u){m._wrap=N(m,true,w.isArray(u)?u:[O.test(u)?u:w(u).html()]).join("")}function E(m){return m?m.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function M(m){function u(R){function $(ga){ga+=A;fa=o[ga]=o[ga]||Z(fa,S[fa.parent.key+A]||fa.parent)}var ka,aa=R,fa,la;if(la=R.getAttribute(F)){for(;aa.parentNode&&(aa=aa.parentNode).nodeType===1&&!(ka=aa.getAttribute(F)););if(ka!==la){aa=aa.parentNode?aa.nodeType===11?0:aa.getAttribute(F)||0:0;if(!(fa=S[la])){fa=da[la];fa=Z(fa,
S[aa]||da[aa]);fa.key=++z;S[z]=fa}J&&$(la)}R.removeAttribute(F)}else if(J&&(fa=w.data(R,"tmplItem"))){$(fa.key);S[fa.key]=fa;aa=(aa=w.data(R.parentNode,"tmplItem"))?aa.key:0}if(fa){for(ka=fa;ka&&ka.key!=aa;){ka.nodes.push(R);ka=ka.parent}delete fa._ctnt;delete fa._wrap;w.data(R,"tmplItem",fa)}}var A="_"+J,D,j,o={},y,B,P;y=0;for(B=m.length;y<B;y++)if((D=m[y]).nodeType===1){j=D.getElementsByTagName("*");for(P=j.length-1;P>=0;P--)u(j[P]);u(D)}}function x(m,u,A,D){if(!m)return v.pop();v.push({_:m,tmpl:u,
item:this,data:A,options:D})}function H(m,u,A){return w.tmpl(w.template(m),u,A,this)}function h(m,u){var A=m.options||{};A.wrapped=u;return w.tmpl(w.template(m.tmpl),m.data,A,m.item)}function k(m,u){var A=this._wrap;return w.map(w(w.isArray(A)?A.join(""):A).filter(m||"*"),function(D){if(u)D=D.innerText||D.textContent;else{var j;if(!(j=D.outerHTML)){j=document.createElement("div");j.appendChild(D.cloneNode(true));j=j.innerHTML}D=j}return D})}function s(){var m=this.nodes;w.tmpl(null,null,null,this).insertBefore(m[0]);
w(m).remove()}var G=w.fn.domManip,F="_tmplitem",O=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,S={},da={},W,f={key:0,data:{}},z=0,J=0,v=[];w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(m,u){w.fn[m]=function(A){var D=[];A=w(A);var j,o,y;j=this.length===1&&this[0].parentNode;W=S||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&A.length===1){A[u](this[0]);D=this}else{o=0;for(y=A.length;o<y;o++){J=o;j=(o>0?this.clone(true):this).get();
w(A[o])[u](j);D=D.concat(j)}J=0;D=this.pushStack(D,m,A.selector)}A=W;W=null;w.tmpl.complete(A);return D}});w.fn.extend({tmpl:function(m,u,A){return w.tmpl(this[0],m,u,A)},tmplItem:function(){return w.tmplItem(this[0])},template:function(m){return w.template(m,this[0])},domManip:function(m,u,A){if(m[0]&&w.isArray(m[0])){for(var D=w.makeArray(arguments),j=m[0],o=j.length,y=0,B;y<o&&!(B=w.data(j[y++],"tmplItem")););if(B&&J)D[2]=function(P){w.tmpl.afterManip(this,P,A)};G.apply(this,D)}else G.apply(this,
arguments);J=0;W||w.tmpl.complete(S);return this}});w.extend({tmpl:function(m,u,A,D){var j=!D;if(j){D=f;m=w.template[m]||w.template(null,m);da={}}else if(!m){m=D.tmpl;S[D.key]=D;D.nodes=[];D.wrapped&&n(D,D.wrapped);return w(N(D,null,D.tmpl(w,D)))}if(!m)return[];if(typeof u==="function")u=u.call(D||{});A&&A.wrapped&&n(A,A.wrapped);u=w.isArray(u)?w.map(u,function(o){return o?Z(A,D,m,o):null}):[Z(A,D,m,u)];return j?w(N(D,null,u)):u},tmplItem:function(m){var u;if(m instanceof w)m=m[0];for(;m&&m.nodeType===
1&&!(u=w.data(m,"tmplItem"))&&(m=m.parentNode););return u||f},template:function(m,u){if(u){if(typeof u==="string")u=U(u);else if(u instanceof w)u=u[0]||{};if(u.nodeType)u=w.data(u,"tmpl")||w.data(u,"tmpl",U(u.innerHTML));return typeof m==="string"?w.template[m]=u:u}return m?typeof m!=="string"?w.template(null,m):w.template[m]||w.template(null,O.test(m)?m:w(m)):null},encode:function(m){return(""+m).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
w.extend(w.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){S={}},afterManip:function(m,u,A){var D=u.nodeType===11?w.makeArray(u.childNodes):u.nodeType===1?[u]:[];A.call(m,u);M(D);J++}})})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(w){function Z(C){var U=C||window.event,n=[].slice.call(arguments,1),E=0,M=0,x=0;C=w.event.fix(U);C.type="mousewheel";if(C.wheelDelta)E=C.wheelDelta/120;if(C.detail)E=-C.detail/3;x=E;if(U.axis!==undefined&&U.axis===U.HORIZONTAL_AXIS){x=0;M=-1*E}if(U.wheelDeltaY!==undefined)x=U.wheelDeltaY/120;if(U.wheelDeltaX!==undefined)M=-1*U.wheelDeltaX/120;n.unshift(C,E,M,x);return w.event.handle.apply(this,n)}var N=["DOMMouseScroll","mousewheel"];w.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var C=
N.length;C;)this.addEventListener(N[--C],Z,false);else this.onmousewheel=Z},teardown:function(){if(this.removeEventListener)for(var C=N.length;C;)this.removeEventListener(N[--C],Z,false);else this.onmousewheel=null}};w.fn.extend({mousewheel:function(C){return C?this.bind("mousewheel",C):this.trigger("mousewheel")},unmousewheel:function(C){return this.unbind("mousewheel",C)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(w){function Z(){if(x){window.clearTimeout(h);x=false;H=null}}function N(s){if(!x){x=true;H=s.changedTouches[0];h=window.setTimeout(function(){x=false;var G=H,F=document.createEvent("MouseEvent");F.initMouseEvent("mouseup",true,true,window,1,G.screenX,G.screenY,G.clientX,G.clientY,false,false,false,false,0,null);G.target.dispatchEvent(F);F=document.createEvent("MouseEvent");F.initMouseEvent("mousedown",true,true,window,1,G.screenX,G.screenY,G.clientX,G.clientY,false,false,false,false,2,null);
G.target.dispatchEvent(F);F=document.createEvent("MouseEvent");F.initMouseEvent("contextmenu",true,true,window,1,G.screenX+50,G.screenY+5,G.clientX+50,G.clientY+5,false,false,false,false,2,null);G.target.dispatchEvent(F);k=true;H=null},800)}}function C(s){var G=s.changedTouches[0],F="mouseover",O=document.createEvent("MouseEvent");O.initMouseEvent(F,true,true,window,1,G.screenX,G.screenY,G.clientX,G.clientY,false,false,false,false,0,null);G.target.dispatchEvent(O);F="mousedown";O=document.createEvent("MouseEvent");
O.initMouseEvent(F,true,true,window,1,G.screenX,G.screenY,G.clientX,G.clientY,false,false,false,false,0,null);G.target.dispatchEvent(O);if(E){window.clearTimeout(M);if(G.target==n){n=null;E=false;F="click";O=document.createEvent("MouseEvent");O.initMouseEvent(F,true,true,window,1,G.screenX,G.screenY,G.clientX,G.clientY,false,false,false,false,0,null);G.target.dispatchEvent(O);F="dblclick";O=document.createEvent("MouseEvent");O.initMouseEvent(F,true,true,window,1,G.screenX,G.screenY,G.clientX,G.clientY,
false,false,false,false,0,null);G.target.dispatchEvent(O)}else{n=G.target;E=true;M=window.setTimeout(function(){E=false},600);N(s)}}else{n=G.target;E=true;M=window.setTimeout(function(){E=false},600);N(s)}}function U(s){var G="";if(!(s.touches.length>1)){switch(s.type){case "gesturestart":alert("gesturestart");s.preventDefault();break;case "touchstart":if(w(s.changedTouches[0].target).is("select"))return;C(s);s.preventDefault();return false;case "touchmove":Z();G="mousemove";s.preventDefault();break;
case "touchend":if(k){k=false;s.preventDefault();return false}Z();G="mouseup";break;default:return}s=s.changedTouches[0];var F=document.createEvent("MouseEvent");F.initMouseEvent(G,true,true,window,1,s.screenX,s.screenY,s.clientX,s.clientY,false,false,false,false,0,null);s.target.dispatchEvent(F);if(G=="mouseup"&&E&&s.target==n){F=document.createEvent("MouseEvent");F.initMouseEvent("click",true,true,window,1,s.screenX,s.screenY,s.clientX,s.clientY,false,false,false,false,0,null);s.target.dispatchEvent(F)}}}
w.extend(w.support,{touch:typeof Touch=="object"});w.fn.addTouch=function(){w.support.touch&&this.each(function(s,G){G.addEventListener("touchstart",U,false);G.addEventListener("touchmove",U,false);G.addEventListener("touchend",U,false);G.addEventListener("touchcancel",U,false)})};var n=null,E=false,M=null,x=false,H=null,h=null,k=false})(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function w(){if(w.is(arguments[0],R)){for(var a=arguments[0],c=Na[S](w,a.splice(0,3+w.is(a[0],P))),d=c.set(),g=0,i=a[m];g<i;g++){var e=a[g]||{};M[h](e.type)&&d[aa](c[e.type]().attr(e))}return d}return Na[S](w,arguments)}function Z(){for(var a=[],c=0;c<32;c++)a[c]=(~~(A.random()*16))[$](16);a[12]=4;a[16]=(a[16]&3|8)[$](16);return"r-"+a[v]("")}function N(a,c,d){function g(){var i=Array[H].slice.call(arguments,0),e=i[v]("\u25ba"),l=g.cache=g.cache||{},p=g.count=g.count||[];if(l[h](e))return d?
d(l[e]):l[e];p[m]>=1E3&&delete l[p.shift()];p[aa](e);l[e]=a[S](c,i);return d?d(l[e]):l[e]}return g}function C(){return this.x+W+this.y}function U(a){return function(c,d,g,i){var e={back:a};w.is(g,"function")?i=g:e.rot=g;c&&c.constructor==ia&&(c=c.attrs.path);c&&(e.along=c);return this.animate(e,d,i)}}function n(a,c,d,g,i,e){function l(T,ea){var V,Q,Y,ja;Y=T;for(Q=0;Q<8;Q++){ja=((r*Y+q)*Y+p)*Y-T;if(o(ja)<ea)return Y;V=(3*r*Y+2*q)*Y+p;if(o(V)<1.0E-6)break;Y-=ja/V}V=0;Q=1;Y=T;if(Y<V)return V;if(Y>Q)return Q;
for(;V<Q;){ja=((r*Y+q)*Y+p)*Y;if(o(ja-T)<ea)break;T>ja?V=Y:Q=Y;Y=(Q-V)/2+V}return Y}var p=3*c,q=3*(g-c)-p,r=1-p-q,I=3*d,K=3*(i-d)-I,L=1-I-K;return function(T,ea){var V=l(T,ea);return((L*V+K)*V+I)*V}(a,1/(200*e))}w.version="1.5.2";var E=/[, ]+/,M={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},x=/\{(\d+)\}/g,H="prototype",h="hasOwnProperty",k=document,s=window,G={was:Object[H][h].call(s,"Raphael"),is:s.Raphael},F=function(){this.customAttributes={}},O,S="apply",da="createTouch"in k,W=" ",f=String,
z="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(W),J={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},v="join",m="length",u=f[H].toLowerCase,A=Math,D=A.max,j=A.min,o=A.abs,y=A.pow,B=A.PI,P="number",R="array",$="toString",ka=Object[H][$],aa="push",fa=/^url\(['"]?([^\)]+?)['"]?\)$/i,la=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ga={NaN:1,Infinity:1,"-Infinity":1},ra=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ba=A.round,X=parseFloat,na=parseInt,wa=f[H].toUpperCase,Ea={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Oa={along:"along",blur:P,"clip-rect":"csv",cx:P,cy:P,fill:"colour","fill-opacity":P,"font-size":P,height:P,opacity:P,path:"path",r:P,rotation:"csv",rx:P,ry:P,scale:"csv",stroke:"colour","stroke-opacity":P,"stroke-width":P,translation:"csv",width:P,x:P,y:P},ub=/^(from|to|\d+%?)$/,Pa=/\s*,\s*/,vb={hs:1,rg:1},wb=/,?([achlmqrstvxz]),?/gi,
xb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,yb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Za=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,zb=function(a,c){return a.key-c.key};w.type=s.SVGAngle||k.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(w.type=="VML"){var ta=k.createElement("div");ta.innerHTML='<v:shape adj="1"/>';ta=ta.firstChild;ta.style.behavior="url(#default#VML)";if(!(ta&&typeof ta.adj=="object"))return w.type=null;ta=null}w.svg=
!(w.vml=w.type=="VML");F[H]=w[H];O=F[H];w._id=0;w._oid=0;w.fn={};w.is=function(a,c){c=u.call(c);if(c=="finite")return!ga[h](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||ka.call(a).slice(8,-1).toLowerCase()==c};w.angle=function(a,c,d,g,i,e){if(i==null){a-=d;c-=g;if(!a&&!c)return 0;return((a<0)*180+A.atan(-c/-a)*180/B+360)%360}return w.angle(a,c,i,e)-w.angle(d,g,i,e)};w.rad=function(a){return a%360*B/180};w.deg=function(a){return a*
180/B%360};w.snapTo=function(a,c,d){d=w.is(d,"finite")?d:10;if(w.is(a,R))for(var g=a.length;g--;){if(o(a[g]-c)<=d)return a[g]}else{a=+a;g=c%a;if(g<d)return c-g;if(g>a-d)return c-g+a}return c};w.setWindow=function(a){s=a;k=s.document};var Fa=function(a){if(w.vml){var c=/^\s+|\s+$/g,d;try{var g=new ActiveXObject("htmlfile");g.write("<body>");g.close();d=g.body}catch(i){d=createPopup().document.body}var e=d.createTextRange();Fa=N(function(p){try{d.style.color=f(p).replace(c,"");var q=e.queryCommandValue("ForeColor");
return"#"+("000000"+((q&255)<<16|q&65280|(q&16711680)>>>16)[$](16)).slice(-6)}catch(r){return"none"}})}else{var l=k.createElement("i");l.title="Rapha\u00ebl Colour Picker";l.style.display="none";k.body.appendChild(l);Fa=N(function(p){l.style.color=p;return k.defaultView.getComputedStyle(l,"").getPropertyValue("color")})}return Fa(a)},$a=function(){return"hsb("+[this.h,this.s,this.b]+")"},Ab=function(){return"hsl("+[this.h,this.s,this.l]+")"},Bb=function(){return this.hex};w.hsb2rgb=function(a,c,d,
g){if(w.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){d=a.b;c=a.s;a=a.h;g=a.o}return w.hsl2rgb(a,c,d/2,g)};w.hsl2rgb=function(a,c,d,g){if(w.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){d=a.l;c=a.s;a=a.h}if(a>1||c>1||d>1){a/=360;c/=100;d/=100}var i={},e=["r","g","b"],l;if(c){d<0.5?l=d*(1+c):l=d+c-d*c;c=2*d-l;for(var p=0;p<3;p++){d=a+1/3*-(p-1);d<0&&d++;d>1&&d--;d*6<1?i[e[p]]=c+(l-c)*6*d:d*2<1?i[e[p]]=l:d*3<2?i[e[p]]=c+(l-c)*(2/3-d)*6:i[e[p]]=c}}else i={r:d,g:d,b:d};i.r*=255;i.g*=255;i.b*=255;i.hex="#"+
(16777216|i.b|i.g<<8|i.r<<16).toString(16).slice(1);w.is(g,"finite")&&(i.opacity=g);i.toString=Bb;return i};w.rgb2hsb=function(a,c,d){if(c==null&&w.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&w.is(a,"string")){d=w.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var g=D(a,c,d),i=j(a,c,d),e;if(i==g)return{h:0,s:0,b:g,toString:$a};i=g-i;a==g?e=(c-d)/i:c==g?e=2+(d-a)/i:e=4+(a-c)/i;e/=6;e<0&&e++;e>1&&e--;return{h:e,s:i/g,b:g,toString:$a}};w.rgb2hsl=function(a,
c,d){if(c==null&&w.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&w.is(a,"string")){d=w.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var g=D(a,c,d),i=j(a,c,d),e,l=(g+i)/2;if(i==g)a={h:0,s:0,l:l};else{var p=g-i;a==g?e=(c-d)/p:c==g?e=2+(d-a)/p:e=4+(a-c)/p;e/=6;e<0&&e++;e>1&&e--;a={h:e,s:l<0.5?p/(g+i):p/(2-g-i),l:l}}a.toString=Ab;return a};w._path2string=function(){return this.join(",").replace(wb,"$1")};w.getRGB=N(function(a){if(!a||(a=f(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(vb[h](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Fa(a));var c,d,g,i,e;if(a=a.match(la)){if(a[2]){g=na(a[2].substring(5),16);d=na(a[2].substring(3,5),16);c=na(a[2].substring(1,3),16)}if(a[3]){g=na((e=a[3].charAt(3))+e,16);d=na((e=a[3].charAt(2))+e,16);c=na((e=a[3].charAt(1))+e,16)}if(a[4]){e=a[4].split(Pa);c=X(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=X(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);g=X(e[2]);
e[2].slice(-1)=="%"&&(g*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(i=X(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100)}if(a[5]){e=a[5].split(Pa);c=X(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=X(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);g=X(e[2]);e[2].slice(-1)=="%"&&(g*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(i=X(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100);return w.hsb2rgb(c,d,g,i)}if(a[6]){e=a[6].split(Pa);c=X(e[0]);e[0].slice(-1)=="%"&&(c*=
2.55);d=X(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);g=X(e[2]);e[2].slice(-1)=="%"&&(g*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(i=X(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100);return w.hsl2rgb(c,d,g,i)}a={r:c,g:d,b:g};a.hex="#"+(16777216|g|d<<8|c<<16).toString(16).slice(1);w.is(i,"finite")&&(a.opacity=i);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},w);w.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};
var c=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return c.hex};w.getColor.reset=function(){delete this.start};w.parsePathString=N(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];w.is(a,R)&&w.is(a[0],R)&&(d=Ga(a));d[m]||f(a).replace(xb,function(g,i,e){var l=[];g=u.call(i);e.replace(yb,function(p,q){q&&l[aa](+q)});if(g=="m"&&l[m]>2){d[aa]([i].concat(l.splice(0,2)));g="l";i=i=="m"?"l":"L"}for(;l[m]>=c[g];){d[aa]([i].concat(l.splice(0,
c[g])));if(!c[g])break}});d[$]=w._path2string;return d});w.findDotsAtSegment=function(a,c,d,g,i,e,l,p,q){var r=1-q,I=y(r,3)*a+y(r,2)*3*q*d+r*3*q*q*i+y(q,3)*l;r=y(r,3)*c+y(r,2)*3*q*g+r*3*q*q*e+y(q,3)*p;var K=a+2*q*(d-a)+q*q*(i-2*d+a),L=c+2*q*(g-c)+q*q*(e-2*g+c),T=d+2*q*(i-d)+q*q*(l-2*i+d),ea=g+2*q*(e-g)+q*q*(p-2*e+g);a=(1-q)*a+q*d;c=(1-q)*c+q*g;i=(1-q)*i+q*l;e=(1-q)*e+q*p;p=90-A.atan((K-T)/(L-ea))*180/B;(K>T||L<ea)&&(p+=180);return{x:I,y:r,m:{x:K,y:L},n:{x:T,y:ea},start:{x:a,y:c},end:{x:i,y:e},alpha:p}};
var Ia=N(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ha(a);for(var c=0,d=0,g=[],i=[],e,l=0,p=a[m];l<p;l++){e=a[l];if(e[0]=="M"){c=e[1];d=e[2];g[aa](c);i[aa](d)}else{c=Cb(c,d,e[1],e[2],e[3],e[4],e[5],e[6]);g=g.concat(c.min.x,c.max.x);i=i.concat(c.min.y,c.max.y);c=e[5];d=e[6]}}a=j[S](0,g);e=j[S](0,i);return{x:a,y:e,width:D[S](0,g)-a,height:D[S](0,i)-e}}),Ga=function(a){var c=[];if(!w.is(a,R)||!w.is(a&&a[0],R))a=w.parsePathString(a);for(var d=0,g=a[m];d<g;d++){c[d]=[];for(var i=0,e=a[d][m];i<
e;i++)c[d][i]=a[d][i]}c[$]=w._path2string;return c},Qa=N(function(a){if(!w.is(a,R)||!w.is(a&&a[0],R))a=w.parsePathString(a);var c=[],d=0,g=0,i=0,e=0,l=0;if(a[0][0]=="M"){d=a[0][1];g=a[0][2];i=d;e=g;l++;c[aa](["M",d,g])}for(var p=a[m];l<p;l++){var q=c[l]=[],r=a[l];if(r[0]!=u.call(r[0])){q[0]=u.call(r[0]);switch(q[0]){case "a":q[1]=r[1];q[2]=r[2];q[3]=r[3];q[4]=r[4];q[5]=r[5];q[6]=+(r[6]-d).toFixed(3);q[7]=+(r[7]-g).toFixed(3);break;case "v":q[1]=+(r[1]-g).toFixed(3);break;case "m":i=r[1];e=r[2];default:for(var I=
1,K=r[m];I<K;I++)q[I]=+(r[I]-(I%2?d:g)).toFixed(3)}}else{c[l]=[];if(r[0]=="m"){i=r[1]+d;e=r[2]+g}q=0;for(I=r[m];q<I;q++)c[l][q]=r[q]}r=c[l][m];switch(c[l][0]){case "z":d=i;g=e;break;case "h":d+=+c[l][r-1];break;case "v":g+=+c[l][r-1];break;default:d+=+c[l][r-2];g+=+c[l][r-1]}}c[$]=w._path2string;return c},0,Ga),Aa=N(function(a){if(!w.is(a,R)||!w.is(a&&a[0],R))a=w.parsePathString(a);var c=[],d=0,g=0,i=0,e=0,l=0;if(a[0][0]=="M"){d=+a[0][1];g=+a[0][2];i=d;e=g;l++;c[0]=["M",d,g]}for(var p=a[m];l<p;l++){var q=
c[l]=[],r=a[l];if(r[0]!=wa.call(r[0])){q[0]=wa.call(r[0]);switch(q[0]){case "A":q[1]=r[1];q[2]=r[2];q[3]=r[3];q[4]=r[4];q[5]=r[5];q[6]=+(r[6]+d);q[7]=+(r[7]+g);break;case "V":q[1]=+r[1]+g;break;case "H":q[1]=+r[1]+d;break;case "M":i=+r[1]+d;e=+r[2]+g;default:for(var I=1,K=r[m];I<K;I++)q[I]=+r[I]+(I%2?d:g)}}else{I=0;for(K=r[m];I<K;I++)c[l][I]=r[I]}switch(q[0]){case "Z":d=i;g=e;break;case "H":d=q[1];break;case "V":g=q[1];break;case "M":i=c[l][c[l][m]-2];e=c[l][c[l][m]-1];default:d=c[l][c[l][m]-2];g=
c[l][c[l][m]-1]}}c[$]=w._path2string;return c},null,Ga),ab=function(a,c,d,g,i,e){var l=1/3,p=2/3;return[l*a+p*d,l*c+p*g,l*i+p*d,l*e+p*g,i,e]},bb=function(a,c,d,g,i,e,l,p,q,r){var I=B*120/180,K=B/180*(+i||0),L=[],T,ea=N(function(oa,pa,ma){var ya=oa*A.cos(ma)-pa*A.sin(ma);oa=oa*A.sin(ma)+pa*A.cos(ma);return{x:ya,y:oa}});if(r){Y=r[0];T=r[1];e=r[2];Q=r[3]}else{T=ea(a,c,-K);a=T.x;c=T.y;T=ea(p,q,-K);p=T.x;q=T.y;A.cos(B/180*i);A.sin(B/180*i);T=(a-p)/2;Y=(c-q)/2;Q=T*T/(d*d)+Y*Y/(g*g);if(Q>1){Q=A.sqrt(Q);
d*=Q;g*=Q}Q=d*d;var V=g*g;Q=(e==l?-1:1)*A.sqrt(o((Q*V-Q*Y*Y-V*T*T)/(Q*Y*Y+V*T*T)));e=Q*d*Y/g+(a+p)/2;var Q=Q*-g*T/d+(c+q)/2,Y=A.asin(((c-Q)/g).toFixed(9));T=A.asin(((q-Q)/g).toFixed(9));Y=a<e?B-Y:Y;T=p<e?B-T:T;Y<0&&(Y=B*2+Y);T<0&&(T=B*2+T);l&&Y>T&&(Y-=B*2);!l&&T>Y&&(T-=B*2)}if(o(T-Y)>I){L=T;V=p;var ja=q;T=Y+I*(l&&T>Y?1:-1);p=e+d*A.cos(T);q=Q+g*A.sin(T);L=bb(p,q,d,g,i,0,l,V,ja,[T,L,e,Q])}e=T-Y;i=A.cos(Y);I=A.sin(Y);l=A.cos(T);T=A.sin(T);e=A.tan(e/4);d=4/3*d*e;e*=4/3*g;g=[a,c];a=[a+d*I,c-e*i];c=[p+
d*T,q-e*l];p=[p,q];a[0]=2*g[0]-a[0];a[1]=2*g[1]-a[1];if(r)return[a,c,p].concat(L);L=[a,c,p].concat(L)[v]().split(",");r=[];p=0;for(q=L[m];p<q;p++)r[p]=p%2?ea(L[p-1],L[p],K).y:ea(L[p],L[p+1],K).x;return r},Ja=function(a,c,d,g,i,e,l,p,q){var r=1-q;return{x:y(r,3)*a+y(r,2)*3*q*d+r*3*q*q*i+y(q,3)*l,y:y(r,3)*c+y(r,2)*3*q*g+r*3*q*q*e+y(q,3)*p}},Cb=N(function(a,c,d,g,i,e,l,p){var q=i-2*d+a-(l-2*i+d),r=2*(d-a)-2*(i-d),I=a-d,K=(-r+A.sqrt(r*r-4*q*I))/2/q;q=(-r-A.sqrt(r*r-4*q*I))/2/q;var L=[c,p],T=[a,l];o(K)>
"1e12"&&(K=0.5);o(q)>"1e12"&&(q=0.5);if(K>0&&K<1){K=Ja(a,c,d,g,i,e,l,p,K);T[aa](K.x);L[aa](K.y)}if(q>0&&q<1){K=Ja(a,c,d,g,i,e,l,p,q);T[aa](K.x);L[aa](K.y)}q=e-2*g+c-(p-2*e+g);r=2*(g-c)-2*(e-g);I=c-g;K=(-r+A.sqrt(r*r-4*q*I))/2/q;q=(-r-A.sqrt(r*r-4*q*I))/2/q;o(K)>"1e12"&&(K=0.5);o(q)>"1e12"&&(q=0.5);if(K>0&&K<1){K=Ja(a,c,d,g,i,e,l,p,K);T[aa](K.x);L[aa](K.y)}if(q>0&&q<1){K=Ja(a,c,d,g,i,e,l,p,q);T[aa](K.x);L[aa](K.y)}return{min:{x:j[S](0,T),y:j[S](0,L)},max:{x:D[S](0,T),y:D[S](0,L)}}}),Ha=N(function(a,
c){var d=Aa(a),g=c&&Aa(c),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l=function(V,Q){var Y,ja;if(!V)return["C",Q.x,Q.y,Q.x,Q.y,Q.x,Q.y];!(V[0]in{T:1,Q:1})&&(Q.qx=Q.qy=null);switch(V[0]){case "M":Q.X=V[1];Q.Y=V[2];break;case "A":V=["C"].concat(bb[S](0,[Q.x,Q.y].concat(V.slice(1))));break;case "S":Y=Q.x+(Q.x-(Q.bx||Q.x));ja=Q.y+(Q.y-(Q.by||Q.y));V=["C",Y,ja].concat(V.slice(1));break;case "T":Q.qx=Q.x+(Q.x-(Q.qx||Q.x));Q.qy=Q.y+(Q.y-(Q.qy||Q.y));V=["C"].concat(ab(Q.x,
Q.y,Q.qx,Q.qy,V[1],V[2]));break;case "Q":Q.qx=V[1];Q.qy=V[2];V=["C"].concat(ab(Q.x,Q.y,V[1],V[2],V[3],V[4]));break;case "L":V=["C"].concat([Q.x,Q.y,V[1],V[2],V[1],V[2]]);break;case "H":V=["C"].concat([Q.x,Q.y,V[1],Q.y,V[1],Q.y]);break;case "V":V=["C"].concat([Q.x,Q.y,Q.x,V[1],Q.x,V[1]]);break;case "Z":V=["C"].concat([Q.x,Q.y,Q.X,Q.Y,Q.X,Q.Y])}return V},p=function(V,Q){if(V[Q][m]>7){V[Q].shift();for(var Y=V[Q];Y[m];)V.splice(Q++,0,["C"].concat(Y.splice(0,6)));V.splice(Q,1);I=D(d[m],g&&g[m]||0)}},q=
function(V,Q,Y,ja,oa){if(V&&Q&&V[oa][0]=="M"&&Q[oa][0]!="M"){Q.splice(oa,0,["M",ja.x,ja.y]);Y.bx=0;Y.by=0;Y.x=V[oa][1];Y.y=V[oa][2];I=D(d[m],g&&g[m]||0)}},r=0,I=D(d[m],g&&g[m]||0);for(;r<I;r++){d[r]=l(d[r],i);p(d,r);g&&(g[r]=l(g[r],e));g&&p(g,r);q(d,g,i,e,r);q(g,d,e,i,r);var K=d[r],L=g&&g[r],T=K[m],ea=g&&L[m];i.x=K[T-2];i.y=K[T-1];i.bx=X(K[T-4])||i.x;i.by=X(K[T-3])||i.y;e.bx=g&&(X(L[ea-4])||e.x);e.by=g&&(X(L[ea-3])||e.y);e.x=g&&L[ea-2];e.y=g&&L[ea-1]}return g?[d,g]:d},null,Ga),cb=N(function(a){for(var c=
[],d=0,g=a[m];d<g;d++){var i={},e=a[d].match(/^([^:]*):?([\d\.]*)/);i.color=w.getRGB(e[1]);if(i.color.error)return null;i.color=i.color.hex;e[2]&&(i.offset=e[2]+"%");c[aa](i)}d=1;for(g=c[m]-1;d<g;d++)if(!c[d].offset){a=X(c[d-1].offset||0);e=0;for(i=d+1;i<g;i++)if(c[i].offset){e=c[i].offset;break}if(!e){e=100;i=g}e=X(e);for(e=(e-a)/(i-d+1);d<i;d++){a+=e;c[d].offset=a+"%"}}return c}),db=function(a,c,d,g){if(w.is(a,"string")||w.is(a,"object")){a=w.is(a,"string")?k.getElementById(a):a;if(a.tagName)return c==
null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:g}},Ra=function(a,c){var d=this,g;for(g in c)if(c[h](g)&&!(g in a))switch(typeof c[g]){case "function":(function(i){a[g]=a===d?i:function(){return i[S](d,arguments)}})(c[g]);break;case "object":a[g]=a[g]||{};Ra.call(this,a[g],c[g]);break;default:a[g]=c[g]}},za=function(a,c){a==c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=
a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},eb=function(a,c){if(c.top!==a){za(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a}},fb=function(a,c){if(c.bottom!==a){za(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a}},gb=function(a,c,d){za(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},hb=function(a,c,d){za(a,d);c==d.bottom&&(d.bottom=a);c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;a.next=c},ib=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+
a+"\u201d of removed object");}};w.pathToRelative=Qa;if(w.svg){O.svgns="http://www.w3.org/2000/svg";O.xlink="http://www.w3.org/1999/xlink";ba=function(a){return+a+(~~a===a)*0.5};var ca=function(a,c){if(c)for(var d in c)c[h](d)&&a.setAttribute(d,f(c[d]));else{a=k.createElementNS(O.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};w[$]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var jb=function(a,c){var d=ca("path");c.canvas&&c.canvas.appendChild(d);
d=new ia(d,c);d.type="path";xa(d,{fill:"none",stroke:"#000",path:a});return d},Ba=function(a,c,d){var g="linear",i=0.5,e=0.5,l=a.style;c=f(c).replace(Za,function(I,K,L){g="radial";if(K&&L){i=X(K);e=X(L);I=(e>0.5)*2-1;y(i-0.5,2)+y(e-0.5,2)>0.25&&(e=A.sqrt(0.25-y(i-0.5,2))*I+0.5)&&e!=0.5&&(e=e.toFixed(5)-1.0E-5*I)}return""});c=c.split(/\s*\-\s*/);if(g=="linear"){var p=c.shift();p=-X(p);if(isNaN(p))return null;p=[0,0,A.cos(p*B/180),A.sin(p*B/180)];var q=1/(D(o(p[2]),o(p[3]))||1);p[2]*=q;p[3]*=q;if(p[2]<
0){p[0]=-p[2];p[2]=0}if(p[3]<0){p[1]=-p[3];p[3]=0}}c=cb(c);if(!c)return null;q=a.getAttribute("fill");(q=q.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(k.getElementById(q[1]));q=ca(g+"Gradient");q.id=Z();ca(q,g=="radial"?{fx:i,fy:e}:{x1:p[0],y1:p[1],x2:p[2],y2:p[3]});d.defs.appendChild(q);d=0;for(p=c[m];d<p;d++){var r=ca("stop");ca(r,{offset:c[d].offset?c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});q.appendChild(r)}ca(a,{fill:"url(#"+q.id+")",opacity:1,"fill-opacity":1});l.fill="";l.opacity=
1;return l.fillOpacity=1},Sa=function(a){var c=a.getBBox();ca(a.pattern,{patternTransform:w.format("translate({0},{1})",c.x,c.y)})},xa=function(a,c){var d={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},g=a.node,i=a.attrs,e=a.rotate(),l=function(ea,V){if(V=d[u.call(V)]){for(var Q=ea.attrs["stroke-width"]||"1",Y={round:Q,square:Q,butt:0}[ea.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,
ja=[],oa=V[m];oa--;)ja[oa]=V[oa]*Q+(oa%2?1:-1)*Y;ca(g,{"stroke-dasharray":ja[v](",")})}};c[h]("rotation")&&(e=c.rotation);var p=f(e).split(E);if(p.length-1){p[1]=+p[1];p[2]=+p[2]}else p=null;X(e)&&a.rotate(0,true);for(var q in c)if(c[h](q))if(Ea[h](q)){var r=c[q];i[q]=r;switch(q){case "blur":a.blur(r);break;case "rotation":a.rotate(r,true);break;case "href":case "title":case "target":var I=g.parentNode;if(u.call(I.tagName)!="a"){var K=ca("a");I.insertBefore(K,g);K.appendChild(g);I=K}q=="target"&&
r=="blank"?I.setAttributeNS(a.paper.xlink,"show","new"):I.setAttributeNS(a.paper.xlink,q,r);break;case "cursor":g.style.cursor=r;break;case "clip-rect":I=f(r).split(E);if(I[m]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var L=ca("clipPath");K=ca("rect");L.id=Z();ca(K,{x:I[0],y:I[1],width:I[2],height:I[3]});L.appendChild(K);a.paper.defs.appendChild(L);ca(g,{"clip-path":"url(#"+L.id+")"});a.clip=K}if(!r){(r=k.getElementById(g.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,
"")))&&r.parentNode.removeChild(r);ca(g,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&ca(g,{d:r?i.path=Aa(r):"M0,0"});break;case "width":g.setAttribute(q,r);if(i.fx){q="x";r=i.x}else break;case "x":i.fx&&(r=-i.x-(i.width||0));case "rx":if(q=="rx"&&a.type=="rect")break;case "cx":p&&(q=="x"||q=="cx")&&(p[1]+=r-i[q]);g.setAttribute(q,r);a.pattern&&Sa(a);break;case "height":g.setAttribute(q,r);if(i.fy){q="y";r=i.y}else break;case "y":i.fy&&(r=-i.y-(i.height||0));case "ry":if(q=="ry"&&
a.type=="rect")break;case "cy":p&&(q=="y"||q=="cy")&&(p[2]+=r-i[q]);g.setAttribute(q,r);a.pattern&&Sa(a);break;case "r":a.type=="rect"?ca(g,{rx:r,ry:r}):g.setAttribute(q,r);break;case "src":a.type=="image"&&g.setAttributeNS(a.paper.xlink,"href",r);break;case "stroke-width":g.style.strokeWidth=r;g.setAttribute(q,r);i["stroke-dasharray"]&&l(a,i["stroke-dasharray"]);break;case "stroke-dasharray":l(a,r);break;case "translation":r=f(r).split(E);r[0]=+r[0]||0;r[1]=+r[1]||0;if(p){p[1]+=r[0];p[2]+=r[1]}Ka.call(a,
r[0],r[1]);break;case "scale":r=f(r).split(E);a.scale(+r[0]||1,+r[1]||+r[0]||1,isNaN(X(r[2]))?null:+r[2],isNaN(X(r[3]))?null:+r[3]);break;case "fill":if(I=f(r).match(fa)){L=ca("pattern");var T=ca("image");L.id=Z();ca(L,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});ca(T,{x:0,y:0});T.setAttributeNS(a.paper.xlink,"href",I[1]);L.appendChild(T);r=k.createElement("img");r.style.cssText="position:absolute;left:-9999em;top-9999em";r.onload=function(){ca(L,{width:this.offsetWidth,height:this.offsetHeight});
ca(T,{width:this.offsetWidth,height:this.offsetHeight});k.body.removeChild(this);a.paper.safari()};k.body.appendChild(r);r.src=I[1];a.paper.defs.appendChild(L);g.style.fill="url(#"+L.id+")";ca(g,{fill:"url(#"+L.id+")"});a.pattern=L;a.pattern&&Sa(a);break}I=w.getRGB(r);if(I.error)if(({circle:1,ellipse:1}[h](a.type)||f(r).charAt()!="r")&&Ba(g,r,a.paper)){i.gradient=r;i.fill="none";break}else{delete c.gradient;delete i.gradient;!w.is(i.opacity,"undefined")&&w.is(c.opacity,"undefined")&&ca(g,{opacity:i.opacity});
!w.is(i["fill-opacity"],"undefined")&&w.is(c["fill-opacity"],"undefined")&&ca(g,{"fill-opacity":i["fill-opacity"]})}I[h]("opacity")&&ca(g,{"fill-opacity":I.opacity>1?I.opacity/100:I.opacity});case "stroke":I=w.getRGB(r);g.setAttribute(q,I.hex);q=="stroke"&&I[h]("opacity")&&ca(g,{"stroke-opacity":I.opacity>1?I.opacity/100:I.opacity});break;case "gradient":(({circle:1,ellipse:1})[h](a.type)||f(r).charAt()!="r")&&Ba(g,r,a.paper);break;case "opacity":i.gradient&&!i[h]("stroke-opacity")&&ca(g,{"stroke-opacity":r>
1?r/100:r});case "fill-opacity":if(i.gradient){if(I=k.getElementById(g.getAttribute("fill").replace(/^url\(#|\)$/g,""))){I=I.getElementsByTagName("stop");I[I[m]-1].setAttribute("stop-opacity",r)}break}default:q=="font-size"&&(r=na(r,10)+"px");I=q.replace(/(\-.)/g,function(ea){return wa.call(ea.substring(1))});g.style[I]=r;g.setAttribute(q,r)}}Db(a,c);p?a.rotate(p.join(W)):X(e)&&a.rotate(e,true)},Db=function(a,c){if(!(a.type!="text"||!(c[h]("text")||c[h]("font")||c[h]("font-size")||c[h]("x")||c[h]("y")))){var d=
a.attrs,g=a.node,i=g.firstChild?na(k.defaultView.getComputedStyle(g.firstChild,"").getPropertyValue("font-size"),10):10;if(c[h]("text")){for(d.text=c.text;g.firstChild;)g.removeChild(g.firstChild);for(var e=f(c.text).split("\n"),l=0,p=e[m];l<p;l++)if(e[l]){var q=ca("tspan");l&&ca(q,{dy:i*1.2,x:d.x});q.appendChild(k.createTextNode(e[l]));g.appendChild(q)}}else{e=g.getElementsByTagName("tspan");l=0;for(p=e[m];l<p;l++)l&&ca(e[l],{dy:i*1.2,x:d.x})}ca(g,{y:d.y});i=a.getBBox();(i=d.y-(i.y+i.height/2))&&
w.is(i,"finite")&&ca(g,{y:d.y+i})}},ia=function(a,c){this[0]=a;this.id=w._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},ha=ia[H];ia[H].rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][v](W);return this._.rt.deg}var g=this.getBBox();
a=f(a).split(E);if(a[m]-1){c=X(a[1]);d=X(a[2])}a=X(a[0]);c!=null&&c!==false?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;c=c==null?g.x+g.width/2:c;d=d==null?g.y+g.height/2:d;if(this._.rt.deg){this.transformations[0]=w.format("rotate({0} {1} {2})",this._.rt.deg,c,d);this.clip&&ca(this.clip,{transform:w.format("rotate({0} {1} {2})",-this._.rt.deg,c,d)})}else{this.transformations[0]="";this.clip&&ca(this.clip,{transform:""})}ca(this.node,{transform:this.transformations[v](W)});
return this};ia[H].hide=function(){!this.removed&&(this.node.style.display="none");return this};ia[H].show=function(){!this.removed&&(this.node.style.display="");return this};ia[H].remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ia[H].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Ia(this.attrs.path);if(this.node.style.display=="none"){this.show();var a=true}var c={};
try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if(this.type=="text"){c={x:c.x,y:Infinity,width:0,height:0};for(var g=0,i=this.node.getNumberOfChars();g<i;g++){var e=this.node.getExtentOfChar(g);e.y<c.y&&(c.y=e.y);e.y+e.height-c.y>c.height&&(c.height=e.y+e.height-c.y);e.x+e.width-c.x>c.width&&(c.width=e.x+e.width-c.x)}}a&&this.hide();return c};ia[H].attr=function(a,c){if(this.removed)return this;if(a==null){var d={},g;for(g in this.attrs)this.attrs[h](g)&&(d[g]=this.attrs[g]);this._.rt.deg&&(d.rotation=
this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&w.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(c==null&&w.is(a,R)){g={};d=0;for(var i=a.length;d<i;d++)g[a[d]]=this.attr(a[d]);return g}if(c!=null){d={};
d[a]=c}else a!=null&&w.is(a,"object")&&(d=a);for(i in this.paper.customAttributes)if(this.paper.customAttributes[h](i)&&d[h](i)&&w.is(this.paper.customAttributes[i],"function")){g=this.paper.customAttributes[i].apply(this,[].concat(d[i]));this.attrs[i]=d[i];for(var e in g)g[h](e)&&(d[e]=g[e])}xa(this,d);return this};ia[H].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&eb(this,a);return this};ia[H].toBack=function(){if(this.removed)return this;
if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);fb(this,this.paper)}return this};ia[H].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);gb(this,a,this.paper);return this};ia[H].insertBefore=function(a){if(this.removed)return this;var c=a.node||a[0].node;c.parentNode.insertBefore(this.node,
c);hb(this,a,this.paper);return this};ia[H].blur=function(a){if(+a!==0){var c=ca("filter"),d=ca("feGaussianBlur");this.attrs.blur=a;c.id=Z();ca(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;ca(this.node,{filter:"url(#"+c.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var kb=function(a,c,d,g){var i=ca("circle");a.canvas&&a.canvas.appendChild(i);a=new ia(i,
a);a.attrs={cx:c,cy:d,r:g,fill:"none",stroke:"#000"};a.type="circle";ca(i,a.attrs);return a},lb=function(a,c,d,g,i,e){var l=ca("rect");a.canvas&&a.canvas.appendChild(l);a=new ia(l,a);a.attrs={x:c,y:d,width:g,height:i,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};a.type="rect";ca(l,a.attrs);return a},mb=function(a,c,d,g,i){var e=ca("ellipse");a.canvas&&a.canvas.appendChild(e);a=new ia(e,a);a.attrs={cx:c,cy:d,rx:g,ry:i,fill:"none",stroke:"#000"};a.type="ellipse";ca(e,a.attrs);return a},nb=function(a,
c,d,g,i,e){var l=ca("image");ca(l,{x:d,y:g,width:i,height:e,preserveAspectRatio:"none"});l.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(l);a=new ia(l,a);a.attrs={x:d,y:g,width:i,height:e,src:c};a.type="image";return a},ob=function(a,c,d,g){var i=ca("text");ca(i,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(i);a=new ia(i,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:g,font:Ea.font,stroke:"none",fill:"#000"};a.type="text";xa(a,a.attrs);return a},pb=function(a,
c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Na=function(){var a=db[S](0,arguments),c=a&&a.container,d=a.x,g=a.y,i=a.width;a=a.height;if(!c)throw Error("SVG container not found.");var e=ca("svg");d=d||0;g=g||0;i=i||512;a=a||342;ca(e,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:i,height:a});if(c==1){e.style.cssText="position:absolute;left:"+d+"px;top:"+g+"px";k.body.appendChild(e)}else c.firstChild?
c.insertBefore(e,c.firstChild):c.appendChild(e);c=new F;c.width=i;c.height=a;c.canvas=e;Ra.call(c,c,w.fn);c.clear();return c};O.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=ca("desc")).appendChild(k.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=ca("defs"))};O.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a)}}if(w.vml){var qb=
{M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Eb=/([clmz]),?([^clmz]*)/gi,Fb=/ progid:\S+Blur\([^\)]+\)/g,Gb=/-?[^,\s-]+/g,Ca=1E3+W+1E3,Da={path:1,rect:1},Hb=function(a){var c=/[ahqstv]/ig,d=Aa;f(a).match(c)&&(d=Ha);c=/[clmz]/g;if(d==Aa&&!f(a).match(c))return a=f(a).replace(Eb,function(q,r,I){var K=[],L=u.call(r)=="m",T=qb[r];I.replace(Gb,function(ea){if(L&&K[m]==2){T+=K+qb[r=="m"?"l":"L"];K=[]}K[aa](ba(ea*10))});return T+K});c=d(a);var g;a=[];for(var i=0,e=c[m];i<e;i++){d=c[i];g=u.call(c[i][0]);
g=="z"&&(g="x");for(var l=1,p=d[m];l<p;l++)g+=ba(d[l]*10)+(l!=p-1?",":"");a[aa](g)}return a[v](W)};w[$]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};jb=function(a,c){var d=qa("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var g=qa("shape"),i=g.style;i.width=c.width+"px";i.height=c.height+"px";g.coordsize=Ca;g.coordorigin=
c.coordorigin;d.appendChild(g);g=new ia(g,d,c);i={fill:"none",stroke:"#000"};a&&(i.path=a);g.type="path";g.path=[];g.Path="";xa(g,i);c.canvas.appendChild(d);return g};xa=function(a,c){a.attrs=a.attrs||{};var d=a.node,g=a.attrs,i=d.style,e;e=(c.x!=g.x||c.y!=g.y||c.width!=g.width||c.height!=g.height||c.r!=g.r)&&a.type=="rect";for(var l in c)c[h](l)&&(g[l]=c[l]);if(e){g.path=rb(g.x,g.y,g.width,g.height,g.r);a.X=g.x;a.Y=g.y;a.W=g.width;a.H=g.height}c.href&&(d.href=c.href);c.title&&(d.title=c.title);c.target&&
(d.target=c.target);c.cursor&&(i.cursor=c.cursor);"blur"in c&&a.blur(c.blur);if(c.path&&a.type=="path"||e)d.path=Hb(g.path);c.rotation!=null&&a.rotate(c.rotation,true);if(c.translation){e=f(c.translation).split(E);Ka.call(a,e[0],e[1]);if(a._.rt.cx!=null){a._.rt.cx+=+e[0];a._.rt.cy+=+e[1];a.setBox(a.attrs,e[0],e[1])}}if(c.scale){e=f(c.scale).split(E);a.scale(+e[0]||1,+e[1]||+e[0]||1,+e[2]||null,+e[3]||null)}if("clip-rect"in c){e=f(c["clip-rect"]).split(E);if(e[m]==4){e[2]=+e[2]+ +e[0];e[3]=+e[3]+ +e[1];
l=d.clipRect||k.createElement("div");var p=l.style,q=d.parentNode;p.clip=w.format("rect({1}px {2}px {3}px {0}px)",e);if(!d.clipRect){p.position="absolute";p.top=0;p.left=0;p.width=a.paper.width+"px";p.height=a.paper.height+"px";q.parentNode.insertBefore(l,q);l.appendChild(q);d.clipRect=l}}c["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="")}a.type=="image"&&c.src&&(d.src=c.src);if(a.type=="image"&&c.opacity){d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+c.opacity*100+")";i.filter=
(d.filterMatrix||"")+(d.filterOpacity||"")}c.font&&(i.font=c.font);c["font-family"]&&(i.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');c["font-size"]&&(i.fontSize=c["font-size"]);c["font-weight"]&&(i.fontWeight=c["font-weight"]);c["font-style"]&&(i.fontStyle=c["font-style"]);if(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=null||c["stroke-miterlimit"]!=
null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){d=a.shape||d;e=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];l=false;!e&&(l=e=qa("fill"));if("fill-opacity"in c||"opacity"in c){i=((+g["fill-opacity"]+1||2)-1)*((+g.opacity+1||2)-1)*((+w.getRGB(c.fill).o+1||2)-1);i=j(D(i,0),1);e.opacity=i}c.fill&&(e.on=true);if(e.on==null||c.fill=="none")e.on=false;if(e.on&&c.fill)if(i=c.fill.match(fa)){e.src=i[1];e.type="tile"}else{e.color=w.getRGB(c.fill).hex;e.src="";e.type="solid";
if(w.getRGB(c.fill).error&&(a.type in{circle:1,ellipse:1}||f(c.fill).charAt()!="r")&&Ba(a,c.fill)){g.fill="none";g.gradient=c.fill}}l&&d.appendChild(e);e=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];l=false;!e&&(l=e=qa("stroke"));if(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])e.on=true;(c.stroke=="none"||e.on==null||c.stroke==0||c["stroke-width"]==0)&&(e.on=
false);i=w.getRGB(c.stroke);e.on&&c.stroke&&(e.color=i.hex);i=((+g["stroke-opacity"]+1||2)-1)*((+g.opacity+1||2)-1)*((+i.o+1||2)-1);p=(X(c["stroke-width"])||1)*0.75;i=j(D(i,0),1);c["stroke-width"]==null&&(p=g["stroke-width"]);c["stroke-width"]&&(e.weight=p);p&&p<1&&(i*=p)&&(e.weight=1);e.opacity=i;c["stroke-linejoin"]&&(e.joinstyle=c["stroke-linejoin"]||"miter");e.miterlimit=c["stroke-miterlimit"]||8;c["stroke-linecap"]&&(e.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]=="square"?"square":
"round");if(c["stroke-dasharray"]){i={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};e.dashstyle=i[h](c["stroke-dasharray"])?i[c["stroke-dasharray"]]:""}l&&d.appendChild(e)}if(a.type=="text"){i=a.paper.span.style;g.font&&(i.font=g.font);g["font-family"]&&(i.fontFamily=g["font-family"]);g["font-size"]&&(i.fontSize=g["font-size"]);g["font-weight"]&&(i.fontWeight=g["font-weight"]);
g["font-style"]&&(i.fontStyle=g["font-style"]);a.node.string&&(a.paper.span.innerHTML=f(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=g.w=a.paper.span.offsetWidth;a.H=g.h=a.paper.span.offsetHeight;a.X=g.x;a.Y=g.y+ba(a.H/2);switch(g["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=ba(a.W/2);break;case "end":a.node.style["v-text-align"]="right";a.bbx=-ba(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Ba=function(a,c){a.attrs=
a.attrs||{};var d,g="linear",i=".5 .5";a.attrs.gradient=c;c=f(c).replace(Za,function(I,K,L){g="radial";if(K&&L){K=X(K);L=X(L);y(K-0.5,2)+y(L-0.5,2)>0.25&&(L=A.sqrt(0.25-y(K-0.5,2))*((L>0.5)*2-1)+0.5);i=K+W+L}return""});c=c.split(/\s*\-\s*/);if(g=="linear"){var e=c.shift();e=-X(e);if(isNaN(e))return null}var l=cb(c);if(!l)return null;a=a.shape||a.node;d=a.getElementsByTagName("fill")[0]||qa("fill");!d.parentNode&&a.appendChild(d);if(l[m]){d.on=true;d.method="none";d.color=l[0].color;d.color2=l[l[m]-
1].color;for(var p=[],q=0,r=l[m];q<r;q++)l[q].offset&&p[aa](l[q].offset+W+l[q].color);d.colors&&(d.colors.value=p[m]?p[v]():"0% "+d.color);if(g=="radial"){d.type="gradientradial";d.focus="100%";d.focussize=i;d.focusposition=i}else{d.type="gradient";d.angle=(270-e)%360}}return 1};ia=function(a,c,d){this[0]=a;this.id=w._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=
this);d.top=this;this.next=null};ha=ia[H];ha.rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][v](W);return this._.rt.deg}a=f(a).split(E);if(a[m]-1){c=X(a[1]);d=X(a[2])}a=X(a[0]);c!=null?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;this.setBox(this.attrs,c,d);this.Group.style.rotation=this._.rt.deg;return this};ha.setBox=function(a,c,d){if(this.removed)return this;var g=this.Group.style,
i=this.shape&&this.shape.style||this.node.style;a=a||{};for(var e in a)a[h](e)&&(this.attrs[e]=a[e]);c=c||this._.rt.cx;d=d||this._.rt.cy;var l=this.attrs,p;switch(this.type){case "circle":a=l.cx-l.r;e=l.cy-l.r;p=l=l.r*2;break;case "ellipse":a=l.cx-l.rx;e=l.cy-l.ry;p=l.rx*2;l=l.ry*2;break;case "image":a=+l.x;e=+l.y;p=l.width||0;l=l.height||0;break;case "text":this.textpath.v=["m",ba(l.x),", ",ba(l.y-2),"l",ba(l.x)+1,", ",ba(l.y-2)][v]("");a=l.x-ba(this.W/2);e=l.y-this.H/2;p=this.W;l=this.H;break;case "rect":case "path":if(this.attrs.path){l=
Ia(this.attrs.path);a=l.x;e=l.y;p=l.width;l=l.height}else{e=a=0;p=this.paper.width;l=this.paper.height}break;default:e=a=0;p=this.paper.width;l=this.paper.height}c=(c==null?a+p/2:c)-this.paper.width/2;d=(d==null?e+l/2:d)-this.paper.height/2;var q;g.left!=(q=c+"px")&&(g.left=q);g.top!=(q=d+"px")&&(g.top=q);this.X=Da[h](this.type)?-c:a;this.Y=Da[h](this.type)?-d:e;this.W=p;this.H=l;if(Da[h](this.type)){i.left!=(q=-c*10+"px")&&(i.left=q);i.top!=(q=-d*10+"px")&&(i.top=q)}else if(this.type=="text"){i.left!=
(q=-c+"px")&&(i.left=q);i.top!=(q=-d+"px")&&(i.top=q)}else{g.width!=(q=this.paper.width+"px")&&(g.width=q);g.height!=(q=this.paper.height+"px")&&(g.height=q);i.left!=(q=a-c+"px")&&(i.left=q);i.top!=(q=e-d+"px")&&(i.top=q);i.width!=(q=p+"px")&&(i.width=q);i.height!=(q=l+"px")&&(i.height=q)}};ha.hide=function(){!this.removed&&(this.Group.style.display="none");return this};ha.show=function(){!this.removed&&(this.Group.style.display="block");return this};ha.getBBox=function(){if(this.removed)return this;
if(Da[h](this.type))return Ia(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};ha.remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=true}};ha.attr=function(a,c){if(this.removed)return this;if(a==null){var d={},g;for(g in this.attrs)this.attrs[h](g)&&(d[g]=this.attrs[g]);
this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&w.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(this.attrs&&c==null&&w.is(a,R)){var i={};g=0;for(d=a[m];g<d;g++)i[a[g]]=this.attr(a[g]);
return i}if(c!=null){d={};d[a]=c}c==null&&w.is(a,"object")&&(d=a);if(d){for(i in this.paper.customAttributes)if(this.paper.customAttributes[h](i)&&d[h](i)&&w.is(this.paper.customAttributes[i],"function")){g=this.paper.customAttributes[i].apply(this,[].concat(d[i]));this.attrs[i]=d[i];for(var e in g)g[h](e)&&(d[e]=g[e])}d.text&&this.type=="text"&&(this.node.string=d.text);xa(this,d);d.gradient&&({circle:1,ellipse:1}[h](this.type)||f(d.gradient).charAt()!="r")&&Ba(this,d.gradient);(!Da[h](this.type)||
this._.rt.deg)&&this.setBox(this.attrs)}return this};ha.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&eb(this,this.paper);return this};ha.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);fb(this,this.paper)}return this};ha.insertAfter=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[a.length-1]);a.Group.nextSibling?
a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);gb(this,a,this.paper);return this};ha.insertBefore=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);hb(this,a,this.paper);return this};ha.blur=function(a){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(Fb,"");if(+a!==0){this.attrs.blur=a;c.filter=d+W+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";
c.margin=w.format("-{0}px 0 0 -{0}px",ba(+a||1.5))}else{c.filter=d;c.margin=0;delete this.attrs.blur}};kb=function(a,c,d,g){var i=qa("group"),e=qa("oval");i.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";i.coordsize=Ca;i.coordorigin=a.coordorigin;i.appendChild(e);e=new ia(e,i,a);e.type="circle";xa(e,{stroke:"#000",fill:"none"});e.attrs.cx=c;e.attrs.cy=d;e.attrs.r=g;e.setBox({x:c-g,y:d-g,width:g*2,height:g*2});a.canvas.appendChild(i);return e};var rb=function(a,
c,d,g,i){return i?w.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+i,c,d-i*2,i,-i,g-i*2,i*2-d,i*2-g):w.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,g,-d)};lb=function(a,c,d,g,i,e){var l=rb(c,d,g,i,e);a=a.path(l);var p=a.attrs;a.X=p.x=c;a.Y=p.y=d;a.W=p.width=g;a.H=p.height=i;p.r=e;p.path=l;a.type="rect";return a};mb=function(a,c,d,g,i){var e=qa("group"),l=qa("oval");e.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";e.coordsize=Ca;e.coordorigin=a.coordorigin;e.appendChild(l);l=new ia(l,e,a);l.type="ellipse";xa(l,{stroke:"#000"});l.attrs.cx=c;l.attrs.cy=d;l.attrs.rx=g;l.attrs.ry=i;l.setBox({x:c-g,y:d-i,width:g*2,height:i*2});a.canvas.appendChild(e);return l};nb=function(a,c,d,g,i,e){var l=qa("group"),p=qa("image");l.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";l.coordsize=Ca;l.coordorigin=a.coordorigin;p.src=c;l.appendChild(p);p=new ia(p,
l,a);p.type="image";p.attrs.src=c;p.attrs.x=d;p.attrs.y=g;p.attrs.w=i;p.attrs.h=e;p.setBox({x:d,y:g,width:i,height:e});a.canvas.appendChild(l);return p};ob=function(a,c,d,g){var i=qa("group"),e=qa("shape"),l=e.style,p=qa("path"),q=qa("textpath");i.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";i.coordsize=Ca;i.coordorigin=a.coordorigin;p.v=w.format("m{0},{1}l{2},{1}",ba(c*10),ba(d*10),ba(c*10)+1);p.textpathok=true;l.width=a.width;l.height=a.height;q.string=
f(g);q.on=true;e.appendChild(q);e.appendChild(p);i.appendChild(e);l=new ia(q,i,a);l.shape=e;l.textpath=p;l.type="text";l.attrs.text=g;l.attrs.x=c;l.attrs.y=d;l.attrs.w=1;l.attrs.h=1;xa(l,{font:Ea.font,stroke:"none",fill:"#000"});l.setBox();a.canvas.appendChild(i);return l};pb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this};var qa;k.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!k.namespaces.rvml&&
k.namespaces.add("rvml","urn:schemas-microsoft-com:vml");qa=function(a){return k.createElement("<rvml:"+a+' class="rvml">')}}catch(Ob){qa=function(a){return k.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Na=function(){var a=db[S](0,arguments),c=a.container,d=a.height,g=a.width,i=a.x;a=a.y;if(!c)throw Error("VML container not found.");var e=new F,l=e.canvas=k.createElement("div"),p=l.style;i=i||0;a=a||0;g=g||512;d=d||342;g==+g&&(g+="px");d==+d&&(d+="px");e.width=1E3;
e.height=1E3;e.coordsize=1E4+W+1E4;e.coordorigin="0 0";e.span=k.createElement("span");e.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";l.appendChild(e.span);p.cssText=w.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",g,d);if(c==1){k.body.appendChild(l);p.left=i+"px";p.top=a+"px";p.position="absolute"}else c.firstChild?c.insertBefore(l,c.firstChild):c.appendChild(l);
Ra.call(e,e,w.fn);return e};O.clear=function(){this.canvas.innerHTML="";this.span=k.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};O.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a);return true}}ta=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(ta&&ta[1]<
4||navigator.platform.slice(0,2)=="iP")?O.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});s.setTimeout(function(){a.remove()})}:O.safari=function(){};var Ib=function(){this.returnValue=false},Jb=function(){return this.originalEvent.preventDefault()},Kb=function(){this.cancelBubble=true},Lb=function(){return this.originalEvent.stopPropagation()},Mb=function(){if(k.addEventListener)return function(a,c,d,g){var i=da&&J[c]?J[c]:c,e=function(l){if(da&&J[h](c))for(var p=
0,q=l.targetTouches&&l.targetTouches.length;p<q;p++)if(l.targetTouches[p].target==a){q=l;l=l.targetTouches[p];l.originalEvent=q;l.preventDefault=Jb;l.stopPropagation=Lb;break}return d.call(g,l)};a.addEventListener(i,e,false);return function(){a.removeEventListener(i,e,false);return true}};if(k.attachEvent)return function(a,c,d,g){var i=function(e){e=e||s.event;e.preventDefault=e.preventDefault||Ib;e.stopPropagation=e.stopPropagation||Kb;return d.call(g,e)};a.attachEvent("on"+c,i);return function(){a.detachEvent("on"+
c,i);return true}}}(),ua=[],Ta=function(a){for(var c=a.clientX,d=a.clientY,g=k.documentElement.scrollTop||k.body.scrollTop,i=k.documentElement.scrollLeft||k.body.scrollLeft,e,l=ua.length;l--;){e=ua[l];if(da)for(var p=a.touches.length,q;p--;){q=a.touches[p];if(q.identifier==e.el._drag.id){c=q.clientX;d=q.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=i;d+=g;e.move&&e.move.call(e.move_scope||e.el,c-e.el._drag.x,d-e.el._drag.y,c,d,a)}},Ua=function(a){w.unmousemove(Ta).unmouseup(Ua);
for(var c=ua.length,d;c--;){d=ua[c];d.el._drag={};d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a)}ua=[]};for(ta=z[m];ta--;)(function(a){w[a]=ia[H][a]=function(c,d){if(w.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:Mb(this.shape||this.node||k,a,c,d||this)})}return this};w["un"+a]=ia[H]["un"+a]=function(c){for(var d=this.events,g=d[m];g--;)if(d[g].name==a&&d[g].f==c){d[g].unbind();d.splice(g,1);!d.length&&delete this.events;break}return this}})(z[ta]);
ha.hover=function(a,c,d,g){return this.mouseover(a,d).mouseout(c,g||d)};ha.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};ha.drag=function(a,c,d,g,i,e){this._drag={};this.mousedown(function(l){(l.originalEvent||l).preventDefault();var p=k.documentElement.scrollTop||k.body.scrollTop,q=k.documentElement.scrollLeft||k.body.scrollLeft;this._drag.x=l.clientX+q;this._drag.y=l.clientY+p;this._drag.id=l.identifier;c&&c.call(i||g||this,l.clientX+q,l.clientY+p,l);!ua.length&&w.mousemove(Ta).mouseup(Ua);
ua.push({el:this,move:a,end:d,move_scope:g,start_scope:i,end_scope:e})});return this};ha.undrag=function(a,c,d){for(c=ua.length;c--;)ua[c].el==this&&ua[c].move==a&&ua[c].end==d&&ua.splice(c++,1);!ua.length&&w.unmousemove(Ta).unmouseup(Ua)};O.circle=function(a,c,d){return kb(this,a||0,c||0,d||0)};O.rect=function(a,c,d,g,i){return lb(this,a||0,c||0,d||0,g||0,i||0)};O.ellipse=function(a,c,d,g){return mb(this,a||0,c||0,d||0,g||0)};O.path=function(a){a&&!w.is(a,"string")&&!w.is(a[0],R)&&(a+="");return jb(w.format[S](w,
arguments),this)};O.image=function(a,c,d,g,i){return nb(this,a||"about:blank",c||0,d||0,g||0,i||0)};O.text=function(a,c,d){return ob(this,a||0,c||0,f(d))};O.set=function(a){arguments[m]>1&&(a=Array[H].splice.call(arguments,0,arguments[m]));return new sa(a)};O.setSize=pb;O.top=O.bottom=null;O.raphael=w;ha.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};ha.scale=function(a,c,d,g){if(this.removed)return this;if(a==null&&c==null)return{x:this._.sx,y:this._.sy,
toString:C};c=c||a;!+c&&(c=a);var i,e,l=this.attrs;if(a!=0){var p=this.getBBox(),q=p.x+p.width/2,r=p.y+p.height/2;i=o(a/this._.sx);e=o(c/this._.sy);d=+d||d==0?d:q;g=+g||g==0?g:r;var I=this._.sx>0,K=this._.sy>0;p=~~(a/o(a));var L=~~(c/o(c)),T=i*p,ea=e*L,V=this.node.style;q=d+o(q-d)*T*(q>d==I?1:-1);r=g+o(r-g)*ea*(r>g==K?1:-1);var Q=a*p>c*L?e:i;switch(this.type){case "rect":case "image":var Y=l.width*i,ja=l.height*e;this.attr({height:ja,r:l.r*Q,width:Y,x:q-Y/2,y:r-ja/2});break;case "circle":case "ellipse":this.attr({rx:l.rx*
i,ry:l.ry*e,r:l.r*Q,cx:q,cy:r});break;case "text":this.attr({x:q,y:r});break;case "path":Q=Qa(l.path);var oa=true;I=I?T:i;K=K?ea:e;ea=0;for(T=Q[m];ea<T;ea++){var pa=Q[ea],ma=wa.call(pa[0]);if(!(ma=="M"&&oa)){oa=false;if(ma=="A"){pa[Q[ea][m]-2]*=I;pa[Q[ea][m]-1]*=K;pa[1]*=i;pa[2]*=e;pa[5]=+(p+L?!!+pa[5]:!+pa[5])}else if(ma=="H"){ma=1;for(var ya=pa[m];ma<ya;ma++)pa[ma]*=I}else if(ma=="V"){ma=1;for(ya=pa[m];ma<ya;ma++)pa[ma]*=K}else{ma=1;for(ya=pa[m];ma<ya;ma++)pa[ma]*=ma%2?I:K}}}e=Ia(Q);i=q-e.x-e.width/
2;e=r-e.y-e.height/2;Q[0][1]+=i;Q[0][2]+=e;this.attr({path:Q})}if(this.type in{text:1,image:1}&&(p!=1||L!=1))if(this.transformations){this.transformations[2]="scale(".concat(p,",",L,")");this.node.setAttribute("transform",this.transformations[v](W));i=p==-1?-l.x-(Y||0):l.x;e=L==-1?-l.y-(ja||0):l.y;this.attr({x:i,y:e});l.fx=p-1;l.fy=L-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(p,", M12=0, M21=0, M22=",L,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");
V.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[v](W));l.fx=0;l.fy=0}else{this.node.filterMatrix="";V.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}l.scale=[a,c,d,g][v](W);this._.sx=a;this._.sy=c}return this};ha.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};
var Va={},La=function(a,c,d,g,i,e,l,p,q){var r=0,I=100,K=[a,c,d,g,i,e,l,p].join(),L=Va[K],T,ea;!L&&(Va[K]=L={data:[]});L.timer&&clearTimeout(L.timer);L.timer=setTimeout(function(){delete Va[K]},2E3);if(q!=null)I=~~La(a,c,d,g,i,e,l,p)*10;for(var V=0;V<I+1;V++){if(L.data[q]>V)ea=L.data[V*I];else{ea=w.findDotsAtSegment(a,c,d,g,i,e,l,p,V/I);L.data[V]=ea}V&&(r+=y(y(T.x-ea.x,2)+y(T.y-ea.y,2),0.5));if(q!=null&&r>=q)return ea;T=ea}if(q==null)return r};z=function(a,c){return function(d,g,i){d=Ha(d);for(var e,
l,p,q,r="",I={},K=0,L=0,T=d.length;L<T;L++){p=d[L];if(p[0]=="M"){e=+p[1];l=+p[2]}else{q=La(e,l,p[1],p[2],p[3],p[4],p[5],p[6]);if(K+q>g){if(c&&!I.start){e=La(e,l,p[1],p[2],p[3],p[4],p[5],p[6],g-K);r+=["C",e.start.x,e.start.y,e.m.x,e.m.y,e.x,e.y];if(i)return r;I.start=r;r=["M",e.x,e.y+"C",e.n.x,e.n.y,e.end.x,e.end.y,p[5],p[6]][v]();K+=q;e=+p[5];l=+p[6];continue}if(!a&&!c){e=La(e,l,p[1],p[2],p[3],p[4],p[5],p[6],g-K);return{x:e.x,y:e.y,alpha:e.alpha}}}K+=q;e=+p[5];l=+p[6]}r+=p}I.end=r;e=a?K:c?I:w.findDotsAtSegment(e,
l,p[1],p[2],p[3],p[4],p[5],p[6],1);e.alpha&&(e={x:e.x,y:e.y,alpha:e.alpha});return e}};var sb=z(1),Ma=z(),Wa=z(0,1);ha.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return sb(this.attrs.path)}};ha.getPointAtLength=function(a){if(this.type=="path")return Ma(this.attrs.path,a)};ha.getSubpath=function(a,c){if(this.type=="path"){if(o(this.getTotalLength()-c)<"1e-6")return Wa(this.attrs.path,a).end;var d=Wa(this.attrs.path,c,1);return a?Wa(d,
a).end:d}};w.easing_formulas={linear:function(a){return a},"<":function(a){return y(a,3)},">":function(a){return y(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return y(a,3)/2;a-=2;return(y(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||a==1)return a;return y(2,-10*a)*A.sin((a-0.075)*2*B/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/2.75){a-=
2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var va=[],tb=function(){for(var a=+new Date,c=0;c<va[m];c++){var d=va[c];if(!(d.stop||d.el.removed)){var g=a-d.start,i=d.ms,e=d.easing,l=d.from,p=d.diff,q=d.to,r=d.t,I=d.el;d={};var K;if(g<i){g=e(g/i);for(var L in l)if(l[h](L)){switch(Oa[L]){case "along":K=g*i*p[L];q.back&&(K=q.len-K);e=Ma(q[L],K);I.translate(p.sx-p.x||0,p.sy-p.y||0);p.x=e.x;p.y=e.y;I.translate(e.x-p.sx,e.y-p.sy);q.rot&&I.rotate(p.r+e.alpha,e.x,e.y);
break;case P:K=+l[L]+g*i*p[L];break;case "colour":K="rgb("+[Xa(ba(l[L].r+g*i*p[L].r)),Xa(ba(l[L].g+g*i*p[L].g)),Xa(ba(l[L].b+g*i*p[L].b))][v](",")+")";break;case "path":K=[];e=0;for(var T=l[L][m];e<T;e++){K[e]=[l[L][e][0]];for(var ea=1,V=l[L][e][m];ea<V;ea++)K[e][ea]=+l[L][e][ea]+g*i*p[L][e][ea];K[e]=K[e][v](W)}K=K[v](W);break;case "csv":switch(L){case "translation":K=g*i*p[L][0]-r.x;e=g*i*p[L][1]-r.y;r.x+=K;r.y+=e;K=K+W+e;break;case "rotation":K=+l[L][0]+g*i*p[L][0];l[L][1]&&(K+=","+l[L][1]+","+
l[L][2]);break;case "scale":K=[+l[L][0]+g*i*p[L][0],+l[L][1]+g*i*p[L][1],2 in q[L]?q[L][2]:"",3 in q[L]?q[L][3]:""][v](W);break;case "clip-rect":K=[];for(e=4;e--;)K[e]=+l[L][e]+g*i*p[L][e]}break;default:T=[].concat(l[L]);K=[];for(e=I.paper.customAttributes[L].length;e--;)K[e]=+T[e]+g*i*p[L][e]}d[L]=K}I.attr(d);I._run&&I._run.call(I)}else{if(q.along){e=Ma(q.along,q.len*!q.back);I.translate(p.sx-(p.x||0)+e.x-p.sx,p.sy-(p.y||0)+e.y-p.sy);q.rot&&I.rotate(p.r+e.alpha,e.x,e.y)}(r.x||r.y)&&I.translate(-r.x,
-r.y);q.scale&&(q.scale+="");I.attr(q);va.splice(c--,1)}}}w.svg&&I&&I.paper&&I.paper.safari();va[m]&&setTimeout(tb)},Nb=function(a,c,d,g,i){var e=d-g;c.timeouts.push(setTimeout(function(){w.is(i,"function")&&i.call(c);c.animate(a,e,a.easing)},g))},Xa=function(a){return D(j(a,255),0)},Ka=function(a,c){if(a==null)return{x:this._.tx,y:this._.ty,toString:C};this._.tx+=+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+
this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Qa(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};ha.animateWith=function(a,c,d,g,i){for(var e=0,l=va.length;e<l;e++)va[e].el.id==a.id&&(c.start=va[e].start);return this.animate(c,d,g,i)};ha.animateAlong=U();ha.animateAlongBack=U(1);ha.onAnimation=function(a){this._run=a||0;return this};ha.animate=function(a,c,d,g){var i=this;i.timeouts=i.timeouts||[];if(w.is(d,"function")||!d)g=d||null;if(i.removed){g&&g.call(i);
return i}var e={},l={},p=false,q={},r;for(r in a)if(a[h](r))if(Oa[h](r)||i.paper.customAttributes[h](r)){p=true;e[r]=i.attr(r);e[r]==null&&(e[r]=Ea[r]);l[r]=a[r];switch(Oa[r]){case "along":var I=sb(a[r]),K=Ma(a[r],I*!!a.back),L=i.getBBox();q[r]=I/c;q.tx=L.x;q.ty=L.y;q.sx=K.x;q.sy=K.y;l.rot=a.rot;l.back=a.back;l.len=I;a.rot&&(q.r=X(i.rotate())||0);break;case P:q[r]=(l[r]-e[r])/c;break;case "colour":e[r]=w.getRGB(e[r]);I=w.getRGB(l[r]);q[r]={r:(I.r-e[r].r)/c,g:(I.g-e[r].g)/c,b:(I.b-e[r].b)/c};break;
case "path":I=Ha(e[r],l[r]);e[r]=I[0];L=I[1];q[r]=[];I=0;for(K=e[r][m];I<K;I++){q[r][I]=[0];for(var T=1,ea=e[r][I][m];T<ea;T++)q[r][I][T]=(L[I][T]-e[r][I][T])/c}break;case "csv":K=f(a[r]).split(E);L=f(e[r]).split(E);switch(r){case "translation":e[r]=[0,0];q[r]=[K[0]/c,K[1]/c];break;case "rotation":e[r]=L[1]==K[1]&&L[2]==K[2]?L:[0,K[1],K[2]];q[r]=[(K[0]-e[r][0])/c,0,0];break;case "scale":a[r]=K;e[r]=f(e[r]).split(E);q[r]=[(K[0]-e[r][0])/c,(K[1]-e[r][1])/c,0,0];break;case "clip-rect":e[r]=f(e[r]).split(E);
q[r]=[];for(I=4;I--;)q[r][I]=(K[I]-e[r][I])/c}l[r]=K;break;default:K=[].concat(a[r]);L=[].concat(e[r]);q[r]=[];for(I=i.paper.customAttributes[r][m];I--;)q[r][I]=((K[I]||0)-(L[I]||0))/c}}if(p){r=w.easing_formulas[d];if(!r)if((r=f(d).match(ra))&&r[m]==5){var V=r;r=function(ja){return n(ja,+V[1],+V[2],+V[3],+V[4],c)}}else r=function(ja){return ja};va.push({start:a.start||+new Date,ms:c,easing:r,from:e,diff:q,to:l,el:i,t:{x:0,y:0}});w.is(g,"function")&&(i._ac=setTimeout(function(){g.call(i)},c));va[m]==
1&&setTimeout(tb)}else{d=[];var Q,Y;for(Y in a)if(a[h](Y)&&ub.test(Y)){r={value:a[Y]};Y=="from"&&(Y=0);Y=="to"&&(Y=100);r.key=na(Y,10);d.push(r)}d.sort(zb);d[0].key&&d.unshift({key:0,value:i.attrs});I=0;for(K=d[m];I<K;I++)Nb(d[I].value,i,c/100*d[I].key,c/100*(d[I-1]&&d[I-1].key||0),d[I-1]&&d[I-1].value.callback);(Q=d[d[m]-1].value.callback)&&i.timeouts.push(setTimeout(function(){Q.call(i)},c))}return this};ha.stop=function(){for(var a=0;a<va.length;a++)va[a].el.id==this.id&&va.splice(a--,1);a=0;for(ii=
this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};ha.translate=function(a,c){return this.attr({translation:a+" "+c})};ha[$]=function(){return"Rapha\u00ebl\u2019s object"};w.ae=va;var sa=function(a){this.items=[];this[m]=0;this.type="set";if(a)for(var c=0,d=a[m];c<d;c++)if(a[c]&&(a[c].constructor==ia||a[c].constructor==sa)){this[this.items[m]]=this.items[this.items[m]]=a[c];this[m]++}};sa[H][aa]=function(){for(var a,
c,d=0,g=arguments[m];d<g;d++)if((a=arguments[d])&&(a.constructor==ia||a.constructor==sa)){c=this.items[m];this[c]=this.items[c]=a;this[m]++}return this};sa[H].pop=function(){delete this[this[m]--];return this.items.pop()};for(var Ya in ha)ha[h](Ya)&&(sa[H][Ya]=function(a){return function(){for(var c=0,d=this.items[m];c<d;c++)this.items[c][a][S](this.items[c],arguments);return this}}(Ya));sa[H].attr=function(a,c){if(a&&w.is(a,R)&&w.is(a[0],"object"))for(var d=0,g=a[m];d<g;d++)this.items[d].attr(a[d]);
else{d=0;for(g=this.items[m];d<g;d++)this.items[d].attr(a,c)}return this};sa[H].animate=function(a,c,d,g){(w.is(d,"function")||!d)&&(g=d||null);var i=this.items[m],e=i,l,p=this,q;g&&(q=function(){!--i&&g.call(p)});d=w.is(d,"string")?d:q;for(l=this.items[--e].animate(a,c,d,q);e--;)this.items[e]&&!this.items[e].removed&&this.items[e].animateWith(l,a,c,d,q);return this};sa[H].insertAfter=function(a){for(var c=this.items[m];c--;)this.items[c].insertAfter(a);return this};sa[H].getBBox=function(){for(var a=
[],c=[],d=[],g=[],i=this.items[m];i--;){var e=this.items[i].getBBox();a[aa](e.x);c[aa](e.y);d[aa](e.x+e.width);g[aa](e.y+e.height)}a=j[S](0,a);c=j[S](0,c);return{x:a,y:c,width:D[S](0,d)-a,height:D[S](0,g)-c}};sa[H].clone=function(a){a=new sa;for(var c=0,d=this.items[m];c<d;c++)a[aa](this.items[c].clone());return a};w.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],g;for(g in a.face)a.face[h](g)&&(c.face[g]=a.face[g]);this.fonts[d]?
this.fonts[d][aa](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=na(a.face["units-per-em"],10);for(var i in a.glyphs)if(a.glyphs[h](i)){d=a.glyphs[i];c.glyphs[i]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(l){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[l]||"M"})+"z"};if(d.k)for(var e in d.k)d[h](e)&&(c.glyphs[i].k[e]=d.k[e])}}return a};O.getFont=function(a,c,d,g){g=g||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(w.fonts){var i=w.fonts[a];
if(!i){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var e in w.fonts)if(w.fonts[h](e))if(a.test(e)){i=w.fonts[e];break}}var l;if(i){e=0;for(a=i[m];e<a;e++){l=i[e];if(l.face["font-weight"]==c&&(l.face["font-style"]==d||!l.face["font-style"])&&l.face["font-stretch"]==g)break}}return l}};O.print=function(a,c,d,g,i,e,l){e=e||"middle";l=D(j(l||0,1),-1);var p=this.set(),q=f(d).split(""),r=0;w.is(g,d)&&(g=this.getFont(g));if(g){d=(i||16)/g.face["units-per-em"];var I=g.face.bbox.split(E);
i=+I[0];e=+I[1]+(e=="baseline"?I[3]-I[1]+ +g.face.descent:(I[3]-I[1])/2);I=0;for(var K=q[m];I<K;I++){var L=I&&g.glyphs[q[I-1]]||{},T=g.glyphs[q[I]];r+=I?(L.w||g.w)+(L.k&&L.k[q[I]]||0)+g.w*l:0;T&&T.d&&p[aa](this.path(T.d).attr({fill:"#000",stroke:"none",translation:[r,0]}))}p.scale(d,d,i,e).translate(a-i,c-e)}return p};w.format=function(a,c){var d=w.is(c,R)?[0].concat(c):arguments;a&&w.is(a,"string")&&d[m]-1&&(a=a.replace(x,function(g,i){return d[++i]==null?"":d[i]}));return a||""};w.ninja=function(){G.was?
s.Raphael=G.is:delete Raphael;return w};w.el=ha;w.st=sa[H];G.was?s.Raphael=w:Raphael=w})();(function(){function w(v){return(v+"").replace(da,"")}function Z(v,m,u){for(var A=v.length;A<m;A++)v=u?"0"+v:v+"0";return v}function N(v){return J.call(v)==="[object Array]"}function C(v,m){if(v.indexOf)return v.indexOf(m);for(var u=0,A=v.length;u<A;u++)if(v[u]===m)return u;return-1}function U(v,m,u){var A=m["-"];m=m["+"];var D;switch(u){case "n -":A=" "+A;m=" "+m;case "n-":if(v.substr(v.length-A.length)===A)D=["-",v.substr(0,v.length-A.length)];else if(v.substr(v.length-m.length)===m)D=["+",v.substr(0,
v.length-m.length)];break;case "- n":A+=" ";m+=" ";case "-n":if(v.indexOf(A)===0)D=["-",v.substr(A.length)];else if(v.indexOf(m)===0)D=["+",v.substr(m.length)];break;case "(n)":if(v.indexOf("(")===0&&v.substr(v.length-1)===")")D=["-",v.substr(1,v.length-2)]}return D||["",v]}function n(v,m){if(!m)return 0;for(var u,A=v.getTime(),D=0,j=m.length;D<j;D++){u=m[D].start;if(u===null||A>=u)return D}return 0}function E(v){return v.split("\u00a0").join(" ").toUpperCase()}function M(v){for(var m=[],u=0,A=v.length;u<
A;u++)m[u]=E(v[u]);return m}function x(v,m,u,A){v=v.getFullYear();if(!A&&m.eras)v-=m.eras[u].offset;return v}function H(v,m){for(var u=0,A=false,D=0,j=v.length;D<j;D++){var o=v.charAt(D);switch(o){case "'":if(A)m.push("'");else u++;A=false;break;case "\\":A&&m.push("\\");A=!A;break;default:m.push(o);A=false}}return u}function h(v,m){m=m||"F";var u;u=v.patterns;var A=m.length;if(A===1){u=u[m];if(!u)throw"Invalid date format string '"+m+"'.";m=u}else if(A===2&&m.charAt(0)==="%")m=m.charAt(1);return m}
function k(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function s(v,m,u){v=w(v);u=u.calendar;a:{var A=u._parseRegExp;if(A){var D=A[m];if(D){m=D;break a}}else u._parseRegExp=A={};D=h(u,m).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var j=["^"],o=[],y=0,B=0,P=k(),R;(R=P.exec(D))!==null;){var $=D.slice(y,R.index);y=P.lastIndex;B+=H($,j);if(B%2)j.push(R[0]);else{$=R[0];var ka=$.length;switch($){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":$=
"(\\D+)";break;case "tt":case "t":$="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":$="(\\d{"+ka+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":$="(\\d\\d?)";break;case "zzz":$="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":$="([+-]?\\d\\d?)";break;case "/":$="(\\"+u["/"]+")";break;default:throw"Invalid date format pattern '"+$+"'.";}$&&j.push($);o.push(R[0])}}H(D.slice(y),j);j.push("$");D=
{regExp:j.join("").replace(/\s+/g,"\\s+"),groups:o};m=A[m]=D}B=RegExp(m.regExp).exec(v);if(B===null)return null;P=m.groups;var aa=v=null,fa=null,la=m=null;o=j=D=A=0;R=null;y=false;$=0;for(ka=P.length;$<ka;$++){var ga=B[$+1];if(ga){var ra=P[$],ba=ra.length,X=parseInt(ga,10);switch(ra){case "dd":case "d":m=X;if(m<1||m>31)return null;break;case "MMM":case "MMMM":fa=u;ba=ba===3;ra=fa.months;var na=fa.monthsGenitive||fa.months,wa=fa._upperMonths;X=fa._upperMonthsGen;if(!wa){fa._upperMonths=wa=[M(ra.names),
M(ra.namesAbbr)];fa._upperMonthsGen=X=[M(na.names),M(na.namesAbbr)]}ga=E(ga);fa=C(ba?wa[1]:wa[0],ga);if(fa<0)fa=C(ba?X[1]:X[0],ga);if(fa<0||fa>11)return null;break;case "M":case "MM":fa=X-1;if(fa<0||fa>11)return null;break;case "y":case "yy":case "yyyy":if(ba<4){aa=u;ga=X;X=new Date;ra=n(X);if(ga<100){ba=aa.twoDigitYearMax;ba=typeof ba==="string"?(new Date).getFullYear()%100+parseInt(ba,10):ba;aa=x(X,aa,ra);ga+=aa-aa%100;if(ga>ba)ga-=100}aa=ga}else aa=X;if(aa<0||aa>9999)return null;break;case "h":case "hh":A=
X;if(A===12)A=0;if(A<0||A>11)return null;break;case "H":case "HH":A=X;if(A<0||A>23)return null;break;case "m":case "mm":D=X;if(D<0||D>59)return null;break;case "s":case "ss":j=X;if(j<0||j>59)return null;break;case "tt":case "t":y=u.PM&&(ga===u.PM[0]||ga===u.PM[1]||ga===u.PM[2]);if(!y&&(!u.AM||ga!==u.AM[0]&&ga!==u.AM[1]&&ga!==u.AM[2]))return null;break;case "f":case "ff":case "fff":o=X*Math.pow(10,3-ba);if(o<0||o>999)return null;break;case "ddd":case "dddd":la=ga;ga=ba===3;X=void 0;X=u.days;ba=u._upperDays;
if(!ba)u._upperDays=ba=[M(X.names),M(X.namesAbbr),M(X.namesShort)];la=E(la);if(ga){X=C(ba[1],la);if(X===-1)X=C(ba[2],la)}else X=C(ba[0],la);la=X;if(la<0||la>6)return null;break;case "zzz":ba=ga.split(/:/);if(ba.length!==2)return null;R=parseInt(ba[0],10);if(R<-12||R>13)return null;ba=parseInt(ba[1],10);if(ba<0||ba>59)return null;R=R*60+(ga.indexOf("-")===0?-ba:ba);break;case "z":case "zz":R=X;if(R<-12||R>13)return null;R*=60;break;case "g":case "gg":if(!ga||!u.eras)return null;ga=w(ga.toLowerCase());
ba=0;for(X=u.eras.length;ba<X;ba++)if(ga===u.eras[ba].name.toLowerCase()){v=ba;break}if(v===null)return null}}}B=new Date;P=($=u.convert)?$.fromGregorian(B)[0]:B.getFullYear();if(aa===null)aa=P;else if(u.eras)aa+=u.eras[v||0].offset;if(fa===null)fa=0;if(m===null)m=1;if($){B=$.toGregorian(aa,fa,m);if(B===null)return null}else{B.setFullYear(aa,fa,m);if(B.getDate()!==m)return null;if(la!==null&&B.getDay()!==la)return null}if(y&&A<12)A+=12;B.setHours(A,D,j,o);if(R!==null){u=B.getMinutes()-(R+B.getTimezoneOffset());
B.setHours(B.getHours()+parseInt(u/60,10),u%60)}return B}function G(v,m,u){function A(ba,X){var na;na=ba+"";if(X>1&&na.length<X){na=$[X-2]+na;return na.substr(na.length-X,X)}return na}function D(){if(ka||aa)return ka;ka=fa.test(m);aa=true;return ka}function j(ba,X){if(ra)return ra[X];switch(X){case 0:return ba.getFullYear();case 1:return ba.getMonth();case 2:return ba.getDate()}}var o=u.calendar,y=o.convert;if(!m||!m.length||m==="i"){if(u&&u.name.length)if(y)u=G(v,o.patterns.F,u);else{u=new Date(v.getTime());
var B=n(v,o.eras);u.setFullYear(x(v,o,B));u=u.toLocaleString()}else u=v.toString();return u}B=o.eras;var P=m==="s";m=h(o,m);u=[];var R,$=["0","00","000"],ka,aa,fa=/([^d]|^)(d|dd)([^d]|$)/g,la=0,ga=k(),ra;if(!P&&y)ra=y.fromGregorian(v);for(;;){R=ga.lastIndex;y=ga.exec(m);R=m.slice(R,y?y.index:m.length);la+=H(R,u);if(!y)break;if(la%2)u.push(y[0]);else{R=y[0];y=R.length;switch(R){case "ddd":case "dddd":u.push((y===3?o.days.namesAbbr:o.days.names)[v.getDay()]);break;case "d":case "dd":ka=true;u.push(A(j(v,
2),y));break;case "MMM":case "MMMM":R=j(v,1);u.push(o.monthsGenitive&&D()?o.monthsGenitive[y===3?"namesAbbr":"names"][R]:o.months[y===3?"namesAbbr":"names"][R]);break;case "M":case "MM":u.push(A(j(v,1)+1,y));break;case "y":case "yy":case "yyyy":R=ra?ra[0]:x(v,o,n(v,B),P);if(y<4)R%=100;u.push(A(R,y));break;case "h":case "hh":R=v.getHours()%12;if(R===0)R=12;u.push(A(R,y));break;case "H":case "HH":u.push(A(v.getHours(),y));break;case "m":case "mm":u.push(A(v.getMinutes(),y));break;case "s":case "ss":u.push(A(v.getSeconds(),
y));break;case "t":case "tt":R=v.getHours()<12?o.AM?o.AM[0]:" ":o.PM?o.PM[0]:" ";u.push(y===1?R.charAt(0):R);break;case "f":case "ff":case "fff":u.push(A(v.getMilliseconds(),3).substr(0,y));break;case "z":case "zz":R=v.getTimezoneOffset()/60;u.push((R<=0?"+":"-")+A(Math.floor(Math.abs(R)),y));break;case "zzz":R=v.getTimezoneOffset()/60;u.push((R<=0?"+":"-")+A(Math.floor(Math.abs(R)),2)+":"+A(Math.abs(v.getTimezoneOffset()%60),2));break;case "g":case "gg":o.eras&&u.push(o.eras[n(v,B)].name);break;
case "/":u.push(o["/"]);break;default:throw"Invalid date format pattern '"+R+"'.";}}}return u.join("")}var F={},O={en:{}};O["default"]=O.en;F.extend=function(v){for(var m=arguments[1]||{},u=2,A=arguments.length;u<A;u++){var D=arguments[u];if(D)for(var j in D){var o=D[j];if(typeof o!=="undefined")if(v&&(J.call(o)==="[object Object]"||N(o))){var y=m[j];y=y&&(J.call(y)==="[object Object]"||N(y))?y:N(o)?[]:{};m[j]=this.extend(true,y,o)}else m[j]=o}}return m};F.findClosestCulture=function(v){var m;if(!v)return this.culture||
this.cultures["default"];if(J.call(v)==="[object String]")v=v.split(",");if(N(v)){var u,A=this.cultures,D=v,j,o=D.length,y=[];for(j=0;j<o;j++){v=w(D[j]);v=v.split(";");u=w(v[0]);if(v.length===1)v=1;else{v=w(v[1]);if(v.indexOf("q=")===0){v=v.substr(2);v=parseFloat(v,10);v=isNaN(v)?0:v}else v=1}y.push({lang:u,pri:v})}y.sort(function(P,R){return P.pri<R.pri?1:-1});for(j=0;j<o;j++){u=y[j].lang;if(m=A[u])return m}for(j=0;j<o;j++){u=y[j].lang;do{D=u.lastIndexOf("-");if(D===-1)break;u=u.substr(0,D);if(m=
A[u])return m}while(1)}for(j=0;j<o;j++){u=y[j].lang;for(var B in A){D=A[B];if(D.language==u)return D}}}else if(typeof v==="object")return v;return m||null};F.preferCulture=function(v){this.culture=this.findClosestCulture(v)||this.cultures["default"]};F.localize=function(v,m,u){if(typeof m!=="string")m=this.culture.name||this.culture||"default";m=this.cultures[m]||{name:m};var A=O[m.name];if(arguments.length===3){A||(A=O[m.name]={});A[v]=u}else{if(A)u=A[v];if(typeof u==="undefined"){if(A=O[m.language])u=
A[v];if(typeof u==="undefined")u=O["default"][v]}}return typeof u==="undefined"?null:u};F.format=function(v,m,u){u=this.findClosestCulture(u);if(typeof v==="number"){var A=v;if(!m||m==="i")v=u.name.length?A.toLocaleString():A.toString();else{m=m||"D";u=u.numberFormat;v=Math.abs(A);var D=-1;if(m.length>1)D=parseInt(m.slice(1),10);var j=m.charAt(0).toUpperCase(),o;switch(j){case "D":m="n";if(D!==-1)v=Z(""+v,D,true);if(A<0)v=-v;break;case "N":o=u;case "C":o=o||u.currency;case "P":o=o||u.percent;m=A<
0?o.pattern[0]:o.pattern[1]||"n";if(D===-1)D=o.decimals;b:{var y=v*(j==="P"?100:1);j=o;o=j.groupSizes;v=o[0];A=1;var B=Math.pow(10,D),P=Math.round(y*B)/B;isFinite(P)||(P=y);B="";B=(P+"").split(/e/i);P=B.length>1?parseInt(B[1],10):0;y=B[0];B=y.split(".");y=B[0];B=B.length>1?B[1]:"";if(P>0){B=Z(B,P,false);y+=B.slice(0,P);B=B.substr(P)}else if(P<0){P=-P;y=Z(y,P+1);B=y.slice(-P,y.length)+B;y=y.slice(0,-P)}B=D>0?j["."]+(B.length>D?B.slice(0,D):Z(B,D)):"";D=y.length-1;j=j[","];for(P="";D>=0;){if(v===0||
v>D){v=y.slice(0,D+1)+(P.length?j+P+B:B);break b}P=y.slice(D-v+1,D+1)+(P.length?j+P:"");D-=v;if(A<o.length){v=o[A];A++}}v=y.slice(0,D+1)+j+P+B}break;default:throw"Bad number format specifier: "+j;}o=/n|\$|-|%/g;for(A="";;){D=o.lastIndex;j=o.exec(m);A+=m.slice(D,j?j.index:m.length);if(!j)break;switch(j[0]){case "n":A+=v;break;case "$":A+=u.currency.symbol;break;case "-":if(/[1-9]/.test(v))A+=u["-"];break;case "%":A+=u.percent.symbol}}v=A}}else if(v instanceof Date)v=G(v,m,u);return v};F.parseInt=function(v,
m,u){return Math.floor(this.parseFloat(v,m,u))};F.parseFloat=function(v,m,u){if(typeof m==="string"){u=m;m=10}u=this.findClosestCulture(u);var A=NaN,D=u.numberFormat;if(v.indexOf(u.numberFormat.currency.symbol)>-1){v=v.replace(u.numberFormat.currency.symbol,"");v=v.replace(u.numberFormat.currency["."],u.numberFormat["."])}v=w(v);if(W.test(v))A=parseFloat(v,m);else if(!m&&f.test(v))A=parseInt(v,16);else{u=U(v,D,D.pattern[0]);m=u[0];u=u[1];if(m===""&&D.pattern[0]!=="-n"){u=U(v,D,"-n");m=u[0];u=u[1]}m=
m||"+";var j;v=u.indexOf("e");if(v<0)v=u.indexOf("E");if(v<0){j=u;v=null}else{j=u.substr(0,v);v=u.substr(v+1)}var o=D["."],y=j.indexOf(o);if(y<0){u=j;j=null}else{u=j.substr(0,y);j=j.substr(y+o.length)}o=D[","];u=u.split(o).join("");y=o.replace(/\u00A0/g," ");if(o!==y)u=u.split(y).join("");m+=u;if(j!==null)m+="."+j;if(v!==null){D=U(v,D,"-n");m+="e"+(D[0]||"+")+D[1]}if(z.test(m))A=parseFloat(m)}return A};F.parseDate=function(v,m,u){u=this.findClosestCulture(u);var A,D;if(m){if(typeof m==="string")m=
[m];if(m.length){D=0;for(var j=m.length;D<j;D++){var o=m[D];if(o)if(A=s(v,o,u))break}}}else{m=u.calendar.patterns;for(D in m)if(A=s(v,m[D],u))break}return A||null};var S=F.cultures=F.cultures||{};S=S["default"]=S.en=F.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)",
"$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},S.en);S.calendar=S.calendar||S.calendars.standard;var da=/^\s+|\s+$/g,W=/^[+-]?infinity$/i,f=/^0x[a-f0-9]+$/i,z=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,J=Object.prototype.toString;
jQuery.global=F})();/*

 jQuery Tiny Pub/Sub - v0.3pre - 11/4/2010
 http://benalman.com/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/
*/
(function(w){var Z=w({});w.subscribe=function(){Z.bind.apply(Z,arguments)};w.unsubscribe=function(){Z.unbind.apply(Z,arguments)};w.publish=function(){Z.trigger.apply(Z,arguments)}})(jQuery);/*
 
 copyright 2011, Mnemograph LLC
 Timeglider for Javascript / jQuery 
 http://timeglider.com/jquery

 Licensed under the MIT open source license
 http://timeglider.com/jquery/?p=license

*/
var timeglider=window.timeglider={version:"0.1.0"};
(function(w){w=timeglider;var Z=jQuery,N={},C={},U={},n={},E={};w.TG_Date=function(x,H){function h(F){var O=Math.abs(F.rd)*86400,S=F.ho*3600,da=(F.mi-1)*60,W=1;if(F.rd<0)W=-1;return W*(O+S+da)}var k,s,G;if(typeof x=="number"){k=s=M.getDateFromSec(x);G=x}else{if(x=="today")x=M.getToday();k=s=x}if(function(F){F=jQuery.trim(F);reg=RegExp(/[T0-9-: ]/);return reg.test(F)?F:false}(k)===false)return{error:"Invalid date"};else{k=k.replace(",","");if(k.substr(0,1)=="-"){this.bce=1;k=k.substr(1)}else this.bce=
0;k=k.replace(/[^0-9]/g,"-");k=k.split("-");this.ye=this.bce===0?parseInt(k[0],10):-1*parseInt(k[0],10);this.mo=parseInt(k[1],10);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));this.da=parseInt(k[2],10);this.ho=parseInt(k[3],10)||0;this.mi=parseInt(k[4],10)||0;this.se=parseInt(k[5],10)||0;this.rd=M.getRataDie(this);this.sec=G||h(this);this.date_display=H?H.toLowerCase().substr(0,2):"";this.jsDate=new Date(this.ye,this.mo-1,this.da,this.ho,this.mi,this.se,
0);this.dateStr=s}};var M=w.TG_Date;M.getTimeUnitSerial=function(x,H){var h=0;switch(H){case "ye":h=x.ye;break;case "mo":h=x.mo_num;break;case "da":h=x.rd;break;case "de":h=Math.floor(x.ye/10);break;case "ce":h=Math.floor(x.ye/100);break;case "thou":h=Math.floor(x.ye/1E3);break;case "tenthou":h=Math.floor(x.ye/1E4);break;case "hundredthou":h=Math.floor(x.ye/1E5);break;case "mill":h=Math.floor(x.ye/1E6);break;case "tenmill":h=Math.floor(x.ye/1E7);break;case "hundredmill":h=Math.floor(x.ye/1E8);break;
case "bill":h=Math.floor(x.ye/1E9)}return h};M.getMonthDays=function(x,H){return M.isLeapYear(H)==true&&x==2?29:M.monthsDayNums[x]};M.twentyFourToTwelve=function(x){var H={};H.ye=x.ye;H.mo=x.mo;H.da=x.da;H.ho=x.ho;H.mi=x.mi;H.ampm="am";if(x.ho)if(x.ho>=12){H.ampm="pm";H.ho=x.ho>12?x.ho-12:12}else if(x.ho==0){H.ho=12;H.ampm="am"}else H.ho=x.ho;else{H.ho=12;H.mi=0;H.ampm="am"}return H};M.getMonthAdj=function(x,H){var h=M.getDateFromMonthNum(x);switch(h.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:h=
Math.floor(H+H/28*3);return{width:h,days:31};case 2:if(M.isLeapYear(h.ye)==true){h=Math.floor(H+H/28);return{width:h,days:29}}else return{width:H,days:28};default:h=Math.floor(H+H/28*2);return{width:h,days:30}}};M.getDateFromMonthNum=function(x){var H=0;if(x>0){H=x%12;if(H==0)H=12;x=Math.ceil(x/12)}else{H=Math.abs(x)%12;H=12-H+1;if(H==13)H=1;x=-1*Math.ceil(Math.abs(x)/12)}return{ye:x,mo:H}};M.getMonthWidth=function(x,H,h){H=t/28;var k;switch(x){case 1:case 3:case 5:case 7:case 8:case 10:case 12:k=
3;break;case 4:case 6:case 9:case 11:k=2;break;case 2:k=M.isLeapYear(yr)==true?1:0}return{width:Math.floor(h+H*k),numDays:28+k}};M.getToday=function(){var x=new Date;return x.getFullYear()+"-"+(x.getMonth()+1)+"-"+x.getDate()+" "+x.getHours()+":"+x.getMinutes()+":00"};M.getMonthFromRemDays=function(x,H){var h=0;var k=h=0;h=M.isLeapYear(H)?1:0;if(x<=31){k=1;h=x}else if(x>31&&x<=59+h){k=2;h=x-(31+h)}else if(x>59+h&&x<=90+h){k=3;h=x-(59+h)}else if(x>90+h&&x<=120+h){k=4;h=x-(90+h)}else if(x>120+h&&x<=
151+h){k=5;h=x-(120+h)}else if(x>151+h&&x<=181+h){k=6;h=x-(151+h)}else if(x>181+h&&x<=212+h){k=7;h=x-(181+h)}else if(x>212+h&&x<=243+h){k=8;h=x-(212+h)}else if(x>243+h&&x<=273+h){k=9;h=x-(243+h)}else if(x>273+h&&x<=304+h){k=10;h=x-(273+h)}else if(x>304+h&&x<=334+h){k=11;h=x-(304+h)}else{k=12;h=x-(334+h)}return{mo:k,da:h}};M.getDateFromRD=function(x){if(n[x])return n[x];for(var H=Math.floor(x),h=Math.floor(H/146097)*400,k=H-Math.floor(H/146097)*146097,s=1,G=h+1,F=G+400;G<=F;G++)if(k>365){k-=365;if(M.isLeapYear(G))k-=
1;s++}else G=F;h+=s;if(k==0)k=1;k=M.getMonthFromRemDays(k,h);s=(x-H)*1440;H=Math.floor(s%60);s=Math.floor(s/60);if(M.isLeapYear(h)&&k.mo==2)k.da+=1;H=h+"-"+k.mo+"-"+k.da+" "+s+":"+H+":00";return n[x]=H};M.getDateFromSec=function(x){if(E[x])return E[x];var H=M.getDateFromRD(x/86400);return E[x]=H};M.isLeapYear=function(x){return x%400==0?true:x%100==0?false:x%4==0?true:false};M.getRataDie=function(x){function H(S,da){if(C[S+"-"+da])return C[S+"-"+da];for(var W=0,f=S;f<da;f++)W+=M.isLeapYear(f)?366:
365;return C[S+"-"+da]=W}function h(S,da){var W;switch(S){case 1:W=0;break;case 2:W=31;break;case 3:W=59;break;case 4:W=90;break;case 5:W=120;break;case 6:W=151;break;case 7:W=181;break;case 8:W=212;break;case 9:W=243;break;case 10:W=273;break;case 11:W=304;break;case 12:W=334}if(S>2)if(M.isLeapYear(da))W+=1;return W}var k=x.ye,s=x.mo;x=x.da;var G=0;if(N[k+"-"+s+"-"+x])return N[k+"-"+s+"-"+x];if(k>=0){if(k==0)k=1;G=Math.floor(k/400)*146097;var F=parseInt(H(k-k%400,k)),O=parseInt(h(s,k));G=G+F+O+x-
366}else if(k<0)G=M.getBCRataDie({ye:k,mo:s,da:x});return N[k+"-"+s+"-"+x]=G};M.getBCRataDie=function(x){var H=x.ye,h=x.mo;x=x.da;if(U[H+"-"+h+"-"+x])return U[H+"-"+h+"-"+x];if(h==0)h=1;if(x==0)x=1;var k=-1*((Math.abs(H)-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][h]+(M.monthsDayNums[h]-x+1));return U[H+"-"+h+"-"+x]=k};M.setCulture=function(x){jQuery.global.culture=jQuery.global.cultures[x];M.monthNames=Z.merge([""],jQuery.global.culture.calendar.months.names);M.monthNamesAbbr=Z.merge([""],
jQuery.global.culture.calendar.months.namesAbbr);M.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];M.monthsDayNums=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];M.dayNames=jQuery.global.culture.calendar.days.names;M.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;M.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;M.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];M.patterns=jQuery.global.culture.calendar.patterns};
M.prototype={format:function(x,H){if(H==true)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":x="yyyy";break;case "mo":x="Y";break;case "da":x="D";break;case "ho":x="f";break;default:x="f"}return Z.global.format(this.jsDate,x)}}})(timeglider);(function(w){var Z=w.levelHeight=10,N=jQuery;w.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var C=this;this.addBlock=function(E,M){E.right=E.left+E.width;E.bottom=E.top+E.height;E.tickScope=M;C.blocks.push(E)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(E,M){if(E=="sweep"){C.tree=[];for(var x=0;x<300;x++)C.tree[x]=[];this.vis=[]}this.blocks.sort(U);var H,h="",k="";b_htm=html="";b={};blength=this.blocks.length;for(var s=
title_adj=0;s<blength;s++){b=this.blocks[s];if(b.tickScope==E)if(N.inArray(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div"){b_htm="<div style='left:"+b.left+"px' id='ev_"+b.id+"'"+b.html.substr(4);html+=b_htm}else{if(b.image){if(b.image.display_class=="layout")title_adj=b.image.height+4;h="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else h="";n(b,0);if(b.y_position>0)b.top=-1*b.y_position;b.fontsize<10?
b.opacity=b.fontsize/10:b.opacity=1;if(b.span==true){x="timeglider-event-spanning";H="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"}else H=x="";k=b.icon?"<img class='timeglider-event-icon' src='"+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";html+=Math.abs(b.top)>M-16?"<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(M-Math.floor(16/3))+"px'>+</div>":"<div class='timeglider-timeline-event "+
x+"' id='ev_"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+k+h+H+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>"}}}return html};var U=function(E,M){var x=M.importance,H=E.importance;return x<H?-1:x>H?1:0},n=function(E,M){var x=false,H=C.tree,h=H[M],k=M+1,s=false,G=2;bump_ht=Z;if(h!=undefined){for(G=0;G<h.length;G++){a:{x=h[G];if(!(E.left>x.right||E.right<x.left))if(E.left>=
x.left&&E.left<=x.right||E.right>=x.left&&E.right<=x.right||E.right>=x.right&&E.left<=x.left||E.right<=x.right&&E.left>=x.left)if(E.bottom<=x.bottom&&E.bottom>=x.top||E.top<=x.bottom&&E.top>=x.top||E.top==x.bottom&&E.top==x.top){x=true;break a}x=false}if(x==true){E.top-=bump_ht;E.bottom-=bump_ht;n(E,k);s=true;break}}if(s==false){E.top-=E.fontsize;h.push(E);G=Math.ceil(E.height/Z);h=0;for(h=1;h<=G;h++){k=M+h;H[k].push(E)}}}}}})(timeglider);(function(w){function Z(E){function M(k,s){return function(){return s.apply(k,arguments)}}var x=new Image,H=E.id,h=x.src=E.src;x.onerror=M(x,function(){n.reportImageSize({id:E.id,src:h,error:true})});x.onload=M(x,function(){n.reportImageSize({id:H,src:h,width:this.width,height:this.height})})}var N=w.TG_Date,C=jQuery,U={},n;w.TG_Timeline=Backbone.Model.extend({defaults:{title:"Untitled",events:[],legend:[]},_chewTimeline:function(E){n=E.mediator;U=n.options;var M={da:[],mo:[],ye:[],de:[],ce:[],thou:[],
tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},x=N.units;E.startSeconds=[];E.endSeconds=[];E.spans=[];E.hasImagesAbove=false;if(!E.color)E.color="#333333";if(E.events){for(var H,h,k,s,G=E.events.length,F=0;F<G;F++){h=E.events[F];if(h.id)k=h.id;else h.id=k="anon"+this.anonEventId++;H=h.date_display||h.date_limit||"da";h.date_display=H.toLowerCase().substr(0,2);h.startdateObj=new N(h.startdate,h.date_display);h.enddateObj=new N(h.enddate,h.date_display);h.icon=!h.icon||h.icon===
"none"?"":U.icon_folder+h.icon;h.titleWidth=w.getStringWidth(h.title);if(h.image){H=h.image_class||"layout";if(h.image_class=="above")E.hasImagesAbove=true;h.image={id:h.id,src:h.image,display_class:H};Z(h.image);n.imagesToSize++}E.startSeconds.push(h.startdateObj.sec);E.endSeconds.push(h.enddateObj.sec);if(h.enddateObj.sec>h.startdateObj.sec){h.span=true;E.spans.push({id:h.id,start:h.startdateObj.sec,end:h.enddateObj.sec})}else h.span=false;for(var O=x.length,S=0;S<O;S++){H=x[S];s=N.getTimeUnitSerial(h.startdateObj,
H);if(M[H][s]!==undefined)M[H][s].push(k);else M[H][s]=[k]}n.eventPool["ev_"+k]=h}x=C.merge(E.startSeconds,E.endSeconds);x=timeglider.getLowHigh(x);E.bounds={first:x.low,last:x.high}}if(E.legend.length>0){x=E.legend;for(h=0;h<x.length;h++);}E.display="expanded";E.dateHash=M;delete E.events;return E},initialize:function(E){this.set(this._chewTimeline(E))},validate:function(){}})})(timeglider);(function(w){var Z=w.TG_Date,N="",C="",U={},n=jQuery,E={},M="",x,H;debug.trace=function(h,k){n("#"+k).text(h)};w.TG_TimelineView=function(h,k){var s=this;C=k;U=C.options;N="#"+h._id;M=h._id;this._views={PLACE:N,CONTAINER:N+" .timeglider-container",TIMELINE_MENU:N+" .timeglider-timeline-menu",TIMELINE_MENU_UL:N+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:N+" .timeglider-list-bt",SLIDER_CONTAINER:N+" .timeglider-slider-container",SLIDER:N+" .timeglider-slider",ZOOM_DISPLAY:N+" .timeglider-zoomlevel-display",
TRUCK:N+" .timeglider-truck",CENTERLINE:N+" .timeglider-centerline",TICKS:N+" .timeglider-ticks",HANDLE:N+" .timeglider-handle",FOOTER:N+" .timeglider-footer",FILTER_BT:N+" .timeglider-filter-bt",FILTER_BOX:N+" .timeglider-filter-box",TOOLS_BT:N+" .timeglider-tools-bt"};x=this._views.CONTAINER;H=this._views.TICKS;this._templates={};this._templates={test:"testola",event_modal:this.getEventModalTemplate(),event_modal_video:n.template(null,"<div class='tg-modal timeglider-ev-video-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><iframe width = '100%' height='300' src='${video}'></iframe></div>"),
timeline_modal:n.template(null,"<div class='tg-modal timeglider-timeline-modal ui-widget-content' id='tl_${id}_modal'><div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p></div>"),filter_modal:n.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box timeglider-menu-hidden'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:n.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu timeglider-menu-hidden'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),legend_modal:n.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-menu-hidden'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};
n(x).css("height",n(N).height());this.basicFontSize=U.basic_fontsize;U.show_footer==false&&n(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();n.subscribe("mediator.timelineDataLoaded",function(){n(".timeglider-loading").fadeOut(500)});n.subscribe("mediator.ticksOffsetChange",
function(){s.tickHangies();s.registerTitles();s.registerDragging()});n.subscribe("mediator.zoomLevelChange",function(){s.tickNum=0;s.leftside=0;var F=C.getZoomLevel();n(s._views.SLIDER).slider("value",s.invSliderVal(F));s.displayZoomLevel(F);s.castTicks("zoomLevelChange")});n.subscribe("mediator.ticksReadySignal",function(){C.ticksReady===true&&s.freshTimelines()});n.subscribe("mediator.refreshSignal",function(){s.tickNum=0;s.leftside=0;s.castTicks("refreshSignal")});n.subscribe("mediator.ticksArrayChange",
function(){});n.subscribe("mediator.focusDateChange",function(){});n.subscribe("mediator.timelineListChangeSignal",function(){s.buildTimelineMenu()});n.subscribe("mediator.activeTimelinesChange",function(){n(s._views.TIMELINE_MENU_UL+" li").each(function(){var F=n(this).attr("id");n.inArray(F,C.activeTimelines)!=-1?n(this).addClass("activeTimeline"):n(this).removeClass("activeTimeline")})});n.subscribe("mediator.filterChange",function(){});this.setPanButton(n(".timeglider-pan-right"),-30);this.setPanButton(n(".timeglider-pan-left"),
30);n(this._views.TRUCK).dblclick(function(F){var O=F.pageX-s.dimensions.container.offset.left-s.dimensions.container.width/2,S=C.getZoomInfo().spp;F=C.getFocusDate().sec;O=new Z(Math.floor(F+O*S));F=new Z(F);debug.trace("DBLCLICK:"+F.mo+"-"+F.ye+" DBLCLICK:"+O.mo+"-"+O.ye,"note")}).bind("mousewheel",function(F,O){var S=Math.ceil(-1*O*3),da=C.getZoomLevel();C.setZoomLevel(da+S);return false});n(H).draggable({axis:"x",drag:function(){C.setTicksOffset(n(this).position().left)},stop:function(){s.resetTicksHandle();
s.registerDragging()}}).delegate(x+" .timeglider-timeline-event","click",function(){var F=n(this).attr("id"),O=C.eventPool[F];if(O.click_callback){F=O.click_callback.split(".");var S=F[0];if(F.length==2)window[S][F[1]](O);else window[S](O)}else s.eventModal(F)}).delegate(".timeglider-timeline-event","mouseover",function(){var F=n(this).attr("id");F=C.eventPool[F];debug.trace("hover, title:"+F.title,"note");s.eventHover(n(this),F)}).delegate(".timeglider-timeline-event","mouseout",function(){var F=
n(this).attr("id");F=C.eventPool[F];debug.trace("hover, title:"+F.title,"note");s.eventUnHover(n(this),F)}).delegate(".timeglider-event-collapsed","hover",function(){var F=n(this).attr("id");debug.trace("collapsed, title:"+C.eventPool[F].title,"note")});n(x).delegate(".close-button-remove","click",function(){var F=n(this).parent().attr("id");n("#"+F).remove()});n(x).delegate(".full_modal_close","click",function(){n(".full_modal").remove()});n(x).delegate(".full_modal_scrim","click",function(){n(".full_modal").remove()});
n(x).delegate(".timeglider-more-plus","click",function(){C.zoom(-1)});n(x+" .timeglider-legend-close").live("click",function(){var F=n(x+" .timeglider-legend");F.fadeOut(300,function(){F.remove()})});n(x+" .timeglider-legend-all").live("click",function(){n(x+" .timeglider-legend li").each(function(){n(this).removeClass("tg-legend-icon-selected")});C.setFilters({origin:"legend",icon:"all"})});n.tmpl(s._templates.timeline_list_modal,{}).appendTo(x);n(s._views.TIMELINE_LIST_BT).click(function(){n(s._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden").position({my:"right bottom",
at:"right top",of:n(s._views.TIMELINE_LIST_BT),offset:"-8, -12"})});n(this._views.TIMELINE_MENU+" .close-button").live("click",function(){n(s._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden")});n(this._views.TOOLS_BT).click(function(){alert("I'm just a stand-in for the tools... ")});C.options.show_centerline===true?n(this._views.CENTERLINE).css({height:s.dimensions.container.height,left:s.dimensions.container.centerx}):n(this._views.CENTERLINE).css({display:"none"});if(n.support.touch){n("#"+
M).addTouch();var G=document.getElementById(M);G.addEventListener("gesturestart",function(F){F.preventDefault();n("#output").append("<br>gesture zoom:"+C.getZoomLevel())},false);G.addEventListener("gestureend",function(F){F.preventDefault();n("#output").append("<br>gesture end:"+C.getZoomLevel())},false);G.addEventListener("gesturechange",function(F){F.preventDefault();n("#output").append("[l:r]")},false)}};w.TG_TimelineView.prototype={getWidgetDimensions:function(){var h=n(x),k=h.width(),s=Math.floor(k/
2)+1,G=h.height(),F=Math.floor(G/2),O=h.position().left;h=h.offset();var S=U.show_footer==true?n(this._views.FOOTER).height():0;return{container:{width:k,height:G,centerx:s,centery:F,left:O,offset:h},tick:{top:G-S-30},footer:{height:S}}},getEventModalTemplate:function(){var h=this,k=false,s="",G=n.template(null,"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='ev_${id}_modal'><div class='close-button-remove'></div><div class='startdate'>${startdate}</div><h4 id='title'>${title}</h4><p>{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>");
if(U.event_modal.href)n.ajax({url:U.event_modal.href,success:function(F){s=F.removeWhitespace();debug.log("stripped:"+s);h._templates.event_modal=k=n.template(null,s)},error:function(){h._templates.event_modal=k=G;debug.log("Custom event modal HTML file could not be found/loaded! Reverting to default.")}});else k=G;return k},scaleToImportance:function(h,k){return h/k},displayZoomLevel:function(h){h>0&&U.display_zoom_level==true&&n(this._views.ZOOM_DISPLAY).text(h)},doSomething:function(){alert("FOO DO, viewer")},
setPanButton:function(h,k){var s=this;n(h).live("mousedown",function(){s.intervalMachine("pan",{type:"set",fn:s.pan,args:[k],intvl:33})}).live("mouseup",function(){s.intervalMachine("pan",{type:"clear",fn:s.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){s.intervalMachine("pan",{type:"clear",fn:s.pan,callback:"resetTicksHandle"})})},intervalMachine:function(h,k){var s=this;if(k.type==="clear"){clearInterval(E[h]);if(k.callback)s[k.callback]()}else E[h]=setInterval(function(){k.fn.apply(s,
k.args)},k.intvl)},invSliderVal:function(h){return Math.abs(h-101)},pan:function(h){h=h||20;$t=n(H);newPos=$t.position().left+h;$t.css({left:newPos});C.setTicksOffset(newPos)},registerTitles:function(){var h,k,s,G,F,O,S,da,W,f,z,J=n(x).offset().left;n(".timeglider-event-spanning").each(function(){h=n(this).offset().left-J;k=n(this).outerWidth();S=n(".timeglider-event-title",this);s=S.outerWidth()+5;G=S.siblings(".timeglider-event-spanner").outerWidth();G>s&&h<0&&Math.abs(h)<k-s&&S.css({marginLeft:-1*
h+5})});n(".tg-timeline-envelope").each(function(){da=n(this).offset().left-J;W=n(".titleBar",this);f=n(".titleBar .timeline-title",this);F=W.position().left;z=F+da;W.outerWidth();s=W.outerWidth();O=-1*z;z<0&&f.css({marginLeft:O+5})})},registerDragging:function(){var h=C.startSec,k=n(H).position().left,s=C.getZoomInfo().spp;h=new Z(h-k*s);C.setFocusDate(h)},buildTimelineMenu:function(){var h,k=C.timelinePool,s=0;n(this._views.TIMELINE_MENU_UL+" li").remove();for(h in k){if(k.hasOwnProperty(h)){var G=
k[h];n(this._views.TIMELINE_MENU_UL).append("<li class = 'timelineList' id='"+h+"'>"+G.title+"</li>");n("li#"+h).click(function(){C.toggleTimeline(n(this).attr("id"))})}s++}},buildSlider:function(){var h=C.getZoomLevel();if(U.min_zoom==U.max_zoom)n(this._views.SLIDER_CONTAINER).css("display","none");else{U.display_zoom_level==true&&n("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var k=this;h=k.invSliderVal(h);var s=C.max_zoom,G=C.min_zoom;
n(this._views.SLIDER).css("height",(1+s-G)*3).slider({steps:100,handle:n(".knob"),animate:300,orientation:"vertical",min:k.invSliderVal(s),max:k.invSliderVal(G),value:h,start:function(){k.sliderActive=true},stop:function(){k.sliderActive=false},change:function(){},slide:function(F,O){C.setZoomLevel(k.invSliderVal(O.value))}})}},eventHover:function(h,k){var s=n(".timeglider-event-hover-info");k.date_display!="no"&&s.position({my:"left bottom",at:"left top",of:h,offset:"1, -10",collision:"flip flip"}).text(k.startdateObj.format("D",
true));h.addClass("tg-event-hovered")},eventUnHover:function(h){n(".timeglider-event-hover-info").css("left","-1000px");h.removeClass("tg-event-hovered")},setupFilter:function(){var h=this;n.tmpl(h._templates.filter_modal,{}).appendTo(h._views.CONTAINER);n(h._views.FILTER_BT).click(function(){var k=n(this),s=h._views.FILTER_BOX;if(h.filterBoxActivated==false){h.filterBoxActivated=true;var G=n(s+" .timeglider-filter-apply"),F=n(".timeglider-filter-box .close-button"),O=n(s+" .timeglider-filter-clear"),
S="",da="";G.click(function(){S=n(s+" .timeglider-filter-include").val();da=n(s+" .timeglider-filter-exclude").val();C.setFilters({origin:"clude",include:S,exclude:da});n(s).toggleClass("timeglider-menu-shown")});F.click(function(){n(s).toggleClass("timeglider-menu-hidden")});O.click(function(){C.setFilters({origin:"clude",include:"",exclude:""});n(s+" .timeglider-filter-include").val("");n(s+" .timeglider-filter-exclude").val("");n(s).toggleClass("timeglider-menu-shown")})}n(s).toggleClass("timeglider-menu-hidden").css("z-index",
h.ztop++).position({my:"right bottom",at:"right top",of:k,offset:"-8, -12"})})},clearTicks:function(){this.tickNum=this.leftside=0;n(H).css("left",0).html("<div class='timeglider-handle'></div>")},castTicks:function(){this.clearTicks();C.getZoomLevel();var h=C.getFocusDate(),k=C.getZoomInfo().width;k=Math.ceil(this.dimensions.container.width/k)+4;var s="l";C.setTicksReady(false);this.addTick({type:"init",focus_date:h});for(h=1;h<=k;h+=1){this.addTick({type:s});s=s=="l"?"r":"l"}C.setTicksReady(true)},
addTick:function(h){var k=0,s=0,G=s=0,F=0,O=0,S="";O={};G={};var da={},W={};O={};da=C.getZoomInfo().unit;W=C.getZoomInfo().width;F=C.getFocusDate();G=parseInt(this.dimensions.tick.top);F=C.addToTicksArray({type:h.type,unit:da},F);var f="",z=0;S="";if(da=="mo"){O=Z.getMonthAdj(F,W);W=O.width;k=O.days}this.tickNum++;if(h.type=="init"){O=this.tickOffsetFromDate(C.getZoomInfo(),C.getFocusDate(),W);this.leftside=s=Math.ceil(this.dimensions.container.centerx+O);this.rightside=s+W}else if(h.type=="l")this.leftside=
s=Math.floor(this.leftside-W);else if(h.type=="r"){s=Math.floor(this.rightside);this.rightside+=W}C.getTickBySerial(F).width=W;C.getTickBySerial(F).left=s;S=this._views.PLACE+"_"+da+"_"+F+"-"+this.tickNum;O=n("<div class='timeglider-tick' id='"+S+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(H);O.css({width:W,left:s,top:G});G=this.getTickMarksInfo({unit:da,width:W});G=k||G.tperu;s=W/G;if(s>5){h=Raphael(S,W,30);var J="";for(k=0;k<G;++k){S=k*s;J+="M"+S+" 20 L"+S+" 30";if(da==
"da"&&s>16){S=this.getHourLabelFromHour(z,s);f+="<div class='timeglider-tick-hour-label' style='width:"+(s-4)+"px'>"+S+"</div>";z++}}h.path(J).attr({stroke:"#333","stroke-width":1})}da=="da"&&s>32&&O.append("<div style='position:absolute;top:14px;left:0'>"+f+"</div>");da={unit:da,width:W,serial:F};W=this.getDateLabelForTick(da);O.children("#label").text(W);return da},getHourLabelFromHour:function(h,k){var s="";s=s="";s=h>12?h-12:h;if(s==0)s=12;return s+(k>60?":00":"")+(h>11?" pm":" am")},getTickMarksInfo:function(h){switch(h.unit){case "da":h=
24;break;case "mo":h=30;break;case "ye":h=12;break;default:h=10}return{tperu:h}},getDateLabelForTick:function(h){var k=h.serial,s=h.width;switch(h.unit){case "bill":return k==0?"1":k>0?k+" billion":k+" b.y. bce";case "hundredmill":return k==0?"1":k>0?k+"00 million":k+"00 m.y. bce";case "tenmill":return k==0?"1":k>0?k+"0 million":k+"0 m.y. bce";case "mill":return k==0?"1":k>0?k+" million":k+" m.y. bce";case "hundredthou":return k==0?"1":k>0?k+"00,000":k+"00,000 bce";case "tenthou":return k==0?"1":
k>0?k+"0,000":k+"0,000 bce";case "thou":return k==0?"1("+k+")":k>0?k+"000":k+"000 bce";case "ce":return k==0?"1("+k+")":k>0?k+"00":k+"00 bce";case "de":return(k-1)*10+"s";case "ye":return k;case "mo":h=Z.getDateFromMonthNum(k);return s<120?Z.monthNamesAbbr[h.mo]+" "+h.ye:Z.monthNames[h.mo]+", "+h.ye;case "da":h=new Z(Z.getDateFromRD(k));return s<120?Z.monthNamesAbbr[h.mo]+" "+h.da+", "+h.ye:Z.monthNames[h.mo]+" "+h.da+", "+h.ye;default:return h.unit+":"+k+":"+s}},tickHangies:function(){var h=n(H).position().left,
k=this.rightside+h-this.dimensions.container.width;if(this.leftside+h>-100){h=this.addTick({type:"l"});this.appendTimelines(h)}else if(k<100){h=this.addTick({type:"r"});this.appendTimelines(h)}},tickOffsetFromDate:function(h,k,s){switch(h.unit){case "da":k=k.ho/24+k.mi/1440;s*=k;break;case "mo":h=Z.getMonthDays(k.mo,k.ye);k=(k.da-1)/h+k.ho/(24*h)+k.mi/(1440*h);s*=k;break;case "ye":k=((k.mo-1)*30+k.da)/365;s*=k;break;case "de":k=k.ye%10/10+k.mo/120;s*=k;break;case "ce":k=k.ye%100/100+k.mo/1200;s*=
k;break;case "thou":k=k.ye%1E3/1E3;s*=k;break;case "tenthou":k=k.ye%1E4/1E4;s*=k;break;case "hundredthou":k=k.ye%1E5/1E5;s*=k;break;default:s=0}return-1*s},resetTicksHandle:function(){n(this._views.HANDLE).offset({left:n(x).offset().left})},easeOutTicks:function(){Math.abs(this.dragSpeed)>5&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(h){var k=h.tick.unit,s=h.tick.serial;h=h.timeline.dateHash;return h[k][s]&&h[k][s].length>0?h[k][s]:0},setTimelineProp:function(h,k,s){C.timelinePool[h][k]=
s},getTimelineProp:function(h,k){return C.timelinePool[h][k]},passesFilters:function(h,k){var s=true,G="",F=[],O;G="";F=[];if(k<h.low_threshold||k>h.high_threshold)return false;if(G=C.filters.include){F=G.split(",");s=false;for(O=0;O<F.length;O++){G=RegExp(n.trim(F[O]),"i");if(h.title.match(G))s=true}}if(G=C.filters.exclude){F=G.split(",");for(O=0;O<F.length;O++){G=RegExp(n.trim(F[O]),"i");if(h.title.match(G))s=false}}G=h.icon;if(C.filters.legend.length>0)if(n.inArray(G,C.filters.legend)==-1)s=false;
return s},freshTimelines:function(){var h,k,s,G,F=C.activeTimelines,O=C.ticksArray,S="",da,W=this;k="";var f=W.dimensions.container.centerx,z=W.dimensions.container.width,J=C.getFocusDate().sec,v=C.getZoomInfo().spp;C.getZoomInfo();k=[];var m=[];z=J-Math.floor(v*(z/2));k="";for(var u,A=0,D=W.dimensions.container.height,j=A=0;j<F.length;j++){h=C.timelinePool[F[j]];u=h.display;A=h.top?parseInt(h.top.replace("px","")):D-120;k=h.legend.length>0?"<span class='tg-timeline-legend-bt'>legend</span>":"";$tl=
n("<div class='tg-timeline-envelope' id='"+h.id+"'><div class='titleBar'><div class='timeline-title'>"+h.title+"<div class='tg-timeline-env-buttons'><span class='timeline-info'>info</span>"+k+"</div></div></div></div>").appendTo(H);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){W.setTimelineProp(h.id,"top",n(this).css("top"));C.refresh()}}).css("top",A);k=$tl.height();n(x+" .tg-timeline-envelope#"+h.id+" .titleBar .expand-collapse").click(function(){W.expandCollapseTimeline(h.id)});n(x+
" .tg-timeline-envelope#"+h.id+" .titleBar .timeline-info").click(function(){W.timelineModal(h.id)});n(x+" .tg-timeline-envelope#"+h.id+" .titleBar .tg-timeline-legend-bt").click(function(){W.legendModal(h.id)});da=$tl.children(".titleBar");s=f+(h.bounds.first-J)/v;G=f+(h.bounds.last-J)/v;da.css({top:k,left:s,width:G-s});if(u=="expanded")h.borg=S=new timeglider.TG_Org;for(s=0;s<O.length;s++){k=this.getTimelineEventsByTick({tick:O[s],timeline:h});n.merge(m,k)}for(s=0;s<h.spans.length;s++){k=h.spans[s];
k.start<z&&k.end>z&&n.inArray(k.id,m)==-1&&m.unshift(k.id)}k=this.compileTickEventsAsHtml(h,m,0,"sweep");A=h.hasImagesAbove?A-56:A;if(u=="expanded"){k=S.getHTML("sweep",A);h.borg=S.getBorg()}k!="undefined"&&$tl.append(k);this.registerEventImages($tl)}W.registerTitles()},appendTimelines:function(h){for(var k=C.activeTimelines,s,G="",F=0;F<k.length;F++){s=C.timelinePool[k[F]];idArr=this.getTimelineEventsByTick({tick:h,timeline:s});G=this.compileTickEventsAsHtml(s,idArr,h.serial,"append");if(s.display==
"expanded")G=s.borg.getHTML(h.serial,s.top);s=n(".tg-timeline-envelope#"+s.id).append(G);this.registerEventImages(s)}},compileTickEventsAsHtml:function(h,k,s,G){var F;F=0;var O=this.dimensions.container.centerx,S=h.display,da=$tl.height();stuff="";foSec=C.startSec;spp=C.getZoomInfo().spp;zl=C.getZoomInfo().level;buffer=20;borg=h.borg;block_arg="sweep";if(G=="append")block_arg=s;for(s=0;s<k.length;s++){ev=C.eventPool["ev_"+k[s]];if(this.passesFilters(ev,zl)===true){F=O+(ev.startdateObj.sec-foSec)/
spp;if(S=="expanded"){impq=h.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=F;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=ev.spanwidth}F=0;if(ev.image&&ev.image.display_class==="layout"){F=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+F;ev.top=da-ev.height;borg.addBlock(ev,
block_arg)}else if(S=="collapsed")stuff+="<div id='ev_"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(da-2)+"px;left:"+F+"px'></div>"}}return S=="collapsed"?stuff:""},registerEventImages:function(h){n(".timeglider-event-image-bar").each(function(){n(this).position({my:"top",at:"bottom",of:h,offset:"0, 0"}).css("left",0)});n(".timeglider-event-image-above").each(function(){n(this).position({my:"top",at:"top",of:n(x),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(h){h=
C.timelinePool[h];h.display=h.display=="expanded"?"collapsed":"expanded";C.refresh()},timelineModal:function(h){n("#tl_"+h+"_modal").remove();var k=C.timelinePool[h];n.tmpl(this._templates.timeline_modal,{title:k.title,description:k.description,id:h}).appendTo(x).css("z-index",this.ztop++).position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(h,k){if(!h)return"";var s="",G=0,F="",O=
"";if(k=="full")s+="<li><h4>links</h4></li>";if(typeof h=="string")s="<li><a href='"+h+"' target='_blank'>link</a></li>";else if(typeof h=="object")for(G=0;G<h.length;G++){F=h[G].url;O=h[G].label;s+="<li><a href='"+F+"' target='_blank'>"+O+"</a></li>"}return s},eventModal:function(h){n("#ev_"+h+"_modal").remove();var k=this,s=U.event_modal.type,G=n("#"+h),F=k._templates.event_modal;ev=C.eventPool[h];ev_img=ev.image&&ev.image.src?"<img src='"+ev.image.src+"'>":"";ev_img_src=ev.image&&ev.image.src?
ev.image.src:"";links=this.createEventLinksMenu(ev.link,s);ev_descr=s=="default"?ev_img+ev.description:ev.description;templ_obj={title:ev.title,description:ev_descr,id:h,startdate:ev.startdateObj.format("D",true),links:links,image:ev_img_src,video:ev.video};if(ev.video){F=k._templates.event_modal_video;templ_obj.video=ev.video}h=n.tmpl(F,templ_obj);switch(s){case "full":h.appendTo(x).css({"z-index":k.ztop++}).position({my:"left top",at:"left top",of:x,offset:"0, 0",collision:"none none"});h.children(".full_modal_panel").css({width:k.dimensions.container.width-
64+"px",height:k.dimensions.container.height-64+"px"});break;default:h.appendTo(H).css("z-index",k.ztop++).position({my:"right center",at:"left center",of:G,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){n(this).css("z-index",k.ztop++)})}},legendModal:function(h){var k=C.timelinePool[h].legend,s,G,F,O="";for(s=0;s<k.length;s++){G=U.icon_folder+k[s].icon;F=k[s].title;O+="<li><img src='"+G+"'>"+F+"</li>"}h={id:h,legend_list:O};n(x+" .timeglider-legend").remove();n.tmpl(this._templates.legend_modal,
h).appendTo(x).css("z-index",this.ztop++).toggleClass("timeglider-menu-hidden").position({my:"left top",at:"left top",of:x,offset:"16, -4",collision:"none none"});n(x+" .timeglider-legend li").click(function(){n(this).parent().attr("id");var S=n(this).children("img").attr("src");n(this).toggleClass("tg-legend-icon-selected");C.setFilters({origin:"legend",icon:S})})},parseHTMLTable:function(h){var k={},s=+new Date,G=[];n("#"+h).find("tr").each(function(F){var O=n(this).children(),S;if(F===0)G=O.map(function(){return n(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,
"$1")}).get();else{S={};O.each(function(da){S[G[da]]=n(this).text()});k["prefix"+s++]=S}});return k}};w.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",
width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},
{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,
label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",
width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},
{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",
width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},
{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,
level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},
{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},
{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,label:"100 billion years"}];w.calculateSecPerPx=function(h){for(var k=1;k<h.length;k++){var s=h[k],G=0;switch(s.unit){case "da":G=86400;break;case "mo":G=2419200;break;case "ye":G=31536E3;break;case "de":G=31536E4;break;case "ce":G=31536E5;break;case "thou":G=31536E6;break;case "tenthou":G=31536E7;
break;case "hundredthou":G=31536E8;break;case "mill":G=31536E9;break;case "tenmill":G=31536E10;break;case "hundredmill":G=31536E11;break;case "bill":G=31536E12}s.spp=G/parseInt(s.width)}}(w.zoomTree);w.getStringWidth=function(h){if(h)return n("#timeglider-measure-span").html(h).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")}})(timeglider);(function(w){var Z={},N=w.TG_Date,C={},U=jQuery;w.TimelineCollection=Backbone.Collection.extend({model:timeglider.TG_Timeline});w.TG_Mediator=function(n){this.options=C=n;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=C.max_zoom;this.min_zoom=C.min_zoom;this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=0;this.filters={include:"",
exclude:"",legend:[]};this.eventPool=[];this.timelinePool={};this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.foo="bark";this.initial_timeline_id=C.initial_timeline_id||"";this.sole_timeline_id="";if(C.max_zoom===C.min_zoom)this.fixed_zoom=C.min_zoom;Z=this};w.TG_Mediator.prototype={gotoDateZoom:function(n,E){var M=false;this.setFocusDate(new N(n));if(E)M=this.setZoomLevel(E);if(!E||M==false)this.refresh()},zoom:function(n){this.setZoomLevel(this.getZoomLevel()+parseInt(n))},
loadTimelineData:function(n){var E=this;if(n)if(typeof n==="object")E.parseData(n);else if(n.substr(0,1)=="#"){n=[E.getTableTimelineData(n)];E.parseData(n)}else U.getJSON(n,function(M){E.parseData(M)});else{this.timelineDataLoaded=true;this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},getTableTimelineData:function(n){var E={},M=0,x=[],H,h,k="",s=U(n);E.id=n.substr(1);E.title=s.attr("title")||"untitled";E.description=s.attr("description")||"";E.focus_date=s.attr("focus_date")||
N.getToday;E.initial_zoom=s.attr("initial_zoom")||20;E.events=[];s.find("tr").each(function(G){var F=U(this).children(),O;if(G===0)x=F.map(function(){return U(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{O={};F.each(function(S){H=x[S];h=U(this).text();O[H]=h});k="ev_"+M++;O.id=k;E.events.push(O)}});s.css("display","none");return E},parseData:function(n){var E=0,M=n.length,x={};x={};for(var H=0;H<M;H++){x=n[H];x.mediator=this;x=(new timeglider.TG_Timeline(x)).toJSON();if(x.id.length>
0){E++;this.swallowTimeline(x)}}if(E===0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var n=this.timelineDataLoaded==true;if(this.imagesSized==this.imagesToSize&&n){this.setInitialTimelines();U.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(n){this.sole_timeline_id=n.id;this.timelinePool[n.id]=n;U.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var n=this.initial_timeline_id||
this.sole_timeline_id;n&&setTimeout(function(){Z.toggleTimeline(n)},1E3)},refresh:function(){this.startSec=this._focusDate.sec;U.publish("mediator.refreshSignal")},setTicksReady:function(n){this.ticksReady=n;n===true&&U.publish("mediator.ticksReadySignal")},getFocusDate:function(){return this._focusDate},setFocusDate:function(n){if(n!=this._focusDate)this._focusDate=n},getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(n){if(n<=this.max_zoom&&n>=this.min_zoom){this.startSec=
this._focusDate.sec;if(n!=this._zoomLevel){this._zoomLevel=n;this._zoomInfo=timeglider.zoomTree[n];U.publish("mediator.zoomLevelChange");return true}else return false}else return false},getZoomInfo:function(){return this._zoomInfo},setFilters:function(n){switch(n.origin){case "clude":this.filters.include=n.include;this.filters.exclude=n.exclude;break;case "legend":var E=n.icon;if(E=="all"){this.filters.legend=[];U.publish("mediator.legendAll")}else if(U.inArray(E,this.filters.legend)==-1)this.filters.legend.push(E);
else{n=[];n=U.grep(this.filters.legend,function(M){return M!=E});this.filters.legend=n}}U.publish("mediator.filtersChange");this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(n){this._ticksOffset=n;U.publish("mediator.ticksOffsetChange")},getTickBySerial:function(n){for(var E=this.ticksArray,M=E.length,x=0;x<M;x++){var H=E[x];if(H.serial==n)return H}return false},addToTicksArray:function(n,E){if(n.type=="init"){n.serial=N.getTimeUnitSerial(E,n.unit);this.ticksArray=
[n]}else if(n.type=="l"){n.serial=this.ticksArray[0].serial-1;this.ticksArray.unshift(n)}else{n.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(n)}U.publish("mediator.ticksArrayChange");return n.serial},toggleTimeline:function(n){var E=this.timelinePool[n],M=U.inArray(n,this.activeTimelines);if(M==-1){this.activeTimelines.push(n);this.setFocusDate(new N(E.focus_date));this.setZoomLevel(E.initial_zoom)}else this.activeTimelines.splice(M,1);this.refresh();U.publish("mediator.activeTimelinesChange")},
reportImageSize:function(n){var E=Z.eventPool["ev_"+n.id];if(n.error){E.image={};debug.log("WHOOPS: MISSING IMAGE: "+n.src)}else{E.image.width=n.width;E.image.height=n.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}};w.getLowHigh=function(n){var E,M,x=parseFloat(n[0]),H=x;for(E=0;E<n.length;E++){M=parseFloat(n[E]);if(M<H)H=M;if(M>x)x=M}return{high:x,low:H}};w.validateOptions=function(n){this.optionsMaster={initial_focus:{type:"date"},editor:{type:"string"},backgroundColor:{type:"color"},
backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};
var E=this,M="";U.each(n,function(x,H){if(E.optionsMaster[x])switch(E.optionsMaster[x].type){case "string":if(typeof H!="string")M+=x+" needs to be a string.\n";if(E.optionsMaster[x].possible)if(U.inArray(H,E.optionsMaster[x].possible)==-1)M+=x+" must be: "+E.optionsMaster[x].possible.join(" or ");break;case "number":if(typeof H!="number")M+=H+" needs to be a number.\n";if(E.optionsMaster[x].min)if(H<E.optionsMaster[x].min)M+=x+" must be greater than or equal to "+E.optionsMaster[x].min+"\n";if(E.optionsMaster[x].max)if(H>
E.optionsMaster[x].max)M+=x+" must be less than or equal to "+E.optionsMaster[x].max+"\n";break;case "boolean":if(typeof H!="boolean")M+=H+" needs to be a number.\n"}});return M}})(timeglider);(function(w){var Z,N,C=timeglider,U=timeglider.TG_Date;w.widget("timeglider.timeline",{options:{initial_focus:C.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"}},_create:function(){this._id=w(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var n=timeglider.validateOptions(this.options);if(n==""){C.TG_Date.setCulture(this.options.culture);N=new C.TG_Mediator(this.options);Z=new C.TG_TimelineView(this,N);N.setFocusDate(new U(this.options.initial_focus));N.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+n)},goTo:function(n,E){N.gotoDateZoom(n,E)},zoom:function(n){switch(n){case "in":n=-1;break;case "out":n=1}if(n>99||n<-99)return false;N.zoom(n)},panButton:function(n,
E){var M=0;switch(E){case "left":M=30;break;case "right":M=-30;break;default:M=E}Z.setPanButton(n,M)},destroy:function(){w.Widget.prototype.destroy.apply(this,arguments);w(this.element).html("")}})})(jQuery);
